<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Jul 15, 2011 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <title>Forge - CPD Results</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20110715" />
    <meta http-equiv="Content-Language" content="en" />
        
  </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                Forge
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
        
                <div class="xleft">
        <span id="publishDate">Last Published: 2011-07-15</span>
                  &nbsp;| <span id="projectVersion">Version: 1.1.0</span>
                      </div>
            <div class="xright">                    <a href="http://cardforge.org" class="externalLink" title="Forge">Forge</a>
              
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
        
                                          <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                    <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                                                                                                                                                                      <li class="expanded">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                    <ul>
                      <li class="none">
                          <a href="changelog.html" title="Change Log">Change Log</a>
            </li>
                      <li class="none">
                          <a href="checkstyle.html" title="Checkstyle">Checkstyle</a>
            </li>
                      <li class="none">
                          <a href="cobertura/index.html" title="Cobertura Test Coverage">Cobertura Test Coverage</a>
            </li>
                      <li class="none">
            <strong>CPD Report</strong>
          </li>
                      <li class="none">
                          <a href="dev-activity.html" title="Developer Activity">Developer Activity</a>
            </li>
                      <li class="none">
                          <a href="file-activity.html" title="File Activity">File Activity</a>
            </li>
                      <li class="none">
                          <a href="findbugs.html" title="FindBugs Report">FindBugs Report</a>
            </li>
                      <li class="none">
                          <a href="apidocs/index.html" title="JavaDocs">JavaDocs</a>
            </li>
                      <li class="none">
                          <a href="pmd.html" title="PMD Report">PMD Report</a>
            </li>
                      <li class="none">
                          <a href="xref/index.html" title="Source Xref">Source Xref</a>
            </li>
                      <li class="none">
                          <a href="surefire-report.html" title="Surefire Report">Surefire Report</a>
            </li>
                      <li class="none">
                          <a href="taglist.html" title="Tag List">Tag List</a>
            </li>
                      <li class="none">
                          <a href="xref-test/index.html" title="Test Source Xref">Test Source Xref</a>
            </li>
              </ul>
        </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
        
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>CPD Results<a name="CPD_Results"></a></h2><p>The following document contains the results of PMD's  <a class="externalLink" href="http://pmd.sourceforge.net/cpd.html">CPD</a> 4.2.5.</p></div><div class="section"><h2>Duplications<a name="Duplications"></a></h2><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GUI_Filter.java</td><td><a href="./xref/forge/GUI_Filter.html#55">55</a></td></tr><tr class="a"><td>forge/GUI_Quest_Filter.java</td><td><a href="./xref/forge/GUI_Quest_Filter.html#55">55</a></td></tr><tr class="b"><td colspan='2'><div><pre>    public GUI_Quest_Filter(JFrame g, DeckDisplay display) {
        super(g);
        deckDisplay = display;
        initGUI();
    }

    /**
     * &lt;p&gt;initGUI.&lt;/p&gt;
     */
    private void initGUI() {
        try {
            this.isResizable();
            getContentPane().setLayout(new MigLayout(&quot;fill&quot;));
            getContentPane().add(getTopPanel(), &quot;span 3, wrap&quot;);
            getContentPane().add(getColorPanel(), &quot;aligny top, growy&quot;);
            getContentPane().add(getTypePanel(), &quot;aligny top, wrap&quot;);
            getContentPane().add(getBottomPanel(), &quot;align center, span 3&quot;);
            setVisible(true);
            Dimension screen = getToolkit().getScreenSize();
            int x = (screen.width - 340) / 2;
            int y = (screen.height - 500) / 2;
            this.setBounds(x, y, 340, 500);
            this.setResizable(true);
            this.setTitle(&quot;Filter&quot;);

            setIconImage(null);

            this.addWindowListener(new WListener());

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

       private JTextField getNameTextField() {
        if (nameTextField == null) {
            nameTextField = new JTextField(30);
            nameTextField.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return nameTextField;
    }

    private JLabel getNameLabel() {
        if (nameLabel == null) {
            nameLabel = new JLabel();
            nameLabel.setText(&quot;Name:&quot;);
            nameLabel.setFont(new Font(&quot;Segoe UI&quot;, 0, 16));
        }
        return nameLabel;
    }

    private JPanel getTopPanel() {
        if (topPanel == null) {
            topPanel = new JPanel();
            topPanel.setLayout(new MigLayout());
            topPanel.add(
                    getNameLabel(), &quot;gap&quot;);
            topPanel.add(
                    getNameTextField(), &quot;span 3, wrap&quot;);
            topPanel.add(
                    getCardTextLabel(), &quot;gap&quot;);
            topPanel.add(
                    getCardTextField(), &quot;span 3, wrap&quot;);
        }

        return topPanel;
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;colorPanel&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JPanel} object.
     */
    private JPanel getColorPanel() {
        if (colorPanel == null) {
            colorPanel = new JPanel();
            colorPanel.setLayout(new MigLayout());
            colorPanel.setBorder(BorderFactory.createBevelBorder(BevelBorder.LOWERED));
            colorPanel.setBackground(new java.awt.Color(192, 192, 192));
            colorPanel.add(getColorLabel(), &quot;align, wrap&quot;);
            colorPanel.add(getJCheckBoxBlack(), &quot;wrap&quot;);
            colorPanel.add(getJCheckBoxColorless(), &quot;wrap&quot;);
            colorPanel.add(getJCheckBoxWhite(), &quot;wrap&quot;);
            colorPanel.add(getJCheckBoxRed(), &quot;wrap&quot;);
            colorPanel.add(getJCheckBoxGreen(), &quot;wrap&quot;);
            colorPanel.add(getJCheckBoxBlue(), &quot;wrap&quot;);
        }
        return colorPanel;
    }

    private JPanel getBottomPanel() {
        if (bottomPanel == null) {
            bottomPanel = new JPanel();
            bottomPanel.setLayout(new MigLayout());
            bottomPanel.add(getJButtonOk(), &quot;align, span 3, grow&quot;);
        }
        return bottomPanel;
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;jCheckBoxBlue&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxBlue() {
        if (jCheckBoxBlue == null) {
            jCheckBoxBlue = new JCheckBox();
            jCheckBoxBlue.setText(&quot;Blue&quot;);
            jCheckBoxBlue.setSelected(true);
            jCheckBoxBlue.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxBlue.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxBlue;
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;jCheckBoxGreen&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxGreen() {
        if (jCheckBoxGreen == null) {
            jCheckBoxGreen = new JCheckBox();
            jCheckBoxGreen.setText(&quot;Green&quot;);
            jCheckBoxGreen.setSelected(true);
            jCheckBoxGreen.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxGreen.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxGreen;
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;jCheckBoxRed&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxRed() {
        if (jCheckBoxRed == null) {
            jCheckBoxRed = new JCheckBox();
            jCheckBoxRed.setText(&quot;Red&quot;);
            jCheckBoxRed.setSelected(true);
            jCheckBoxRed.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxRed.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxRed;
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;jCheckBoxWhite&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxWhite() {
        if (jCheckBoxWhite == null) {
            jCheckBoxWhite = new JCheckBox();
            jCheckBoxWhite.setText(&quot;White&quot;);
            jCheckBoxWhite.setSelected(true);
            jCheckBoxWhite.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxWhite.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxWhite;
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;jCheckBoxColorless&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxColorless() {
        if (jCheckBoxColorless == null) {
            jCheckBoxColorless = new JCheckBox();
            jCheckBoxColorless.setText(&quot;Colorless&quot;);
            jCheckBoxColorless.setSelected(true);
            jCheckBoxColorless.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxColorless.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxColorless;
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;jButtonOk&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JButton} object.
     */
    private JButton getJButtonOk() {
        if (jButtonOk == null) {
            jButtonOk = new JButton();
            jButtonOk.setText(&quot;OK&quot;);
            jButtonOk.addMouseListener(new CustomListener());
        }
        return jButtonOk;
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;jCheckBoxBlack&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxBlack() {
        if (jCheckBoxBlack == null) {
            jCheckBoxBlack = new JCheckBox();
            jCheckBoxBlack.setText(&quot;Black&quot;);
            jCheckBoxBlack.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxBlack.setSelected(true);
            jCheckBoxBlack.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxBlack;
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;typePanel&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JPanel} object.
     */
    private JPanel getTypePanel() {
        if (typePanel == null) {
            typePanel = new JPanel();
            typePanel.setLayout(new MigLayout());
            typePanel.setBorder(BorderFactory.createBevelBorder(BevelBorder.LOWERED));
            typePanel.setBackground(new java.awt.Color(192, 192, 192));
            typePanel.add(getTypeLabel(), &quot;align, wrap&quot;);
            typePanel.add(getJCheckBoxSorcery(), &quot;wrap&quot;);
            typePanel.add(getJCheckBoxPlaneswalker(), &quot;wrap&quot;);
            typePanel.add(getJCheckBoxLand(), &quot;wrap&quot;);
            typePanel.add(getJCheckBoxInstant(), &quot;wrap&quot;);
            typePanel.add(getJCheckBoxEnchant(), &quot;wrap&quot;);
            typePanel.add(getJCheckBoxCreature(), &quot;wrap&quot;);
            typePanel.add(getJCheckBoxArtifact(), &quot;wrap&quot;);
        }
        return typePanel;
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;colorLabel&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JLabel} object.
     */
    private JLabel getColorLabel() {
        if (colorLabel == null) {
            colorLabel = new JLabel();
            colorLabel.setText(&quot;Color&quot;);
            colorLabel.setFont(new java.awt.Font(&quot;Segoe UI&quot;, 0, 14));
        }
        return colorLabel;
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;typeLabel&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JLabel} object.
     */
    private JLabel getTypeLabel() {
        if (typeLabel == null) {
            typeLabel = new JLabel();
            typeLabel.setText(&quot;Type&quot;);
            typeLabel.setFont(new java.awt.Font(&quot;Segoe UI&quot;, 0, 14));
        }
        return typeLabel;
    }

    /**
     * &lt;p&gt;getJCheckBoxSorcery.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxSorcery() {
        if (jCheckBoxSorcery == null) {
            jCheckBoxSorcery = new JCheckBox();
            jCheckBoxSorcery.setText(&quot;Sorcery&quot;);
            jCheckBoxSorcery.setSelected(true);
            jCheckBoxSorcery.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxSorcery.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxSorcery;
    }

    /**
     * &lt;p&gt;getJCheckBoxPlaneswalker.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxPlaneswalker() {
        if (jCheckBoxPlaneswalker == null) {
            jCheckBoxPlaneswalker = new JCheckBox();
            jCheckBoxPlaneswalker.setText(&quot;Planeswalker&quot;);
            jCheckBoxPlaneswalker.setSelected(true);
            jCheckBoxPlaneswalker.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxPlaneswalker.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxPlaneswalker;
    }

    /**
     * &lt;p&gt;getJCheckBoxLand.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxLand() {
        if (jCheckBoxLand == null) {
            jCheckBoxLand = new JCheckBox();
            jCheckBoxLand.setText(&quot;Land&quot;);
            jCheckBoxLand.setSelected(true);
            jCheckBoxLand.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxLand.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxLand;
    }

    /**
     * &lt;p&gt;getJCheckBoxInstant.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxInstant() {
        if (jCheckBoxInstant == null) {
            jCheckBoxInstant = new JCheckBox();
            jCheckBoxInstant.setText(&quot;Instant&quot;);
            jCheckBoxInstant.setSelected(true);
            jCheckBoxInstant.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxInstant.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxInstant;
    }

    /**
     * &lt;p&gt;getJCheckBoxEnchant.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxEnchant() {
        if (jCheckBoxEnchant == null) {
            jCheckBoxEnchant = new JCheckBox();
            jCheckBoxEnchant.setText(&quot;Enchant&quot;);
            jCheckBoxEnchant.setSelected(true);
            jCheckBoxEnchant.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxEnchant.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxEnchant;
    }

    /**
     * &lt;p&gt;getJCheckBoxCreature.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxCreature() {
        if (jCheckBoxCreature == null) {
            jCheckBoxCreature = new JCheckBox();
            jCheckBoxCreature.setText(&quot;Creature&quot;);
            jCheckBoxCreature.setSelected(true);
            jCheckBoxCreature.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxCreature.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxCreature;
    }

    /**
     * &lt;p&gt;getJCheckBoxArtifact.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JCheckBox} object.
     */
    private JCheckBox getJCheckBoxArtifact() {
        if (jCheckBoxArtifact == null) {
            jCheckBoxArtifact = new JCheckBox();
            jCheckBoxArtifact.setText(&quot;Artifact&quot;);
            jCheckBoxArtifact.setSelected(true);
            jCheckBoxArtifact.setBackground(new java.awt.Color(192, 192, 192));
            jCheckBoxArtifact.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return jCheckBoxArtifact;
    }

    /**
     * &lt;p&gt;getCardTextField.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JTextField} object.
     */
    private JTextField getCardTextField() {
        if (cardTextField == null) {
            cardTextField = new JTextField(30);
            cardTextField.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {

                    if (e.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER) {
                        FilterCardTable();
                    }
                }
            });
        }
        return cardTextField;
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;cardTextLabel&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link javax.swing.JLabel} object.
     */
    private JLabel getCardTextLabel() {
        if (cardTextLabel == null) {
            cardTextLabel = new JLabel();
            cardTextLabel.setText(&quot;Card Text:&quot;);
            cardTextLabel.setFont(new java.awt.Font(&quot;Segoe UI&quot;, 0, 16));
        }
        return cardTextLabel;
    }

    public class CustomListener implements MouseListener {

        public void mouseClicked(MouseEvent e) {
            FilterCardTable();
        }

        public void mouseEntered(MouseEvent e) {

        }

        public void mouseExited(MouseEvent e) {

        }

        public void mousePressed(MouseEvent e) {

        }

        public void mouseReleased(MouseEvent e) {

        }
    }

    public class WListener implements WindowListener {

        public void windowActivated(WindowEvent arg0) {

        }

        public void windowClosed(WindowEvent arg0) {

        }

        public void windowClosing(WindowEvent arg0) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GameAction.java</td><td><a href="./xref/forge/GameAction.html#1686">1686</a></td></tr><tr class="a"><td>forge/GameAction.java</td><td><a href="./xref/forge/GameAction.html#1825">1825</a></td></tr><tr class="b"><td colspan='2'><div><pre>                    if (k[2].equals(&quot;Less&quot;)) {
                        if (k[7].equals(&quot;OnlyOneBonus&quot;)) { // Only Works for Color and Type
                            for (int string_no = 5; string_no &lt; 7; string_no++) {
                                String spilt = k[string_no];
                                String color_spilt[] = spilt.split(&quot;/&quot;);

                                for (int cs_num = 0; cs_num &lt; color_spilt.length; cs_num++) {
                                    k[string_no] = color_spilt[cs_num];
                                    if (string_no == 5 &amp;&amp; CardUtil.getColors(originalCard).contains(k[5]))
                                        break;
                                    if (string_no == 6 &amp;&amp; (originalCard.isType(k[6]))) break;
                                }
                            }
                        }
                        if (k[7].contains(&quot;All Conditions&quot;)) { // Only Works for Color and Type
                            for (int string_no = 5; string_no &lt; 7; string_no++) {
                                String spilt = k[string_no];
                                String color_spilt[] = spilt.split(&quot;/&quot;);
                                for (int cs_num = 0; cs_num &lt; color_spilt.length; cs_num++) {
                                    k[string_no] = color_spilt[cs_num];
                                    if (string_no == 5) {
                                        if (CardUtil.getColors(originalCard).contains(k[5]) || k[5].equals(&quot;All&quot;)) {
                                        } else {
                                            k[5] = &quot;Nullified&quot;;
                                            break;
                                        }
                                    }
                                    if (string_no == 6) {
                                        if (originalCard.isType(k[6]) || k[6].equals(&quot;All&quot;)) {
                                        } else {
                                            k[6] = &quot;Nullified&quot;;
                                            break;
                                        }
                                    }
                                }
                            }
                            if (!k[5].equals(&quot;Nullified&quot;)) k[5] = &quot;All&quot;;
                            if (!k[6].equals(&quot;Nullified&quot;)) k[6] = &quot;All&quot;;
                        }
                        if ((k[1].equals(&quot;Player&quot;) &amp;&amp; card.getController().equals(controller)
                                || (k[1].equals(&quot;Opponent&quot;) &amp;&amp; card.getController().equals(controller.getOpponent())) || k[1].equals(&quot;All&quot;))
                                &amp;&amp; ((k[4].equals(&quot;Spell&quot;) &amp;&amp; sa.isSpell() == true) || (k[4].equals(&quot;Ability&quot;) &amp;&amp; sa.isAbility() == true)
                                || (k[4].startsWith(&quot;Ability_Cycling&quot;) &amp;&amp; sa.isCycling()) || (k[4].equals(&quot;Self&quot;) &amp;&amp; originalCard.equals(card))
                                || (k[4].equals(&quot;Enchanted&quot;) &amp;&amp; originalCard.getEnchantedBy().contains(card)) || k[4].equals(&quot;All&quot;))
                                &amp;&amp; ((CardUtil.getColors(originalCard).contains(k[5])) || k[5].equals(&quot;All&quot;))
                                &amp;&amp; ((originalCard.isType(k[6]))
                                || (!(originalCard.isType(k[6])) &amp;&amp; k[7].contains(&quot;NonType&quot;)) || k[6].equals(&quot;All&quot;))) {
                            if (k[7].contains(&quot;CardIsTapped&quot;)) {
                                if (card.isTapped() == false) k[3] = &quot;0&quot;;
                            }
                            if (k[7].contains(&quot;TargetInPlay&quot;)) {
                                if (!Player_Play.contains(originalCard)) k[3] = &quot;0&quot;;
                            }
                            if (k[7].contains(&quot;TargetInHand&quot;)) {
                                if (!Player_Hand.contains(originalCard)) k[3] = &quot;0&quot;;
                            }
                            if (k[7].contains(&quot;NonType&quot;)) {
                                if (originalCard.isType(k[6])) k[3] = &quot;0&quot;;
                            }
                            if (k[7].contains(&quot;OpponentTurn&quot;)) {
                                if (AllZone.getPhase().isPlayerTurn(controller)) k[3] = &quot;0&quot;;
                            }
                            if (k[7].contains(&quot;Affinity&quot;)) {
                                String spilt = k[7];
                                String color_spilt[] = spilt.split(&quot;/&quot;);
                                k[7] = color_spilt[1];
                                CardList PlayerList = AllZoneUtil.getPlayerCardsInPlay(controller);
                                PlayerList = PlayerList.getType(k[7]);
                                k[3] = String.valueOf(PlayerList.size());
                            }

                            String[] Numbers = new String[Max];
                            if (!&quot;WUGRB&quot;.contains(k[3])) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/ReadBoosterPack.java</td><td><a href="./xref/forge/ReadBoosterPack.html#56">56</a></td></tr><tr class="a"><td>forge/ReadDraftBoosterPack.java</td><td><a href="./xref/forge/ReadDraftBoosterPack.html#35">35</a></td></tr><tr class="b"><td colspan='2'><div><pre>    public ReadDraftBoosterPack() {
        setup();
    }

    //returns &quot;common&quot;, &quot;uncommon&quot;, or &quot;rare&quot;
    /**
     * &lt;p&gt;getRarity.&lt;/p&gt;
     *
     * @param cardName a {@link java.lang.String} object.
     * @return a {@link java.lang.String} object.
     */
    public String getRarity(String cardName) {
        if (commonList.containsName(cardName)) return &quot;Common&quot;;
        if (uncommonList.containsName(cardName)) return &quot;Uncommon&quot;;
        if (rareList.containsName(cardName)) return &quot;Rare&quot;;

        ArrayList&lt;String&gt; land = new ArrayList&lt;String&gt;();
        land.add(&quot;Forest&quot;);
        land.add(&quot;Plains&quot;);
        land.add(&quot;Swamp&quot;);
        land.add(&quot;Mountain&quot;);
        land.add(&quot;Island&quot;);
        land.add(&quot;Terramorphic Expanse&quot;);
        land.add(&quot;Snow-Covered Forest&quot;);
        land.add(&quot;Snow-Covered Plains&quot;);
        land.add(&quot;Snow-Covered Swamp&quot;);
        land.add(&quot;Snow-Covered Mountain&quot;);
        land.add(&quot;Snow-Covered Island&quot;);
        if (land.contains(cardName)) return &quot;Land&quot;;

        return &quot;error&quot;;
    }

    /**
     * &lt;p&gt;getBoosterPack5.&lt;/p&gt;
     *
     * @return a {@link forge.CardList} object.
     */
    public CardList getBoosterPack5() {
        CardList list = new CardList();
        for (int i = 0; i &lt; 5; i++)
            list.addAll(getBoosterPack());

        for (int i = 0; i &lt; 20; i++) {
            list.add(AllZone.getCardFactory().getCard(&quot;Forest&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Island&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Plains&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Mountain&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Swamp&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Snow-Covered Forest&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Snow-Covered Island&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Snow-Covered Plains&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Snow-Covered Mountain&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Snow-Covered Swamp&quot;, AllZone.getHumanPlayer()));
        }

        for (int i = 0; i &lt; 4; i++)
            list.add(AllZone.getCardFactory().getCard(&quot;Terramorphic Expanse&quot;, AllZone.getHumanPlayer()));

        return list;
    }//getBoosterPack5()

    /**
     * &lt;p&gt;getBoosterPack.&lt;/p&gt;
     *
     * @return a {@link forge.CardList} object.
     */
    public CardList getBoosterPack() {
        CardList pack = new CardList();

        pack.add(getRandomCard(rareList));

        for (int i = 0; i &lt; 3; i++)
            pack.add(getRandomCard(uncommonList));

        //11 commons, 7 creature 4 noncreature
        CardList variety;
        for (int i = 0; i &lt; 7; i++) {
            variety = getVariety(commonCreatureList);
            pack.add(getRandomCard(variety));
        }

        for (int i = 0; i &lt; 4; i++) {
            variety = getVariety(commonNonCreatureList);
            pack.add(getRandomCard(variety));
        }

        if (pack.size() != 15)
            throw new RuntimeException(&quot;ReadDraftBoosterPack : getBoosterPack() error, pack is not 15 cards - &quot;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/deck/generate/Generate2ColorDeck.java</td><td><a href="./xref/forge/deck/generate/Generate2ColorDeck.html#267">267</a></td></tr><tr class="a"><td>forge/deck/generate/Generate3ColorDeck.java</td><td><a href="./xref/forge/deck/generate/Generate3ColorDeck.html#292">292</a></td></tr><tr class="b"><td colspan='2'><div><pre>                throw new RuntimeException(&quot;Generate3ColorDeck : get3ColorDeck -- looped too much -- DL&quot;);

            tDeck.add(AllZone.getCardFactory().getCard(s, AllZone.getHumanPlayer()));
            int n = CardCounts.get(s);
            CardCounts.put(s, n + 1);
            tmpDeck += s + &quot;\n&quot;;
        }

        numLands -= nDLands;

        if (numLands &gt; 0)    // attempt to optimize basic land counts according to color representation
        {
            CCnt ClrCnts[] = {new CCnt(&quot;Plains&quot;, 0),
                    new CCnt(&quot;Island&quot;, 0),
                    new CCnt(&quot;Swamp&quot;, 0),
                    new CCnt(&quot;Mountain&quot;, 0),
                    new CCnt(&quot;Forest&quot;, 0)};

            // count each card color using mana costs
            // TODO: count hybrid mana differently?
            for (int i = 0; i &lt; tDeck.size(); i++) {
                String mc = tDeck.get(i).getManaCost();

                // count each mana symbol in the mana cost
                for (int j = 0; j &lt; mc.length(); j++) {
                    char c = mc.charAt(j);

                    if (c == 'W')
                        ClrCnts[0].Count++;
                    else if (c == 'U')
                        ClrCnts[1].Count++;
                    else if (c == 'B')
                        ClrCnts[2].Count++;
                    else if (c == 'R')
                        ClrCnts[3].Count++;
                    else if (c == 'G')
                        ClrCnts[4].Count++;
                }
            }

            // total of all ClrCnts
            int totalColor = 0;
            for (int i = 0; i &lt; 5; i++) {
                totalColor += ClrCnts[i].Count;
                tmpDeck += ClrCnts[i].Color + &quot;:&quot; + ClrCnts[i].Count + &quot;\n&quot;;
            }

            tmpDeck += &quot;totalColor:&quot; + totalColor + &quot;\n&quot;;

            for (int i = 0; i &lt; 5; i++) {
                if (ClrCnts[i].Count &gt; 0) {    // calculate number of lands for each color
                    p = (float) ClrCnts[i].Count / (float) totalColor;
                    int nLand = (int) ((float) numLands * p);
                    tmpDeck += &quot;nLand-&quot; + ClrCnts[i].Color + &quot;:&quot; + nLand + &quot;\n&quot;;

                    // just to prevent a null exception by the deck size fixing code
                    CardCounts.put(ClrCnts[i].Color, nLand);

                    for (int j = 0; j &lt;= nLand; j++)
                        tDeck.add(AllZone.getCardFactory().getCard(ClrCnts[i].Color, AllZone.getComputerPlayer()));
                }
            }
        }
        tmpDeck += &quot;DeckSize:&quot; + tDeck.size() + &quot;\n&quot;;

        // fix under-sized or over-sized decks, due to integer arithmetic
        if (tDeck.size() &lt; Size) {
            int diff = Size - tDeck.size();

            for (int i = 0; i &lt; diff; i++) {
                Card c = tDeck.get(r.nextInt(tDeck.size()));

                lc = 0;
                while (CardCounts.get(c.getName()) &gt; 3 || lc &gt; Size) {
                    c = tDeck.get(r.nextInt(tDeck.size()));
                    lc++;
                }
                if (lc &gt; Size)
                    throw new RuntimeException(&quot;Generate3ColorDeck : get3ColorDeck -- looped too much -- undersize&quot;);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GUI_Filter.java</td><td><a href="./xref/forge/GUI_Filter.html#681">681</a></td></tr><tr class="a"><td>forge/GUI_Quest_Filter.java</td><td><a href="./xref/forge/GUI_Quest_Filter.html#655">655</a></td></tr><tr class="b"><td colspan='2'><div><pre>                        deckDisplay.updateDisplay(g.stCardList, deckDisplay.getBottom());
                    } else {
                        if (jCheckBoxBlack.isSelected() == false) {
                            filterCardList = filter.CardListColorFilter(filterCardList, &quot;black&quot;);
                            g.blackCheckBox.setSelected(false);
                            g.blackCheckBox.setEnabled(false);
                        }
                        if (jCheckBoxBlue.isSelected() == false) {
                            filterCardList = filter.CardListColorFilter(filterCardList, &quot;blue&quot;);
                            g.blueCheckBox.setSelected(false);
                            g.blueCheckBox.setEnabled(false);
                        }
                        if (jCheckBoxGreen.isSelected() == false) {
                            filterCardList = filter.CardListColorFilter(filterCardList, &quot;green&quot;);
                            g.greenCheckBox.setSelected(false);
                            g.greenCheckBox.setEnabled(false);
                        }
                        if (jCheckBoxRed.isSelected() == false) {
                            filterCardList = filter.CardListColorFilter(filterCardList, &quot;red&quot;);
                            g.redCheckBox.setSelected(false);
                            g.redCheckBox.setEnabled(false);
                        }
                        if (jCheckBoxWhite.isSelected() == false) {
                            filterCardList = filter.CardListColorFilter(filterCardList, &quot;white&quot;);
                            g.whiteCheckBox.setSelected(false);
                            g.whiteCheckBox.setEnabled(false);
                        }
                        if (jCheckBoxColorless.isSelected() == false) {
                            filterCardList = filter.CardListColorFilter(filterCardList, &quot;colorless&quot;);
                            g.colorlessCheckBox.setSelected(false);
                            g.colorlessCheckBox.setEnabled(false);
                        }
                        if (jCheckBoxArtifact.isSelected() == false) {
                            filterCardList = filter.CardListTypeFilter(filterCardList, &quot;artifact&quot;);
                            g.artifactCheckBox.setSelected(false);
                            g.artifactCheckBox.setEnabled(false);
                        }
                        if (jCheckBoxCreature.isSelected() == false) {
                            filterCardList = filter.CardListTypeFilter(filterCardList, &quot;creature&quot;);
                            g.creatureCheckBox.setSelected(false);
                            g.creatureCheckBox.setEnabled(false);
                        }
                        if (jCheckBoxEnchant.isSelected() == false) {
                            filterCardList = filter.CardListTypeFilter(filterCardList, &quot;enchantment&quot;);
                            g.enchantmentCheckBox.setSelected(false);
                            g.enchantmentCheckBox.setEnabled(false);
                        }
                        if (jCheckBoxInstant.isSelected() == false) {
                            filterCardList = filter.CardListTypeFilter(filterCardList, &quot;instant&quot;);
                            g.instantCheckBox.setSelected(false);
                            g.instantCheckBox.setEnabled(false);
                        }
                        if (jCheckBoxLand.isSelected() == false) {
                            filterCardList = filter.CardListTypeFilter(filterCardList, &quot;land&quot;);
                            g.landCheckBox.setSelected(false);
                            g.landCheckBox.setEnabled(false);
                        }
                        if (jCheckBoxPlaneswalker.isSelected() == false) {
                            filterCardList = filter.CardListTypeFilter(filterCardList, &quot;planeswalker&quot;);
                            g.planeswalkerCheckBox.setSelected(false);
                            g.planeswalkerCheckBox.setEnabled(false);
                        }
                        if (jCheckBoxSorcery.isSelected() == false) {
                            filterCardList = filter.CardListTypeFilter(filterCardList, &quot;sorcery&quot;);
                            g.sorceryCheckBox.setSelected(false);
                            g.sorceryCheckBox.setEnabled(false);
                        }

                        deckDisplay.updateDisplay(filterCardList, deckDisplay.getBottom());
                    }
                }
            }

        }
        dispose();
    }
}</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DeckEditor.java</td><td><a href="./xref/forge/Gui_DeckEditor.html#1018">1018</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor.html#873">873</a></td></tr><tr class="b"><td colspan='2'><div><pre>            Gui_Quest_DeckEditor g = Gui_Quest_DeckEditor.this;
            GUI_DeckAnalysis dAnalysis = new GUI_DeckAnalysis(g, bottomModel);
            dAnalysis.setVisible(true);
            g.setEnabled(false);
        }
    }

    /**
     * &lt;p&gt;changePictureButton_actionPerformed.&lt;/p&gt;
     *
     * @param e a {@link java.awt.event.ActionEvent} object.
     */
    void changePictureButton_actionPerformed(ActionEvent e) {
        if (cCardHQ != null) {
            File file = getImportFilename();
            if (file != null) {
                String fileName = GuiDisplayUtil.cleanString(cCardHQ.getName()) + &quot;.jpg&quot;;
                File base = ForgeProps.getFile(IMAGE_BASE);
                File f = new File(base, fileName);
                f.delete();

                try {

                    f.createNewFile();
                    FileOutputStream fos = new FileOutputStream(f);
                    FileInputStream fis = new FileInputStream(file);
                    byte[] buff = new byte[32 * 1024];
                    int length;
                    while (fis.available() &gt; 0) {
                        length = fis.read(buff);
                        if (length &gt; 0) fos.write(buff, 0, length);
                    }
                    fos.flush();
                    fis.close();
                    fos.close();
                    setCard(cCardHQ);

                } catch (IOException e1) {
                    e1.printStackTrace();
                }

            }
        }
    }

    /**
     * &lt;p&gt;getImportFilename.&lt;/p&gt;
     *
     * @return a {@link java.io.File} object.
     */
    private File getImportFilename() {
        JFileChooser chooser = new JFileChooser(previousDirectory);
        ImagePreviewPanel preview = new ImagePreviewPanel();
        chooser.setAccessory(preview);
        chooser.addPropertyChangeListener(preview);
        chooser.addChoosableFileFilter(dckFilter);
        int returnVal = chooser.showOpenDialog(null);

        if (returnVal == JFileChooser.APPROVE_OPTION) {
            File file = chooser.getSelectedFile();
            previousDirectory = file.getParentFile();
            return file;
        }


        return null;

    }

    private FileFilter dckFilter = new FileFilter() {

        @Override
        public boolean accept(File f) {
            return f.getName().endsWith(&quot;.jpg&quot;) || f.isDirectory();
        }

        @Override
        public String getDescription() {
            return &quot;*.jpg&quot;;
        }

    };


    /**
     * &lt;p&gt;removePictureButton_actionPerformed.&lt;/p&gt;
     *
     * @param e a {@link java.awt.event.ActionEvent} object.
     */
    void removePictureButton_actionPerformed(ActionEvent e) {
        if (cCardHQ != null) {
            String options[] = {&quot;Yes&quot;, &quot;No&quot;};
            int value = JOptionPane.showOptionDialog(null,
                    &quot;Do you want delete &quot; + cCardHQ.getName() + &quot; picture?&quot;, &quot;Delete picture&quot;,
                    JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, null, options, options[1]);
            if (value == 0) {
                String fileName = GuiDisplayUtil.cleanString(cCardHQ.getName()) + &quot;.jpg&quot;;
                File base = ForgeProps.getFile(IMAGE_BASE);
                File f = new File(base, fileName);
                f.delete();
                JOptionPane.showMessageDialog(null, &quot;Picture &quot; + cCardHQ.getName() + &quot; deleted.&quot;,
                        &quot;Delete picture&quot;, JOptionPane.INFORMATION_MESSAGE);
                setCard(cCardHQ);
            }
        }

    }


    /**
     * &lt;p&gt;removeButton_actionPerformed.&lt;/p&gt;
     *
     * @param e a {@link java.awt.event.ActionEvent} object.
     */
    void removeButton_actionPerformed(ActionEvent e) {
        setTitle(&quot;Deck Editor : &quot; + customMenu.getDeckName() + &quot; : unsaved&quot;);

        int n = bottomTable.getSelectedRow();
        if (n != -1) {
            Card c = bottomModel.rowToCard(n);
            bottomModel.removeCard(c);
            if (filterUsed == true) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DownloadSetPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadSetPictures_LQ.html#132">132</a></td></tr><tr class="a"><td>forge/Gui_MigrateLocalMWSSetPictures_HQ.java</td><td><a href="./xref/forge/Gui_MigrateLocalMWSSetPictures_HQ.html#134">134</a></td></tr><tr class="b"><td colspan='2'><div><pre>                new Thread(Gui_MigrateLocalMWSSetPictures_HQ.this).start();
                b.setEnabled(false);
            }
        });
//        p0.add(b);

        p0.add(Box.createVerticalStrut(5));

        //Progress
        p0.add(bar);
        bar.setStringPainted(true);
        //bar.setString(ForgeProps.getLocalized(BAR_BEFORE_START));
        bar.setString(card + &quot;/&quot; + cards.length);
        //bar.setString(String.format(ForgeProps.getLocalized(card == cards.length? BAR_CLOSE:BAR_WAIT), this.card, cards.length));
        Dimension d = bar.getPreferredSize();
        d.width = 300;
        bar.setPreferredSize(d);

        //JOptionPane
        Object[] options = {b, close = new JButton(ForgeProps.getLocalized(BUTTONS.CANCEL))};
        dlg = new JOptionPane(p0, DEFAULT_OPTION, PLAIN_MESSAGE, null, options, options[1]);
    }

    /** {@inheritDoc} */
    @Override
    public int getMinimum() {
        return 0;
    }

    /** {@inheritDoc} */
    @Override
    public int getValue() {
        return card;
    }

    /** {@inheritDoc} */
    @Override
    public int getExtent() {
        return 0;
    }

    /** {@inheritDoc} */
    @Override
    public int getMaximum() {
        return cards == null ? 0 : cards.length;
    }

    /**
     * &lt;p&gt;update.&lt;/p&gt;
     *
     * @param card a int.
     */
    private void update(int card) {
        this.card = card;

        final class Worker implements Runnable {
            private int card;

            Worker(int card) {
                this.card = card;
            }

            public void run() {
                fireStateChanged();

                StringBuilder sb = new StringBuilder();

                int a = getAverageTimePerCard();

                if (card != cards.length) {
                    sb.append(card + &quot;/&quot; + cards.length + &quot; - &quot;);

                    long t2Go = (cards.length - card) * a;

                    boolean secOnly = true;
                    if (t2Go &gt; 3600000) {
                        sb.append(String.format(&quot;%02d:&quot;, t2Go / 3600000));
                        t2Go = t2Go % 3600000;
                        secOnly = false;
                    }
                    if (t2Go &gt; 60000) {
                        sb.append(String.format(&quot;%02d:&quot;, t2Go / 60000));
                        t2Go = t2Go % 60000;
                        secOnly = false;
                    }
                    if (!secOnly)
                        sb.append(String.format(&quot;%02d remaining.&quot;, t2Go / 1000));
                    else
                        sb.append(String.format(&quot;0:%02d remaining.&quot;, t2Go / 1000));
                } else
                    sb.append(String.format(ForgeProps.getLocalized(BAR_CLOSE), card, cards.length));

                bar.setString(sb.toString());
                //bar.setString(String.format(ForgeProps.getLocalized(card == cards.length? BAR_CLOSE:BAR_WAIT), card,
                //        cards.length));
                System.out.println(card + &quot;/&quot; + cards.length + &quot; - &quot; + a);
            }
        }
        ;
        EventQueue.invokeLater(new Worker(card));
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;dlg&lt;/code&gt;.&lt;/p&gt;
     *
     * @param frame a {@link javax.swing.JFrame} object.
     * @return a {@link javax.swing.JDialog} object.
     */
    public JDialog getDlg(JFrame frame) {
        final JDialog dlg = this.dlg.createDialog(frame, ForgeProps.getLocalized(TITLE));
        close.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                dlg.setVisible(false);
            }
        });
        return dlg;
    }

    /**
     * &lt;p&gt;Setter for the field &lt;code&gt;cancel&lt;/code&gt;.&lt;/p&gt;
     *
     * @param cancel a boolean.
     */
    public void setCancel(boolean cancel) {
        this.cancel = cancel;
    }


    /**
     * &lt;p&gt;run.&lt;/p&gt;
     */
    public void run() {
        BufferedInputStream in;
        BufferedOutputStream out;

        File base = ForgeProps.getFile(IMAGE_BASE);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Animate.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Animate.html#337">337</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Animate.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Animate.html#735">735</a></td></tr><tr class="b"><td colspan='2'><div><pre>        HashMap&lt;String, String&gt; params = af.getMapParams();
        Card host = af.getHostCard();
        Map&lt;String, String&gt; svars = host.getSVars();

        //AF specific params
        int power = -1;
        if (params.containsKey(&quot;Power&quot;)) power = AbilityFactory.calculateAmount(host, params.get(&quot;Power&quot;), sa);
        int toughness = -1;
        if (params.containsKey(&quot;Toughness&quot;))
            toughness = AbilityFactory.calculateAmount(host, params.get(&quot;Toughness&quot;), sa);

        boolean permanent = params.containsKey(&quot;Permanent&quot;) ? true : false;

        final ArrayList&lt;String&gt; types = new ArrayList&lt;String&gt;();
        if (params.containsKey(&quot;Types&quot;)) types.addAll(Arrays.asList(params.get(&quot;Types&quot;).split(&quot;,&quot;)));

        //allow ChosenType - overrides anything else specified
        if (types.contains(&quot;ChosenType&quot;)) {
            types.clear();
            types.add(host.getChosenType());
        }

        final ArrayList&lt;String&gt; keywords = new ArrayList&lt;String&gt;();
        if (params.containsKey(&quot;Keywords&quot;)) keywords.addAll(Arrays.asList(params.get(&quot;Keywords&quot;).split(&quot; &amp; &quot;)));
        //allow SVar substitution for keywords
        for (int i = 0; i &lt; keywords.size(); i++) {
            String k = keywords.get(i);
            if (svars.containsKey(k)) {
                keywords.add(svars.get(k));
                keywords.remove(k);
            }
        }

        //colors to be added or changed to
        String tmpDesc = &quot;&quot;;
        if (params.containsKey(&quot;Colors&quot;)) {
            String colors = params.get(&quot;Colors&quot;);
            if (colors.equals(&quot;ChosenColor&quot;)) {
                tmpDesc = CardUtil.getShortColorsString(new ArrayList&lt;String&gt;(Arrays.asList(host.getChosenColor().split(&quot;,&quot;))));
            } else {
                tmpDesc = CardUtil.getShortColorsString(new ArrayList&lt;String&gt;(Arrays.asList(colors.split(&quot;,&quot;))));
            }
        }
        final String finalDesc = tmpDesc;

        //abilities to add to the animated being
        ArrayList&lt;String&gt; abilities = new ArrayList&lt;String&gt;();
        if (params.containsKey(&quot;Abilities&quot;)) abilities.addAll(Arrays.asList(params.get(&quot;Abilities&quot;).split(&quot;,&quot;)));

        //triggers to add to the animated being
        ArrayList&lt;String&gt; triggers = new ArrayList&lt;String&gt;();
        if (params.containsKey(&quot;Triggers&quot;)) triggers.addAll(Arrays.asList(params.get(&quot;Triggers&quot;).split(&quot;,&quot;)));</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DeckEditor.java</td><td><a href="./xref/forge/Gui_DeckEditor.html#378">378</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor.html#227">227</a></td></tr><tr class="b"><td colspan='2'><div><pre>    }

    /**
     * &lt;p&gt;filterByColor.&lt;/p&gt;
     *
     * @param c a {@link forge.Card} object.
     * @return a boolean.
     */
    private boolean filterByColor(Card c) {
        boolean filterOut = false;

        if (!whiteCheckBox.isSelected()) {
            if (CardUtil.getColors(c).contains(Constant.Color.White)) {
                filterOut = true;
            }
        }

        if (!blueCheckBox.isSelected()) {
            if (CardUtil.getColors(c).contains(Constant.Color.Blue)) {
                filterOut = true;
            }
        }

        if (!blackCheckBox.isSelected()) {
            if (CardUtil.getColors(c).contains(Constant.Color.Black)) {
                filterOut = true;
            }
        }

        if (!redCheckBox.isSelected()) {
            if (CardUtil.getColors(c).contains(Constant.Color.Red)) {
                filterOut = true;
            }
        }

        if (!greenCheckBox.isSelected()) {
            if (CardUtil.getColors(c).contains(Constant.Color.Green)) {
                filterOut = true;
            }
        }

        if (!colorlessCheckBox.isSelected()) {
            if (CardUtil.getColors(c).contains(Constant.Color.Colorless)) {
                filterOut = true;
            }
        }

        return filterOut;
    }

    /**
     * &lt;p&gt;filterByType.&lt;/p&gt;
     *
     * @param c a {@link forge.Card} object.
     * @return a boolean.
     */
    private boolean filterByType(Card c) {
        boolean filterOut = false;

        if (!landCheckBox.isSelected() &amp;&amp; c.isLand()) {
            filterOut = true;
        }

        if (!creatureCheckBox.isSelected() &amp;&amp; c.isCreature()) {
            filterOut = true;
        }

        if (!sorceryCheckBox.isSelected() &amp;&amp; c.isSorcery()) {
            filterOut = true;
        }

        if (!instantCheckBox.isSelected() &amp;&amp; c.isInstant()) {
            filterOut = true;
        }

        if (!planeswalkerCheckBox.isSelected() &amp;&amp; c.isPlaneswalker()) {
            filterOut = true;
        }

        if (!artifactCheckBox.isSelected() &amp;&amp; c.isArtifact()) {
            filterOut = true;
        }

        if (!enchantmentCheckBox.isSelected() &amp;&amp; c.isEnchantment()) {
            filterOut = true;
        }

        return filterOut;
    }

    /**
     * &lt;p&gt;getTopTableModel.&lt;/p&gt;
     *
     * @return a {@link forge.TableModel} object.
     */
    public TableModel getTopTableModel() {
        return topModel;
    }


    //top shows available card pool
    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;top&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link forge.CardList} object.
     */
    public CardList getTop() {
        return topModel.getCards();
    }

    //bottom shows cards that the user has chosen for his library
    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;bottom&lt;/code&gt;.&lt;/p&gt;
     *
     * @return a {@link forge.CardList} object.
     */
    public CardList getBottom() {
        return bottomModel.getCards();
    }


    /**
     * &lt;p&gt;show.&lt;/p&gt;
     *
     * @param exitCommand a {@link forge.Command} object.
     */
    public void show(final Command exitCommand) {
        final Command exit = new Command() {
            private static final long serialVersionUID = -7428793574300520612L;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/deck/generate/Generate2ColorDeck.java</td><td><a href="./xref/forge/deck/generate/Generate2ColorDeck.html#34">34</a></td></tr><tr class="a"><td>forge/deck/generate/Generate3ColorDeck.java</td><td><a href="./xref/forge/deck/generate/Generate3ColorDeck.html#36">36</a></td></tr><tr class="b"><td colspan='2'><div><pre>    public Generate3ColorDeck(String Clr1, String Clr2, String Clr3) {
        r = MyRandom.random;

        CardCounts = new HashMap&lt;String, Integer&gt;();

        ClrMap = new HashMap&lt;String, String&gt;();
        ClrMap.put(&quot;white&quot;, &quot;W&quot;);
        ClrMap.put(&quot;blue&quot;, &quot;U&quot;);
        ClrMap.put(&quot;black&quot;, &quot;B&quot;);
        ClrMap.put(&quot;red&quot;, &quot;R&quot;);
        ClrMap.put(&quot;green&quot;, &quot;G&quot;);

        notColors = new ArrayList&lt;String&gt;();
        notColors.add(&quot;white&quot;);
        notColors.add(&quot;blue&quot;);
        notColors.add(&quot;black&quot;);
        notColors.add(&quot;red&quot;);
        notColors.add(&quot;green&quot;);

        DualLands = new ArrayList&lt;DLnd&gt;();
        DualLands.add(new DLnd(&quot;Tundra&quot;, &quot;WU&quot;));
        DualLands.add(new DLnd(&quot;Hallowed Fountain&quot;, &quot;WU&quot;));
        DualLands.add(new DLnd(&quot;Underground Sea&quot;, &quot;UB&quot;));
        DualLands.add(new DLnd(&quot;Watery Grave&quot;, &quot;UB&quot;));
        DualLands.add(new DLnd(&quot;Badlands&quot;, &quot;BR&quot;));
        DualLands.add(new DLnd(&quot;Blood Crypt&quot;, &quot;BR&quot;));
        DualLands.add(new DLnd(&quot;Taiga&quot;, &quot;RG&quot;));
        DualLands.add(new DLnd(&quot;Stomping Ground&quot;, &quot;RG&quot;));
        DualLands.add(new DLnd(&quot;Savannah&quot;, &quot;GW&quot;));
        DualLands.add(new DLnd(&quot;Temple Garden&quot;, &quot;GW&quot;));
        DualLands.add(new DLnd(&quot;Scrubland&quot;, &quot;WB&quot;));
        DualLands.add(new DLnd(&quot;Godless Shrine&quot;, &quot;WB&quot;));
        DualLands.add(new DLnd(&quot;Volcanic Island&quot;, &quot;UR&quot;));
        DualLands.add(new DLnd(&quot;Steam Vents&quot;, &quot;UR&quot;));
        DualLands.add(new DLnd(&quot;Bayou&quot;, &quot;BG&quot;));
        DualLands.add(new DLnd(&quot;Overgrown Tomb&quot;, &quot;BG&quot;));
        DualLands.add(new DLnd(&quot;Plateau&quot;, &quot;RW&quot;));
        DualLands.add(new DLnd(&quot;Sacred Foundry&quot;, &quot;RW&quot;));
        DualLands.add(new DLnd(&quot;Tropical Island&quot;, &quot;GU&quot;));
        DualLands.add(new DLnd(&quot;Breeding Pool&quot;, &quot;GU&quot;));

        if (Clr1.equals(&quot;AI&quot;)) {
            // choose first color
            color1 = notColors.get(r.nextInt(5));

            // choose second color
            String c2 = notColors.get(r.nextInt(5));
            while (c2.equals(color1))
                c2 = notColors.get(r.nextInt(5));
            color2 = c2;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/CombatUtil.java</td><td><a href="./xref/forge/CombatUtil.html#1232">1232</a></td></tr><tr class="a"><td>forge/CombatUtil.java</td><td><a href="./xref/forge/CombatUtil.html#1289">1289</a></td></tr><tr class="b"><td colspan='2'><div><pre>        ArrayList&lt;Trigger&gt; registeredTriggers = AllZone.getTriggerHandler().getRegisteredTriggers();
        for (Trigger trigger : registeredTriggers) {
            HashMap&lt;String, String&gt; trigParams = trigger.getMapParams();
            Card source = trigger.getHostCard();

            if (!combatTriggerWillTrigger(attacker, defender, trigger, null) || !trigParams.containsKey(&quot;Execute&quot;))
                continue;
            String ability = source.getSVar(trigParams.get(&quot;Execute&quot;));
            AbilityFactory AF = new AbilityFactory();
            HashMap&lt;String, String&gt; abilityParams = AF.getMapParams(ability, source);
            if (abilityParams.containsKey(&quot;ValidTgts&quot;) || abilityParams.containsKey(&quot;Tgt&quot;))
                continue; //targeted pumping not supported
            if (abilityParams.containsKey(&quot;AB&quot;) &amp;&amp; !abilityParams.get(&quot;AB&quot;).equals(&quot;Pump&quot;) &amp;&amp; !abilityParams.get(&quot;AB&quot;).equals(&quot;PumpAll&quot;))
                continue;
            if (abilityParams.containsKey(&quot;DB&quot;) &amp;&amp; !abilityParams.get(&quot;DB&quot;).equals(&quot;Pump&quot;) &amp;&amp; !abilityParams.get(&quot;DB&quot;).equals(&quot;PumpAll&quot;))
                continue;
            ArrayList&lt;Card&gt; list = new ArrayList&lt;Card&gt;();
            if (!abilityParams.containsKey(&quot;ValidCards&quot;)) //no pumpAll
                list = AbilityFactory.getDefinedCards(source, abilityParams.get(&quot;Defined&quot;), null);
            if (abilityParams.containsKey(&quot;Defined&quot;) &amp;&amp; abilityParams.get(&quot;Defined&quot;).equals(&quot;TriggeredAttacker&quot;))
                list.add(attacker);
            if (abilityParams.containsKey(&quot;ValidCards&quot;))
                if (attacker.isValidCard(abilityParams.get(&quot;ValidCards&quot;).split(&quot;,&quot;), source.getController(), source)
                        || attacker.isValidCard(abilityParams.get(&quot;ValidCards&quot;).replace(&quot;attacking+&quot;, &quot;&quot;).split(&quot;,&quot;)
                        , source.getController(), source))
                    list.add(attacker);
            if (list.isEmpty()) continue;
            if (!list.contains(attacker)) continue;
            if (!abilityParams.containsKey(&quot;NumDef&quot;)) continue;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DownloadPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadPictures_LQ.html#162">162</a></td></tr><tr class="a"><td>forge/Gui_MigrateLocalMWSSetPictures_HQ.java</td><td><a href="./xref/forge/Gui_MigrateLocalMWSSetPictures_HQ.html#229">229</a></td></tr><tr class="b"><td colspan='2'><div><pre>                System.out.println(card + &quot;/&quot; + cards.length + &quot; - &quot; + a);
            }
        }
        ;
        EventQueue.invokeLater(new Worker(card));
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;dlg&lt;/code&gt;.&lt;/p&gt;
     *
     * @param frame a {@link javax.swing.JFrame} object.
     * @return a {@link javax.swing.JDialog} object.
     */
    public JDialog getDlg(JFrame frame) {
        final JDialog dlg = this.dlg.createDialog(frame, ForgeProps.getLocalized(TITLE));
        close.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                dlg.setVisible(false);
            }
        });
        return dlg;
    }

    /**
     * &lt;p&gt;Setter for the field &lt;code&gt;cancel&lt;/code&gt;.&lt;/p&gt;
     *
     * @param cancel a boolean.
     */
    public void setCancel(boolean cancel) {
        this.cancel = cancel;
    }


    /**
     * &lt;p&gt;run.&lt;/p&gt;
     */
    public void run() {
        BufferedInputStream in;
        BufferedOutputStream out;

        File base = ForgeProps.getFile(IMAGE_BASE);

        //Random r = MyRandom.random;

        Proxy p = null;
        if (type == 0) p = Proxy.NO_PROXY;
        else try {
            p = new Proxy(types[type], new InetSocketAddress(addr.getText(), parseInt(port.getText())));
        } catch (Exception ex) {
            ErrorViewer.showError(ex, ForgeProps.getLocalized(ERRORS.PROXY_CONNECT), addr.getText(),
                    port.getText());
            //throw new RuntimeException(&quot;Gui_DownloadPictures : error 1 - &quot; +ex);
            return;
        }

        if (p != null) {
            byte[] buf = new byte[1024];
            int len;
            System.out.println(&quot;basedir: &quot; + base);
            for (update(0); card &lt; cards.length &amp;&amp; !cancel; update(card + 1)) {
                try {
                    String url = cards[card].url;
                    String cName;
                    if (cards[card].name.substring(0, 3).equals(&quot;[T]&quot;)) {
                        base = ForgeProps.getFile(IMAGE_TOKEN);
                        cName = cards[card].name.substring(3, cards[card].name.length());
                    } else {
                        base = ForgeProps.getFile(IMAGE_BASE);
                        cName = cards[card].name;
                    }

                    File f = new File(base, cName);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/CardShopTableModel.java</td><td><a href="./xref/forge/CardShopTableModel.html#95">95</a></td></tr><tr class="a"><td>forge/TableModel.java</td><td><a href="./xref/forge/TableModel.html#107">107</a></td></tr><tr class="b"><td colspan='2'><div><pre>                column.setMinWidth(30);
            }
        }//for

        /*for(int j = 0; j &lt; table.getColumnCount(); j++) {
            column = table.getColumnModel().getColumn(j);
            //System.out.println(&quot;col Width:&quot; + column.getPreferredWidth());
        }*/
    }

    /**
     * &lt;p&gt;clear.&lt;/p&gt;
     */
    public void clear() {
        dataNoCopies.clear();
        dataCopies.clear();
        //fireTableDataChanged();
    }

    /**
     * &lt;p&gt;getCards.&lt;/p&gt;
     *
     * @return a {@link forge.CardList} object.
     */
    public CardList getCards() {
        CardList all = new CardList();
        all.addAll(dataCopies);
        all.addAll(dataNoCopies);

        return all;
    }

    /**
     * &lt;p&gt;removeCard.&lt;/p&gt;
     *
     * @param c a {@link forge.Card} object.
     */
    public void removeCard(Card c) {
        //remove card from &quot;dataCopies&quot;,
        //if not found there, remove card from &quot;dataNoCopies&quot;
        int index = findCardName(c.getName(), dataCopies);

        if (index != -1) //found card name
            dataCopies.remove(index);
        else {
            index = findCardName(c.getName(), dataNoCopies);
            dataNoCopies.remove(index);
        }

        fireTableDataChanged();
    }

    /**
     * &lt;p&gt;findCardName.&lt;/p&gt;
     *
     * @param name a {@link java.lang.String} object.
     * @param list a {@link forge.CardList} object.
     * @return a int.
     */
    private int findCardName(String name, CardList list) {
        for (int i = 0; i &lt; list.size(); i++)
            if (list.get(i).getName().equals(name)) return i;

        return -1;
    }

    /**
     * &lt;p&gt;addCard.&lt;/p&gt;
     *
     * @param c a {@link forge.Card} object.
     */
    public void addCard(Card c) {
        if (0 == countQuantity(c, dataNoCopies)) dataNoCopies.add(c);
        else dataCopies.add(c);
    }

    /**
     * &lt;p&gt;addCard.&lt;/p&gt;
     *
     * @param c a {@link forge.CardList} object.
     */
    public void addCard(CardList c) {
        for (int i = 0; i &lt; c.size(); i++)
            addCard(c.get(i));

        fireTableDataChanged();
    }

    /**
     * &lt;p&gt;rowToCard.&lt;/p&gt;
     *
     * @param row a int.
     * @return a {@link forge.Card} object.
     */
    public Card rowToCard(int row) {
        return dataNoCopies.get(row);
    }

    /**
     * &lt;p&gt;countQuantity.&lt;/p&gt;
     *
     * @param c a {@link forge.Card} object.
     * @return a int.
     */
    private int countQuantity(Card c) {
        return countQuantity(c, dataNoCopies) + countQuantity(c, dataCopies);
    }

    //CardList data is either class members &quot;dataNoCopies&quot; or &quot;dataCopies&quot;
    /**
     * &lt;p&gt;countQuantity.&lt;/p&gt;
     *
     * @param c a {@link forge.Card} object.
     * @param data a {@link forge.CardList} object.
     * @return a int.
     */
    private int countQuantity(Card c, CardList data) {
        int count = 0;
        for (int i = 0; i &lt; data.size(); i++) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GUI_ImportPicture.java</td><td><a href="./xref/forge/GUI_ImportPicture.html#161">161</a></td></tr><tr class="a"><td>forge/GUI_ImportPicture.java</td><td><a href="./xref/forge/GUI_ImportPicture.html#257">257</a></td></tr><tr class="b"><td colspan='2'><div><pre>                        if (jCheckBox.isSelected()) {
                            filesForCopy = ff.getFilesNumber();
                            jLabelTotalFiles.setText(&quot;Total files for copying: &quot; + filesForCopy);
                            jLabelNeedSpace.setText(&quot;HDD Need Space: &quot; + ff.getDirectorySize() / 1024 / 1024
                                    + &quot; MB&quot;);
                            jProgressBar.setValue(0);
                            if ((freeSpaceM &gt; (ff.getDirectorySize() / 1024 / 1024)) &amp;&amp; (filesForCopy &gt; 0)) {
                                jButtonStart.setEnabled(true);
                            }
                        } else {

                            String fName;
                            int start;
                            long filesToCopySize;
                            filesForCopy = 0;
                            filesToCopySize = 0;
                            fileCopyList = new ArrayList&lt;File&gt;();

                            for (int i = 0; i &lt; listFiles.size(); i++) {

                                fName = listFiles.get(i).getName();
                                start = fName.indexOf(&quot;full&quot;);
                                fName = fName.substring(0, start - 1)
                                        + fName.substring(start + 4, fName.length() - 4);
                                fName = GuiDisplayUtil.cleanString(fName) + &quot;.jpg&quot;;
                                File file = new File(ForgeProps.getFile(IMAGE_BASE), fName);
                                if (!file.exists()) {
                                    filesForCopy = filesForCopy + 1;
                                    filesToCopySize = filesToCopySize + listFiles.get(i).length();
                                    fileCopyList.add(listFiles.get(i));
                                }
                            }
                            jLabelTotalFiles.setText(&quot;Total files for copying: &quot; + filesForCopy);
                            jLabelNeedSpace.setText(&quot;HDD Need Space: &quot; + filesToCopySize / 1024 / 1024 + &quot; MB&quot;);
                            jProgressBar.setValue(0);
                            if ((freeSpaceM &gt; (filesToCopySize / 1024 / 1024)) &amp;&amp; (filesForCopy &gt; 0)) {
                                jButtonStart.setEnabled(true);
                            }
                        }
                    }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GuiDisplayUtil.java</td><td><a href="./xref/forge/GuiDisplayUtil.html#440">440</a></td></tr><tr class="a"><td>forge/GuiDisplayUtil.java</td><td><a href="./xref/forge/GuiDisplayUtil.html#624">624</a></td></tr><tr class="b"><td colspan='2'><div><pre>                if (startANewStack) {
                    setupConnectedCards(connectedCards);
                    connectedCards.clear();

                    // Fixed distance if last was a stack, looks a bit nicer
                    if (atInStack &gt; 1) {
                        x += Math.max(addPanel.getPreferredSize().width, addPanel.getPreferredSize().height)
                                + marginX;
                    } else {
                        x = nextXIfNotStacked;
                    }

                    atInStack = 0;
                } else {
                    if (i != 0) {
                        x += cardOffset;
                    }
                }

                nextXIfNotStacked = x + marginX + addPanel.getPreferredSize().width;

                int xLoc = x;

                int yLoc = marginY;
                yLoc += atInStack * cardOffset;

                addPanel.setLocation(new Point(xLoc, yLoc));
                addPanel.setSize(addPanel.getPreferredSize());


                cards.add(addPanel);

                connectedCards.add((CardPanel) addPanel);

                atInStack++;
                prevCard = c;
            }

            setupConnectedCards(connectedCards);
            connectedCards.clear();


            for (int i = cards.size() - 1; i &gt;= 0; i--) {
                JPanel card = cards.get(i);
                //maxX = Math.max(maxX, card.getLocation().x + card.getSize().width + marginX);
                maxY = Math.max(maxY, card.getLocation().y + card.getSize().height + marginY);
                p.add(card);
            }

            maxX = nextXIfNotStacked;

            if (maxX &gt; 0 &amp;&amp; maxY &gt; 0) { //p.getSize().width || maxY &gt; p.getSize().height) {
                p.setPreferredSize(new Dimension(maxX, maxY));
            }

        } else {
            JPanel addPanel;
            for (int i = 0; i &lt; list.size(); i++) {
                c = list.get(i);
                addPanel = new CardPanel(c);

                p.add(addPanel);
            }
        }
    }//setupPanel()</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Animate.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Animate.html#397">397</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Animate.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Animate.html#796">796</a></td></tr><tr class="b"><td colspan='2'><div><pre>        for (final Card c : list) {
            final ArrayList&lt;String&gt; originalTypes = c.getType();
            final int origPower = c.getBaseAttack();
            final int origToughness = c.getBaseDefense();

            final long timestamp = doAnimate(c, af, power, toughness, types, finalDesc, keywords);

            //give abilities
            final ArrayList&lt;SpellAbility&gt; addedAbilities = new ArrayList&lt;SpellAbility&gt;();
            if (abilities.size() &gt; 0) {
                for (String s : abilities) {
                    AbilityFactory newAF = new AbilityFactory();
                    String actualAbility = host.getSVar(s);
                    SpellAbility grantedAbility = newAF.getAbility(actualAbility, c);
                    addedAbilities.add(grantedAbility);
                    c.addSpellAbility(grantedAbility);
                }
            }

            //Grant triggers
            final ArrayList&lt;Trigger&gt; addedTriggers = new ArrayList&lt;Trigger&gt;();
            if (triggers.size() &gt; 0) {
                for (String s : triggers) {
                    String actualTrigger = host.getSVar(s);
                    Trigger parsedTrigger = TriggerHandler.parseTrigger(actualTrigger, c);
                    addedTriggers.add(c.addTrigger(parsedTrigger));
                    AllZone.getTriggerHandler().registerTrigger(parsedTrigger);
                }
            }

            final Command unanimate = new Command() {
                private static final long serialVersionUID = -5861759814760561373L;

                public void execute() {
                    doUnanimate(c, af, origPower, origToughness, originalTypes, finalDesc, keywords, addedAbilities, addedTriggers, timestamp);
                }
            };

            if (!permanent) {
                if (params.containsKey(&quot;UntilEndOfCombat&quot;)) AllZone.getEndOfCombat().addUntil(unanimate);
                else AllZone.getEndOfTurn().addUntil(unanimate);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_CardShop.java</td><td><a href="./xref/forge/Gui_CardShop.html#348">348</a></td></tr><tr class="a"><td>forge/Gui_DeckEditor.java</td><td><a href="./xref/forge/Gui_DeckEditor.html#544">544</a></td></tr><tr class="b"><td colspan='2'><div><pre>        gPBW.dispose();
    }//show(Command)

    /**
     * &lt;p&gt;addListeners.&lt;/p&gt;
     */
    private void addListeners() {
        MouseInputListener l = new MouseInputListener() {
            public void mouseReleased(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mousePressed(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseExited(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseEntered(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseClicked(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseMoved(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseDragged(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            private void redispatchMouseEvent(MouseEvent e) {
                Container content = getContentPane();
                Point glassPoint = e.getPoint();
                Point contentPoint = SwingUtilities.convertPoint(glassPane, glassPoint, content);

                Component component = SwingUtilities.getDeepestComponentAt(content, contentPoint.x, contentPoint.y);
                if (component == null || !SwingUtilities.isDescendingFrom(component, picture)) {
                    glassPane.setVisible(false);
                }
            }
        };

        glassPane.addMouseMotionListener(l);
        glassPane.addMouseListener(l);

        picture.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseEntered(MouseEvent e) {
                Card c = picture.getCard();
                if (c == null) return;
                Image i = ImageCache.getOriginalImage(c);
                if (i == null) return;
                if (i.getWidth(null) &lt; 300) return;
                glassPane.setVisible(true);
            }
        });
    }//addListeners()

    /**
     * &lt;p&gt;setup.&lt;/p&gt;
     */
    private void setup() {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/CardShopTableModel.java</td><td><a href="./xref/forge/CardShopTableModel.html#278">278</a></td></tr><tr class="a"><td>forge/TableModel.java</td><td><a href="./xref/forge/TableModel.html#323">323</a></td></tr><tr class="b"><td colspan='2'><div><pre>            default:
                return &quot;error&quot;;
        }
    }

    /**
     * &lt;p&gt;addListeners.&lt;/p&gt;
     *
     * @param table a {@link javax.swing.JTable} object.
     */
    public void addListeners(final JTable table) {
        //updates card detail, listens to any key strokes
        table.addKeyListener(new KeyListener() {
            public void keyPressed(KeyEvent ev) {
            }

            public void keyTyped(KeyEvent ev) {
            }

            public void keyReleased(KeyEvent ev) {
                int row = table.getSelectedRow();
                if (row != -1) {
                    cardDetail.setCard(dataNoCopies.get(row));
                }
            }
        });
        //updates card detail, listens to any mouse clicks
        table.addMouseListener(new MouseAdapter() {
            @Override
            public void mousePressed(MouseEvent e) {
                int row = table.getSelectedRow();
                if (row != -1) {
                    cardDetail.setCard(dataNoCopies.get(row));
                }
            }
        });

        //sorts
        MouseListener mouse = new MouseAdapter() {
            @Override
            public void mousePressed(MouseEvent e) {
                TableColumnModel columnModel = table.getColumnModel();
                int viewColumn = columnModel.getColumnIndexAtX(e.getX());
                int column = table.convertColumnIndexToModel(viewColumn);


                if (column != -1) {
                    //sort ascending
                    @SuppressWarnings(&quot;unused&quot;)
                    boolean change = sort(column, true);

                    //if(! change)
                    //  sort(column, false);//sort descending

                    //fireTableDataChanged();
                }
            }//mousePressed()
        };//MouseListener
        table.getTableHeader().addMouseListener(mouse);
    }//addCardListener()

    //called by the GUI when a card is added to re-sort
    /**
     * &lt;p&gt;resort.&lt;/p&gt;
     */
    public void resort() {
        sort(recentSortedColumn, recentAscending);
        //this.fireTableDataChanged();
    }

    //returns true if any data changed positions
    // @SuppressWarnings(&quot;unchecked&quot;)
    // Arrays.sort
    /**
     * &lt;p&gt;sort.&lt;/p&gt;
     *
     * @param column a int.
     * @param ascending a boolean.
     * @return a boolean.
     */
    public boolean sort(int column, boolean ascending) {
        //used by addCard() to resort the cards
        recentSortedColumn = column;
        recentAscending = ascending;

        CardList all = new CardList();
        all.addAll(dataNoCopies);
        all.addAll(dataCopies);

        TableSorter sorter = new TableSorter(all, column, ascending, true);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_CardShop.java</td><td><a href="./xref/forge/Gui_CardShop.html#347">347</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor.html#417">417</a></td></tr><tr class="b"><td colspan='2'><div><pre>        topModel.sort(3, true);//then sort by color

        bottomModel.sort(1, true);
    }//show(Command)

    /**
     * &lt;p&gt;addListeners.&lt;/p&gt;
     */
    private void addListeners() {
        MouseInputListener l = new MouseInputListener() {
            public void mouseReleased(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mousePressed(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseExited(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseEntered(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseClicked(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseMoved(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseDragged(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            private void redispatchMouseEvent(MouseEvent e) {
                Container content = getContentPane();
                Point glassPoint = e.getPoint();
                Point contentPoint = SwingUtilities.convertPoint(glassPane, glassPoint, content);

                Component component = SwingUtilities.getDeepestComponentAt(content, contentPoint.x, contentPoint.y);
                if (component == null || !SwingUtilities.isDescendingFrom(component, picture)) {
                    glassPane.setVisible(false);
                }
            }
        };

        glassPane.addMouseMotionListener(l);
        glassPane.addMouseListener(l);

        picture.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseEntered(MouseEvent e) {
                Card c = picture.getCard();
                if (c == null) return;
                Image i = ImageCache.getOriginalImage(c);
                if (i == null) return;
                if (i.getWidth(null) &lt; 200) return;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Destroy.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Destroy.html#609">609</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Sacrifice.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Sacrifice.html#586">586</a></td></tr><tr class="b"><td colspan='2'><div><pre>        computerlist = computerlist.getValidCards(Valid.split(&quot;,&quot;), source.getController(), source);

        if (abCost != null) {
            // AI currently disabled for some costs
            if (abCost.getSacCost()) {
                //OK
            }
            if (abCost.getLifeCost()) {
                if (AllZone.getComputerPlayer().getLife() - abCost.getLifeAmount() &lt; 4)
                    return false;
            }
            if (abCost.getDiscardCost()) ;//OK

            if (abCost.getSubCounter()) {
                // OK
            }
        }

        if (!ComputerUtil.canPayCost(sa))
            return false;

        // prevent run-away activations - first time will always return true
        boolean chance = r.nextFloat() &lt;= Math.pow(.6667, source.getAbilityUsed());

        // if only creatures are affected evaluate both lists and pass only if human creatures are more valuable
        if (humanlist.getNotType(&quot;Creature&quot;).size() == 0 &amp;&amp; computerlist.getNotType(&quot;Creature&quot;).size() == 0) {
            if (CardFactoryUtil.evaluateCreatureList(computerlist) + 200 &gt;= CardFactoryUtil.evaluateCreatureList(humanlist))
                return false;
        }//only lands involved
        else if (humanlist.getNotType(&quot;Land&quot;).size() == 0 &amp;&amp; computerlist.getNotType(&quot;Land&quot;).size() == 0) {
            if (CardFactoryUtil.evaluatePermanentList(computerlist) + 1 &gt;= CardFactoryUtil.evaluatePermanentList(humanlist))
                return false;
        } // otherwise evaluate both lists by CMC and pass only if human permanents are more valuable
        else if (CardFactoryUtil.evaluatePermanentList(computerlist) + 3 &gt;= CardFactoryUtil.evaluatePermanentList(humanlist))
            return false;

        Ability_Sub subAb = sa.getSubAbility();
        if (subAb != null)
            chance &amp;= subAb.chkAI_Drawback();

        return ((r.nextFloat() &lt; .9667) &amp;&amp; chance);
    }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/BoosterDraftAI.java</td><td><a href="./xref/forge/BoosterDraftAI.html#402">402</a></td></tr><tr class="a"><td>forge/SealedDeck.java</td><td><a href="./xref/forge/SealedDeck.html#332">332</a></td></tr><tr class="b"><td colspan='2'><div><pre>                    String mc = deck.get(i).getManaCost();

                    // count each mana symbol in the mana cost
                    for (int j = 0; j &lt; mc.length(); j++) {
                        char c = mc.charAt(j);

                        if (c == 'W')
                            ClrCnts[0].Count++;
                        else if (c == 'U')
                            ClrCnts[1].Count++;
                        else if (c == 'B')
                            ClrCnts[2].Count++;
                        else if (c == 'R')
                            ClrCnts[3].Count++;
                        else if (c == 'G')
                            ClrCnts[4].Count++;
                    }
                }

                // total of all ClrCnts
                int totalColor = 0;
                for (i = 0; i &lt; 5; i++) {
                    totalColor += ClrCnts[i].Count;
                }

                for (i = 0; i &lt; 5; i++) {
                    if (ClrCnts[i].Count &gt; 0) {    // calculate number of lands for each color
                        float p = (float) ClrCnts[i].Count / (float) totalColor;
                        int nLand = (int) ((float) landsNeeded * p) + 1;
                        //tmpDeck += &quot;nLand-&quot; + ClrCnts[i].Color + &quot;:&quot; + nLand + &quot;\n&quot;;
                        if (Constant.Runtime.DevMode[0])
                            System.out.println(&quot;Basics[&quot; + ClrCnts[i].Color + &quot;]:&quot; + nLand);

                        for (int j = 0; j &lt;= nLand; j++) {
                            Card c = AllZone.getCardFactory().getCard(ClrCnts[i].Color, AllZone.getComputerPlayer());
                            c.setCurSetCode(this.LandSetCode[0]);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DeckEditor.java</td><td><a href="./xref/forge/Gui_DeckEditor.html#544">544</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor.html#419">419</a></td></tr><tr class="b"><td colspan='2'><div><pre>        bottomModel.sort(1, true);
    }//show(Command)

    /**
     * &lt;p&gt;addListeners.&lt;/p&gt;
     */
    private void addListeners() {
        MouseInputListener l = new MouseInputListener() {
            public void mouseReleased(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mousePressed(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseExited(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseEntered(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseClicked(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseMoved(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            public void mouseDragged(MouseEvent e) {
                redispatchMouseEvent(e);
            }

            private void redispatchMouseEvent(MouseEvent e) {
                Container content = getContentPane();
                Point glassPoint = e.getPoint();
                Point contentPoint = SwingUtilities.convertPoint(glassPane, glassPoint, content);

                Component component = SwingUtilities.getDeepestComponentAt(content, contentPoint.x, contentPoint.y);
                if (component == null || !SwingUtilities.isDescendingFrom(component, picture)) {
                    glassPane.setVisible(false);
                }
            }
        };

        glassPane.addMouseMotionListener(l);
        glassPane.addMouseListener(l);

        picture.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseEntered(MouseEvent e) {
                Card c = picture.getCard();
                if (c == null) return;
                Image i = ImageCache.getOriginalImage(c);
                if (i == null) return;
                if (i.getWidth(null) &lt; 200) return;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/deck/generate/Generate2ColorDeck.java</td><td><a href="./xref/forge/deck/generate/Generate2ColorDeck.html#277">277</a></td></tr><tr class="a"><td>forge/deck/generate/GenerateThemeDeck.java</td><td><a href="./xref/forge/deck/generate/GenerateThemeDeck.html#178">178</a></td></tr><tr class="b"><td colspan='2'><div><pre>        if (numBLands &gt; 0)    // attempt to optimize basic land counts according to color representation
        {
            CCnt ClrCnts[] = {new CCnt(&quot;Plains&quot;, 0),
                    new CCnt(&quot;Island&quot;, 0),
                    new CCnt(&quot;Swamp&quot;, 0),
                    new CCnt(&quot;Mountain&quot;, 0),
                    new CCnt(&quot;Forest&quot;, 0)};

            // count each instance of a color in mana costs
            // TODO: count hybrid mana differently?
            for (int i = 0; i &lt; tDeck.size(); i++) {
                String mc = tDeck.get(i).getManaCost();

                for (int j = 0; j &lt; mc.length(); j++) {
                    char c = mc.charAt(j);

                    if (c == 'W')
                        ClrCnts[0].Count++;
                    else if (c == 'U')
                        ClrCnts[1].Count++;
                    else if (c == 'B')
                        ClrCnts[2].Count++;
                    else if (c == 'R')
                        ClrCnts[3].Count++;
                    else if (c == 'G')
                        ClrCnts[4].Count++;
                }
            }

            int totalColor = 0;
            for (int i = 0; i &lt; 5; i++) {
                totalColor += ClrCnts[i].Count;
                tmpDeck += ClrCnts[i].Color + &quot;:&quot; + ClrCnts[i].Count + &quot;\n&quot;;
            }

            tmpDeck += &quot;totalColor:&quot; + totalColor + &quot;\n&quot;;

            for (int i = 0; i &lt; 5; i++) {
                if (ClrCnts[i].Count &gt; 0) {    // calculate number of lands for each color</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/CombatUtil.java</td><td><a href="./xref/forge/CombatUtil.html#1118">1118</a></td></tr><tr class="a"><td>forge/CombatUtil.java</td><td><a href="./xref/forge/CombatUtil.html#1171">1171</a></td></tr><tr class="b"><td colspan='2'><div><pre>        toughness += defender.getKeywordMagnitude(&quot;Bushido&quot;);

        ArrayList&lt;Trigger&gt; registeredTriggers = AllZone.getTriggerHandler().getRegisteredTriggers();
        for (Trigger trigger : registeredTriggers) {
            HashMap&lt;String, String&gt; trigParams = trigger.getMapParams();
            Card source = trigger.getHostCard();

            if (!combatTriggerWillTrigger(attacker, defender, trigger, null) || !trigParams.containsKey(&quot;Execute&quot;))
                continue;
            String ability = source.getSVar(trigParams.get(&quot;Execute&quot;));
            AbilityFactory AF = new AbilityFactory();
            HashMap&lt;String, String&gt; abilityParams = AF.getMapParams(ability, source);
            if (abilityParams.containsKey(&quot;AB&quot;) &amp;&amp; !abilityParams.get(&quot;AB&quot;).equals(&quot;Pump&quot;))
                continue;
            if (abilityParams.containsKey(&quot;DB&quot;) &amp;&amp; !abilityParams.get(&quot;DB&quot;).equals(&quot;Pump&quot;))
                continue;
            if (abilityParams.containsKey(&quot;ValidTgts&quot;) || abilityParams.containsKey(&quot;Tgt&quot;))
                continue; //targeted pumping not supported
            ArrayList&lt;Card&gt; list = AbilityFactory.getDefinedCards(source, abilityParams.get(&quot;Defined&quot;), null);
            if (abilityParams.containsKey(&quot;Defined&quot;) &amp;&amp; abilityParams.get(&quot;Defined&quot;).equals(&quot;TriggeredBlocker&quot;))
                list.add(defender);
            if (list.isEmpty()) continue;
            if (!list.contains(defender)) continue;
            if (!abilityParams.containsKey(&quot;NumDef&quot;)) continue;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_Quest_DeckEditor_Menu.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor_Menu.html#94">94</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor_Menu.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor_Menu.html#163">163</a></td></tr><tr class="b"><td colspan='2'><div><pre>        clearfilter.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent ev) {

                Gui_Quest_DeckEditor g = (Gui_Quest_DeckEditor) deckDisplay;
                if (g.stCardList == null) {
                    g.blackCheckBox.setSelected(true);
                    g.blackCheckBox.setEnabled(true);
                    g.blueCheckBox.setSelected(true);
                    g.blueCheckBox.setEnabled(true);
                    g.greenCheckBox.setSelected(true);
                    g.greenCheckBox.setEnabled(true);
                    g.redCheckBox.setSelected(true);
                    g.redCheckBox.setEnabled(true);
                    g.whiteCheckBox.setSelected(true);
                    g.whiteCheckBox.setEnabled(true);
                    g.colorlessCheckBox.setSelected(true);
                    g.colorlessCheckBox.setEnabled(true);
                    g.artifactCheckBox.setSelected(true);
                    g.artifactCheckBox.setEnabled(true);
                    g.creatureCheckBox.setSelected(true);
                    g.creatureCheckBox.setEnabled(true);
                    g.enchantmentCheckBox.setSelected(true);
                    g.enchantmentCheckBox.setEnabled(true);
                    g.instantCheckBox.setSelected(true);
                    g.instantCheckBox.setEnabled(true);
                    g.landCheckBox.setSelected(true);
                    g.landCheckBox.setEnabled(true);
                    g.planeswalkerCheckBox.setSelected(true);
                    g.planeswalkerCheckBox.setEnabled(true);
                    g.sorceryCheckBox.setSelected(true);
                    g.sorceryCheckBox.setEnabled(true);
                    g.filterUsed = false;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_CardShop.java</td><td><a href="./xref/forge/Gui_CardShop.html#139">139</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor.html#159">159</a></td></tr><tr class="b"><td colspan='2'><div><pre>            c.setRarity(c.getSVar(&quot;Rarity&quot;));

            //String PC = c.getSVar(&quot;PicCount&quot;);
            Random r = MyRandom.random;
            //int n = 0;
            //if (!PC.equals(&quot;&quot;)){
            //	if (PC.matches(&quot;[0-9][0-9]?&quot;))
            //		n = Integer.parseInt(PC);
            //	if (n &gt; 1)
            //		c.setRandomPicture(r.nextInt(n));
            //}

            if (c.getCurSetCode().equals(&quot;&quot;))
                c.setCurSetCode(c.getMostRecentSet());

            if (!c.getCurSetCode().equals(&quot;&quot;)) {
                int n = SetInfoUtil.getSetInfo_Code(c.getSets(), c.getCurSetCode()).PicCount;
                if (n &gt; 1)
                    c.setRandomPicture(r.nextInt(n - 1) + 1);

                c.setImageFilename(CardUtil.buildFilename(c));
            }

            bottomModel.addCard(c);
        }//for

        topModel.resort();
        bottomModel.resort();
    }//updateDisplay

    /**
     * &lt;p&gt;updateDisplay.&lt;/p&gt;
     */
    public void updateDisplay() {
        //updateDisplay(this.top, this.bottom);

        topModel.clear();

        top = AllZone.getNameChanger().changeCardsIfNeeded(top);
        bottom = AllZone.getNameChanger().changeCardsIfNeeded(bottom);

        Card c;
        String cardName;
        ReadBoosterPack pack = new ReadBoosterPack();

        // update top
        for (int i = 0; i &lt; top.size(); i++) {
            c = top.get(i);

            // add rarity to card if this is a sealed card pool

            cardName = AllZone.getNameChanger().getOriginalName(c.getName());
            if (!pack.getRarity(cardName).equals(&quot;error&quot;)) {
                c.setRarity(pack.getRarity(cardName));
            }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Sorceries.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Sorceries.html#746">746</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Sorceries.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Sorceries.html#1931">1931</a></td></tr><tr class="b"><td colspan='2'><div><pre>                int damage = 3;
                Card check;

                @Override
                public boolean canPlayAI() {
                    if (AllZone.getHumanPlayer().getLife() &lt;= damage) return true;

                    check = getFlying();
                    return check != null;
                }

                @Override
                public void chooseTargetAI() {
                    if (AllZone.getHumanPlayer().getLife() &lt;= damage) {
                        setTargetPlayer(AllZone.getHumanPlayer());
                        return;
                    }

                    Card c = getFlying();
                    if ((c == null) || (!check.equals(c))) throw new RuntimeException(card
                            + &quot; error in chooseTargetAI() - Card c is &quot; + c + &quot;,  Card check is &quot; + check);

                    setTargetCard(c);
                }//chooseTargetAI()

                //uses &quot;damage&quot; variable
                Card getFlying() {
                    CardList flying = CardFactoryUtil.AI_getHumanCreature(&quot;Flying&quot;, card, true);
                    for (int i = 0; i &lt; flying.size(); i++)
                        if (flying.get(i).getNetDefense() &lt;= damage) return flying.get(i);

                    return null;
                }

                @Override
                public void resolve() {

                    int damage = getDamage();

                    if (getTargetCard() != null) {
                        if (AllZoneUtil.isCardInPlay(getTargetCard())
                                &amp;&amp; CardFactoryUtil.canTarget(card, getTargetCard())) {
                            javax.swing.JOptionPane.showMessageDialog(null, cardName + &quot; causes &quot; + damage</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Instants.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Instants.html#308">308</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Sorceries.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Sorceries.html#654">654</a></td></tr><tr class="b"><td colspan='2'><div><pre>                @Override
                public boolean canPlayAI() {
                    CardList c = getCreature();
                    if (c.isEmpty()) return false;
                    else {
                        setTargetCard(c.get(0));
                        return true;
                    }
                }//canPlayAI()

                CardList getCreature() {
                    CardList out = new CardList();
                    CardList list = CardFactoryUtil.AI_getHumanCreature(&quot;Flying&quot;, card, true);
                    list.shuffle();

                    for (int i = 0; i &lt; list.size(); i++)
                        if ((list.get(i).getNetAttack() &gt;= 2) &amp;&amp; (list.get(i).getNetDefense() &lt;= 2))
                            out.add(list.get(i));

                    //in case human player only has a few creatures in play, target anything
                    if (out.isEmpty() &amp;&amp; 0 &lt; CardFactoryUtil.AI_getHumanCreature(2, card, true).size()
                            &amp;&amp; 3 &gt; CardFactoryUtil.AI_getHumanCreature(card, true).size()) {
                        out.addAll(CardFactoryUtil.AI_getHumanCreature(2, card, true));
                        CardListUtil.sortFlying(out);
                    }
                    return out;
                }//getCreature()


                @Override
                public void resolve() {
                    if (AllZoneUtil.isCardInPlay(getTargetCard())
                            &amp;&amp; CardFactoryUtil.canTarget(card, getTargetCard())) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DownloadPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadPictures_LQ.html#204">204</a></td></tr><tr class="a"><td>forge/Gui_DownloadSetPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadSetPictures_LQ.html#271">271</a></td></tr><tr class="b"><td colspan='2'><div><pre>        Proxy p = null;
        if (type == 0) p = Proxy.NO_PROXY;
        else try {
            p = new Proxy(types[type], new InetSocketAddress(addr.getText(), parseInt(port.getText())));
        } catch (Exception ex) {
            ErrorViewer.showError(ex, ForgeProps.getLocalized(ERRORS.PROXY_CONNECT), addr.getText(),
                    port.getText());
//            throw new RuntimeException(&quot;Gui_DownloadPictures : error 1 - &quot; +ex);
            return;
        }

        if (p != null) {
            byte[] buf = new byte[1024];
            int len;
            System.out.println(&quot;basedir: &quot; + base);
            for (update(0); card &lt; cards.length &amp;&amp; !cancel; update(card + 1)) {
                try {
                    String url = cards[card].url;
                    String cName;
                    if (cards[card].name.substring(0, 3).equals(&quot;[T]&quot;)) {
                        base = ForgeProps.getFile(IMAGE_TOKEN);
                        cName = cards[card].name.substring(3, cards[card].name.length());
                    } else {
                        base = ForgeProps.getFile(IMAGE_BASE);
                        cName = cards[card].name;
                    }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_PermanentState.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_PermanentState.html#386">386</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_PermanentState.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_PermanentState.html#848">848</a></td></tr><tr class="b"><td colspan='2'><div><pre>        for (Card c : tgt.getTargetCards())
            tapList.remove(c);

        if (tapList.size() == 0)
            return false;

        while (tgt.getNumTargeted() &lt; tgt.getMaxTargets(source, sa)) {
            Card choice = null;

            if (tapList.size() == 0) {
                if (tgt.getNumTargeted() &lt; tgt.getMinTargets(source, sa) || tgt.getNumTargeted() == 0) {
                    if (!mandatory)
                        tgt.resetTargets();
                    return false;
                } else {
                    // TODO is this good enough? for up to amounts?
                    break;
                }
            }

            if (tapList.getNotType(&quot;Creature&quot;).size() == 0)
                choice = CardFactoryUtil.AI_getBestCreature(tapList); //if only creatures take the best
            else
                choice = CardFactoryUtil.AI_getMostExpensivePermanent(tapList, af.getHostCard(), false);

            if (choice == null) {    // can't find anything left
                if (tgt.getNumTargeted() &lt; tgt.getMinTargets(sa.getSourceCard(), sa) || tgt.getNumTargeted() == 0) {
                    if (!mandatory)
                        tgt.resetTargets();
                    return false;
                } else {
                    // TODO is this good enough? for up to amounts?
                    break;
                }
            }

            tapList.remove(choice);
            tgt.addTarget(choice);
        }

        return true;
    }

    /**
     * &lt;p&gt;tapResolve.&lt;/p&gt;
     *
     * @param af a {@link forge.card.abilityFactory.AbilityFactory} object.
     * @param sa a {@link forge.card.spellability.SpellAbility} object.
     */
    private static void tapResolve(final AbilityFactory af, final SpellAbility sa) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_WinLose.java</td><td><a href="./xref/forge/Gui_WinLose.html#240">240</a></td></tr><tr class="a"><td>forge/Gui_WinLose.java</td><td><a href="./xref/forge/Gui_WinLose.html#274">274</a></td></tr><tr class="b"><td colspan='2'><div><pre>        if (!Constant.Quest.fantasyQuest[0])
            AllZone.getGameAction().newGame(Constant.Runtime.HumanDeck[0], Constant.Runtime.ComputerDeck[0]);
        else {
            int extraLife = 0;
            //AllZone.getGameAction().newGame(Constant.Runtime.HumanDeck[0], Constant.Runtime.ComputerDeck[0], humanList, computerList, humanLife, computerLife);
            if (AllZone.getQuestAssignment() != null) {
                forge.quest.data.QuestUtil.setupQuest(AllZone.getQuestAssignment());
                if (AllZone.getQuestData().getInventory().hasItem(&quot;Zeppelin&quot;))
                    extraLife = 3;
            }

            CardList humanList = forge.quest.data.QuestUtil.getHumanPlantAndPet(AllZone.getQuestData(), AllZone.getQuestAssignment());
            //CardList computerList = QuestUtil.getComputerCreatures(AllZone.getQuestData(), AllZone.getQuestAssignment());
            CardList computerList = new CardList();

            int humanLife = AllZone.getQuestData().getLife() + extraLife;
            int computerLife = 20;

            if (AllZone.getQuestAssignment() != null)
                computerLife = AllZone.getQuestAssignment().getComputerLife();

            AllZone.getGameAction().newGame(Constant.Runtime.HumanDeck[0], Constant.Runtime.ComputerDeck[0], humanList, computerList, humanLife, computerLife, AllZone.getQuestAssignment());
        }
        AllZone.getDisplay().setVisible(true);

        dispose();
    }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GUI_Filter.java</td><td><a href="./xref/forge/GUI_Filter.html#641">641</a></td></tr><tr class="a"><td>forge/Gui_DeckEditor_Menu.java</td><td><a href="./xref/forge/Gui_DeckEditor_Menu.html#119">119</a></td></tr><tr class="b"><td colspan='2'><div><pre>                deckDisplay.updateDisplay(deckDisplay.getTop(), deckDisplay.getBottom());
                Gui_DeckEditor g = (Gui_DeckEditor) deckDisplay;
                g.blackCheckBox.setSelected(true);
                g.blackCheckBox.setEnabled(true);
                g.blueCheckBox.setSelected(true);
                g.blueCheckBox.setEnabled(true);
                g.greenCheckBox.setSelected(true);
                g.greenCheckBox.setEnabled(true);
                g.redCheckBox.setSelected(true);
                g.redCheckBox.setEnabled(true);
                g.whiteCheckBox.setSelected(true);
                g.whiteCheckBox.setEnabled(true);
                g.colorlessCheckBox.setSelected(true);
                g.colorlessCheckBox.setEnabled(true);
                g.artifactCheckBox.setSelected(true);
                g.artifactCheckBox.setEnabled(true);
                g.creatureCheckBox.setSelected(true);
                g.creatureCheckBox.setEnabled(true);
                g.enchantmentCheckBox.setSelected(true);
                g.enchantmentCheckBox.setEnabled(true);
                g.instantCheckBox.setSelected(true);
                g.instantCheckBox.setEnabled(true);
                g.landCheckBox.setSelected(true);
                g.landCheckBox.setEnabled(true);
                g.planeswalkerCheckBox.setSelected(true);
                g.planeswalkerCheckBox.setEnabled(true);
                g.sorceryCheckBox.setSelected(true);
                g.sorceryCheckBox.setEnabled(true);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_Quest_DeckEditor_Menu.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor_Menu.html#167">167</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor_Menu.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor_Menu.html#195">195</a></td></tr><tr class="b"><td colspan='2'><div><pre>                } else {
                    g.blackCheckBox.setSelected(true);
                    g.blackCheckBox.setEnabled(true);
                    g.blueCheckBox.setSelected(true);
                    g.blueCheckBox.setEnabled(true);
                    g.greenCheckBox.setSelected(true);
                    g.greenCheckBox.setEnabled(true);
                    g.redCheckBox.setSelected(true);
                    g.redCheckBox.setEnabled(true);
                    g.whiteCheckBox.setSelected(true);
                    g.whiteCheckBox.setEnabled(true);
                    g.colorlessCheckBox.setSelected(true);
                    g.colorlessCheckBox.setEnabled(true);
                    g.artifactCheckBox.setSelected(true);
                    g.artifactCheckBox.setEnabled(true);
                    g.creatureCheckBox.setSelected(true);
                    g.creatureCheckBox.setEnabled(true);
                    g.enchantmentCheckBox.setSelected(true);
                    g.enchantmentCheckBox.setEnabled(true);
                    g.instantCheckBox.setSelected(true);
                    g.instantCheckBox.setEnabled(true);
                    g.landCheckBox.setSelected(true);
                    g.landCheckBox.setEnabled(true);
                    g.planeswalkerCheckBox.setSelected(true);
                    g.planeswalkerCheckBox.setEnabled(true);
                    g.sorceryCheckBox.setSelected(true);
                    g.sorceryCheckBox.setEnabled(true);
                    g.filterUsed = false;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_Quest_DeckEditor_Menu.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor_Menu.html#97">97</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor_Menu.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor_Menu.html#195">195</a></td></tr><tr class="b"><td colspan='2'><div><pre>                } else {
                    g.blackCheckBox.setSelected(true);
                    g.blackCheckBox.setEnabled(true);
                    g.blueCheckBox.setSelected(true);
                    g.blueCheckBox.setEnabled(true);
                    g.greenCheckBox.setSelected(true);
                    g.greenCheckBox.setEnabled(true);
                    g.redCheckBox.setSelected(true);
                    g.redCheckBox.setEnabled(true);
                    g.whiteCheckBox.setSelected(true);
                    g.whiteCheckBox.setEnabled(true);
                    g.colorlessCheckBox.setSelected(true);
                    g.colorlessCheckBox.setEnabled(true);
                    g.artifactCheckBox.setSelected(true);
                    g.artifactCheckBox.setEnabled(true);
                    g.creatureCheckBox.setSelected(true);
                    g.creatureCheckBox.setEnabled(true);
                    g.enchantmentCheckBox.setSelected(true);
                    g.enchantmentCheckBox.setEnabled(true);
                    g.instantCheckBox.setSelected(true);
                    g.instantCheckBox.setEnabled(true);
                    g.landCheckBox.setSelected(true);
                    g.landCheckBox.setEnabled(true);
                    g.planeswalkerCheckBox.setSelected(true);
                    g.planeswalkerCheckBox.setEnabled(true);
                    g.sorceryCheckBox.setSelected(true);
                    g.sorceryCheckBox.setEnabled(true);
                    g.filterUsed = false;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GUI_Filter.java</td><td><a href="./xref/forge/GUI_Filter.html#643">643</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor_Menu.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor_Menu.html#196">196</a></td></tr><tr class="b"><td colspan='2'><div><pre>                    g.blackCheckBox.setSelected(true);
                    g.blackCheckBox.setEnabled(true);
                    g.blueCheckBox.setSelected(true);
                    g.blueCheckBox.setEnabled(true);
                    g.greenCheckBox.setSelected(true);
                    g.greenCheckBox.setEnabled(true);
                    g.redCheckBox.setSelected(true);
                    g.redCheckBox.setEnabled(true);
                    g.whiteCheckBox.setSelected(true);
                    g.whiteCheckBox.setEnabled(true);
                    g.colorlessCheckBox.setSelected(true);
                    g.colorlessCheckBox.setEnabled(true);
                    g.artifactCheckBox.setSelected(true);
                    g.artifactCheckBox.setEnabled(true);
                    g.creatureCheckBox.setSelected(true);
                    g.creatureCheckBox.setEnabled(true);
                    g.enchantmentCheckBox.setSelected(true);
                    g.enchantmentCheckBox.setEnabled(true);
                    g.instantCheckBox.setSelected(true);
                    g.instantCheckBox.setEnabled(true);
                    g.landCheckBox.setSelected(true);
                    g.landCheckBox.setEnabled(true);
                    g.planeswalkerCheckBox.setSelected(true);
                    g.planeswalkerCheckBox.setEnabled(true);
                    g.sorceryCheckBox.setSelected(true);
                    g.sorceryCheckBox.setEnabled(true);
                    g.stCardList = g.getTop();</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_Quest_DeckEditor_Menu.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor_Menu.html#97">97</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor_Menu.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor_Menu.html#129">129</a></td></tr><tr class="b"><td colspan='2'><div><pre>                } else {
                    g.blackCheckBox.setSelected(true);
                    g.blackCheckBox.setEnabled(true);
                    g.blueCheckBox.setSelected(true);
                    g.blueCheckBox.setEnabled(true);
                    g.greenCheckBox.setSelected(true);
                    g.greenCheckBox.setEnabled(true);
                    g.redCheckBox.setSelected(true);
                    g.redCheckBox.setEnabled(true);
                    g.whiteCheckBox.setSelected(true);
                    g.whiteCheckBox.setEnabled(true);
                    g.colorlessCheckBox.setSelected(true);
                    g.colorlessCheckBox.setEnabled(true);
                    g.artifactCheckBox.setSelected(true);
                    g.artifactCheckBox.setEnabled(true);
                    g.creatureCheckBox.setSelected(true);
                    g.creatureCheckBox.setEnabled(true);
                    g.enchantmentCheckBox.setSelected(true);
                    g.enchantmentCheckBox.setEnabled(true);
                    g.instantCheckBox.setSelected(true);
                    g.instantCheckBox.setEnabled(true);
                    g.landCheckBox.setSelected(true);
                    g.landCheckBox.setEnabled(true);
                    g.planeswalkerCheckBox.setSelected(true);
                    g.planeswalkerCheckBox.setEnabled(true);
                    g.sorceryCheckBox.setSelected(true);
                    g.sorceryCheckBox.setEnabled(true);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GUI_Filter.java</td><td><a href="./xref/forge/GUI_Filter.html#643">643</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor_Menu.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor_Menu.html#130">130</a></td></tr><tr class="b"><td colspan='2'><div><pre>                    g.blackCheckBox.setSelected(true);
                    g.blackCheckBox.setEnabled(true);
                    g.blueCheckBox.setSelected(true);
                    g.blueCheckBox.setEnabled(true);
                    g.greenCheckBox.setSelected(true);
                    g.greenCheckBox.setEnabled(true);
                    g.redCheckBox.setSelected(true);
                    g.redCheckBox.setEnabled(true);
                    g.whiteCheckBox.setSelected(true);
                    g.whiteCheckBox.setEnabled(true);
                    g.colorlessCheckBox.setSelected(true);
                    g.colorlessCheckBox.setEnabled(true);
                    g.artifactCheckBox.setSelected(true);
                    g.artifactCheckBox.setEnabled(true);
                    g.creatureCheckBox.setSelected(true);
                    g.creatureCheckBox.setEnabled(true);
                    g.enchantmentCheckBox.setSelected(true);
                    g.enchantmentCheckBox.setEnabled(true);
                    g.instantCheckBox.setSelected(true);
                    g.instantCheckBox.setEnabled(true);
                    g.landCheckBox.setSelected(true);
                    g.landCheckBox.setEnabled(true);
                    g.planeswalkerCheckBox.setSelected(true);
                    g.planeswalkerCheckBox.setEnabled(true);
                    g.sorceryCheckBox.setSelected(true);
                    g.sorceryCheckBox.setEnabled(true);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DownloadPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadPictures_LQ.html#59">59</a></td></tr><tr class="a"><td>forge/Gui_DownloadSetPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadSetPictures_LQ.html#93">93</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private Gui_DownloadSetPictures_LQ(mCard[] c) {
        this.cards = c;
        addr = new JTextField(ForgeProps.getLocalized(PROXY_ADDRESS));
        port = new JTextField(ForgeProps.getLocalized(PROXY_PORT));
        bar = new JProgressBar(this);

        JPanel p0 = new JPanel();
        p0.setLayout(new BoxLayout(p0, BoxLayout.Y_AXIS));

        //Proxy Choice
        ButtonGroup bg = new ButtonGroup();
        String[] labels = {
                ForgeProps.getLocalized(NO_PROXY), ForgeProps.getLocalized(HTTP_PROXY),
                ForgeProps.getLocalized(SOCKS_PROXY)};
        for (int i = 0; i &lt; types.length; i++) {
            JRadioButton rb = new JRadioButton(labels[i]);
            rb.addChangeListener(new ProxyHandler(i));
            bg.add(rb);
            p0.add(rb);
            if (i == 0) rb.setSelected(true);
        }

        //Proxy config
        p0.add(addr);
        p0.add(port);
//        JTextField[] tfs = {addr, port};
//        String[] labels = {&quot;Address&quot;, &quot;Port&quot;};
//        for(int i = 0; i &lt; labels.length; i++) {
//            JPanel p1 = new JPanel(new BorderLayout());
//            p0.add(p1);
////            p1.add(new JLabel(labels[i]), WEST);
//            p1.add(tfs[i]);
//        }

        //Start
        final JButton b = new JButton(ForgeProps.getLocalized(BUTTONS.START));
        b.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent e) {
                new Thread(Gui_DownloadSetPictures_LQ.this).start();</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/ReadBoosterPack.java</td><td><a href="./xref/forge/ReadBoosterPack.html#194">194</a></td></tr><tr class="a"><td>forge/ReadDraftBoosterPack.java</td><td><a href="./xref/forge/ReadDraftBoosterPack.html#159">159</a></td></tr><tr class="b"><td colspan='2'><div><pre>        return list;
    }

    //return CardList of 5 or 6 cards, one for each color and maybe an artifact
    /**
     * &lt;p&gt;getVariety.&lt;/p&gt;
     *
     * @param in a {@link forge.CardList} object.
     * @return a {@link forge.CardList} object.
     */
    private CardList getVariety(CardList in) {
        CardList out = new CardList();

        String color[] = Constant.Color.Colors;
        Card check;
        in.shuffle();

        for (int i = 0; i &lt; color.length; i++) {
            check = findColor(in, color[i]);
            if (check != null) out.add(check);
        }

        return out;
    }//getVariety()

    /**
     * &lt;p&gt;findColor.&lt;/p&gt;
     *
     * @param in a {@link forge.CardList} object.
     * @param color a {@link java.lang.String} object.
     * @return a {@link forge.Card} object.
     */
    private Card findColor(CardList in, String color) {
        for (int i = 0; i &lt; in.size(); i++)
            if (CardUtil.getColors(in.get(i)).contains(color)) return in.get(i);

        return null;
    }


    /**
     * &lt;p&gt;getRandomCard.&lt;/p&gt;
     *
     * @param list a {@link forge.CardList} object.
     * @return a {@link forge.Card} object.
     */
    private Card getRandomCard(CardList list) {
        for (int i = 0; i &lt; 10; i++)
            list.shuffle();

        int index = MyRandom.random.nextInt(list.size());

        Card c = AllZone.getCardFactory().copyCard(list.get(index));
        c.setRarity(&quot;rare&quot;);
        return c;
    }//getRandomCard()

    /**
     * &lt;p&gt;setup.&lt;/p&gt;
     */
    private void setup() {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_PermanentState.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_PermanentState.html#387">387</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_PermanentState.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_PermanentState.html#755">755</a></td></tr><tr class="b"><td colspan='2'><div><pre>        tapList = tapList.getTargetableCards(source);

        if (tapList.size() == 0)
            return false;

        while (tgt.getNumTargeted() &lt; tgt.getMaxTargets(source, sa)) {
            Card choice = null;

            if (tapList.size() == 0) {
                if (tgt.getNumTargeted() &lt; tgt.getMinTargets(source, sa) || tgt.getNumTargeted() == 0) {
                    if (!mandatory)
                        tgt.resetTargets();
                    return false;
                } else {
                    // TODO is this good enough? for up to amounts?
                    break;
                }
            }

            if (tapList.getNotType(&quot;Creature&quot;).size() == 0)
                choice = CardFactoryUtil.AI_getBestCreature(tapList); //if only creatures take the best
            else
                choice = CardFactoryUtil.AI_getMostExpensivePermanent(tapList, af.getHostCard(), false);

            if (choice == null) {    // can't find anything left
                if (tgt.getNumTargeted() &lt; tgt.getMinTargets(sa.getSourceCard(), sa) || tgt.getNumTargeted() == 0) {
                    if (!mandatory)
                        tgt.resetTargets();
                    return false;
                } else {
                    // TODO is this good enough? for up to amounts?
                    break;
                }
            }

            tapList.remove(choice);
            tgt.addTarget(choice);
        }

        return true;
    }

    /**
     * &lt;p&gt;tapUnpreferredTargeting.&lt;/p&gt;
     *
     * @param af a {@link forge.card.abilityFactory.AbilityFactory} object.
     * @param sa a {@link forge.card.spellability.SpellAbility} object.
     * @param mandatory a boolean.
     * @return a boolean.
     */
    private static boolean tapUnpreferredTargeting(AbilityFactory af, SpellAbility sa, boolean mandatory) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DownloadSetPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadSetPictures_LQ.html#34">34</a></td></tr><tr class="a"><td>forge/Gui_MigrateLocalMWSSetPictures_HQ.java</td><td><a href="./xref/forge/Gui_MigrateLocalMWSSetPictures_HQ.html#36">36</a></td></tr><tr class="b"><td colspan='2'><div><pre>public class Gui_MigrateLocalMWSSetPictures_HQ extends DefaultBoundedRangeModel implements Runnable, NewConstants, NewConstants.LANG.Gui_DownloadPictures {

    /** Constant &lt;code&gt;serialVersionUID=-7890794857949935256L&lt;/code&gt; */
    private static final long serialVersionUID = -7890794857949935256L;

    /** Constant &lt;code&gt;types&lt;/code&gt; */
    public static final Proxy.Type[] types = Proxy.Type.values();

    //proxy
    private int type;
    private JTextField addr, port;

    //progress
    private mCard[] cards;
    private int card;
    private boolean cancel;
    private JProgressBar bar;

    private JOptionPane dlg;
    private JButton close;

    private long times[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    private int tptr = 0;
    private long lTime = System.currentTimeMillis();

    /**
     * &lt;p&gt;getAverageTimePerCard.&lt;/p&gt;
     *
     * @return a int.
     */
    private int getAverageTimePerCard() {
        int aTime = 0;
        int nz = 10;

        if (tptr &gt; 9)
            tptr = 0;

        times[tptr] = System.currentTimeMillis() - lTime;
        lTime = System.currentTimeMillis();

        int tTime = 0;
        for (int i = 0; i &lt; 10; i++) {
            tTime += times[i];
            if (times[i] == 0)
                nz--;
        }
        aTime = tTime / nz;

        tptr++;

        return aTime;
    }


    /**
     * &lt;p&gt;Constructor for Gui_MigrateLocalMWSSetPictures_HQ.&lt;/p&gt;
     *
     * @param c an array of {@link forge.Gui_MigrateLocalMWSSetPictures_HQ.mCard} objects.
     */
    private Gui_MigrateLocalMWSSetPictures_HQ(mCard[] c) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Debuff.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Debuff.html#370">370</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Pump.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Pump.html#523">523</a></td></tr><tr class="b"><td colspan='2'><div><pre>        while (tgt.getNumTargeted() &lt; tgt.getMaxTargets(source, sa)) {
            if (pref.isEmpty())
                break;

            Card c;
            if (pref.getNotType(&quot;Creature&quot;).size() == 0)
                c = CardFactoryUtil.AI_getBestCreature(pref);
            else
                c = CardFactoryUtil.AI_getMostExpensivePermanent(pref, source, true);

            pref.remove(c);

            tgt.addTarget(c);
        }

        while (tgt.getNumTargeted() &lt; tgt.getMinTargets(sa.getSourceCard(), sa)) {
            if (forced.isEmpty())
                break;

            Card c;
            if (forced.getNotType(&quot;Creature&quot;).size() == 0)
                c = CardFactoryUtil.AI_getWorstCreature(forced);
            else
                c = CardFactoryUtil.AI_getCheapestPermanent(forced, source, true);

            forced.remove(c);

            tgt.addTarget(c);
        }

        if (tgt.getNumTargeted() &lt; tgt.getMinTargets(sa.getSourceCard(), sa)) {
            tgt.resetTargets();
            return false;
        }

        return true;
    }//pumpMandatoryTarget()


    /**
     * &lt;p&gt;pumpTriggerAI.&lt;/p&gt;
     *
     * @param af a {@link forge.card.abilityFactory.AbilityFactory} object.
     * @param sa a {@link forge.card.spellability.SpellAbility} object.
     * @param mandatory a boolean.
     * @return a boolean.
     */
    private boolean pumpTriggerAI(AbilityFactory af, SpellAbility sa, boolean mandatory) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/trigger/Trigger.java</td><td><a href="./xref/forge/card/trigger/Trigger.html#331">331</a></td></tr><tr class="a"><td>forge/card/trigger/Trigger.java</td><td><a href="./xref/forge/card/trigger/Trigger.html#370">370</a></td></tr><tr class="b"><td colspan='2'><div><pre>                presentPlayer = mapParams.get(&quot;PresentPlayer2&quot;);
            }
            CardList list = new CardList();
            if (presentPlayer.equals(&quot;You&quot;) || presentPlayer.equals(&quot;Any&quot;)) {
                list.addAll(AllZoneUtil.getCardsInZone(presentZone, hostCard.getController()));
            }
            if (presentPlayer.equals(&quot;Opponent&quot;) || presentPlayer.equals(&quot;Any&quot;)) {
                list.addAll(AllZoneUtil.getCardsInZone(presentZone, hostCard.getController().getOpponent()));
            }

            list = list.getValidCards(sIsPresent.split(&quot;,&quot;), hostCard.getController(), hostCard);

            int right = 1;
            String rightString = presentCompare.substring(2);
            if (rightString.equals(&quot;X&quot;)) {
                right = CardFactoryUtil.xCount(hostCard, hostCard.getSVar(&quot;X&quot;));
            } else {
                right = Integer.parseInt(presentCompare.substring(2));
            }
            int left = list.size();

            if (!AllZoneUtil.compare(left, presentCompare, right)) {
                return false;
            }

        }

        if(mapParams.containsKey(&quot;CheckSVar&quot;)) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Destroy.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Destroy.html#584">584</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Sacrifice.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Sacrifice.html#564">564</a></td></tr><tr class="b"><td colspan='2'><div><pre>    public static boolean sacrificeAllCanPlayAI(final AbilityFactory af, final SpellAbility sa) {
        // AI needs to be expanded, since this function can be pretty complex based on what the expected targets could be
        Random r = MyRandom.random;
        Cost abCost = sa.getPayCosts();
        final Card source = sa.getSourceCard();
        final HashMap&lt;String, String&gt; params = af.getMapParams();
        String Valid = &quot;&quot;;

        if (params.containsKey(&quot;ValidCards&quot;))
            Valid = params.get(&quot;ValidCards&quot;);

        if (Valid.contains(&quot;X&quot;) &amp;&amp; source.getSVar(&quot;X&quot;).equals(&quot;Count$xPaid&quot;)) {
            // Set PayX here to maximum value.
            int xPay = ComputerUtil.determineLeftoverMana(sa);
            source.setSVar(&quot;PayX&quot;, Integer.toString(xPay));
            Valid = Valid.replace(&quot;X&quot;, Integer.toString(xPay));
        }

        CardList humanlist = AllZoneUtil.getPlayerCardsInPlay(AllZone.getHumanPlayer());
        CardList computerlist = AllZoneUtil.getPlayerCardsInPlay(AllZone.getComputerPlayer());

        humanlist = humanlist.getValidCards(Valid.split(&quot;,&quot;), source.getController(), source);
        computerlist = computerlist.getValidCards(Valid.split(&quot;,&quot;), source.getController(), source);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GameAction.java</td><td><a href="./xref/forge/GameAction.html#1670">1670</a></td></tr><tr class="a"><td>forge/GameAction.java</td><td><a href="./xref/forge/GameAction.html#1809">1809</a></td></tr><tr class="b"><td colspan='2'><div><pre>            for (int i = 0; i &lt; Cards_In_Play.size(); i++) {
                Card card = Cards_In_Play.get(i);
                ArrayList&lt;String&gt; a = card.getKeyword();
                int CostKeywords = 0;
                int CostKeyword_Number[] = new int[a.size()];
                for (int x = 0; x &lt; a.size(); x++)
                    if (a.get(x).toString().startsWith(&quot;CostChange&quot;)) {
                        CostKeyword_Number[CostKeywords] = x;
                        CostKeywords = CostKeywords + 1;
                    }
                for (int CKeywords = 0; CKeywords &lt; CostKeywords; CKeywords++) {
                    String parse = card.getKeyword().get(CostKeyword_Number[CKeywords]).toString();
                    String k[] = parse.split(&quot;:&quot;);
                    if (card.equals(originalCard)) {
                        if (!k[4].equals(&quot;Self&quot;)) k[2] = &quot;Owned&quot;;
                    }
                    if (k[2].equals(&quot;Less&quot;)) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_PermanentState.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_PermanentState.html#640">640</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_PermanentState.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_PermanentState.html#1564">1564</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private static boolean tapOrUntapCanPlayAI(final AbilityFactory af, SpellAbility sa) {
        // AI cannot use this properly until he can use SAs during Humans turn
        if (!ComputerUtil.canPayCost(sa))
            return false;

        HashMap&lt;String, String&gt; params = af.getMapParams();
        Target tgt = af.getAbTgt();
        Card source = sa.getSourceCard();

        Random r = MyRandom.random;
        boolean randomReturn = r.nextFloat() &lt;= Math.pow(.6667, source.getAbilityUsed());

        if (tgt == null) {
            //assume we are looking to tap human's stuff
            //TODO - check for things with untap abilities, and don't tap those.
            ArrayList&lt;Card&gt; defined = AbilityFactory.getDefinedCards(source, params.get(&quot;Defined&quot;), sa);

            boolean bFlag = false;
            for (Card c : defined)
                bFlag |= c.isUntapped();

            if (!bFlag)    // All of the defined stuff is tapped, not very useful
                return false;
        } else {
            tgt.resetTargets();
            if (!tapPrefTargeting(source, tgt, af, sa, false))
                return false;
        }

        Ability_Sub subAb = sa.getSubAbility();
        if (subAb != null)
            randomReturn &amp;= subAb.chkAI_Drawback();

        return randomReturn;
    }

    /**
     * &lt;p&gt;tapOrUntapTrigger.&lt;/p&gt;
     *
     * @param af a {@link forge.card.abilityFactory.AbilityFactory} object.
     * @param sa a {@link forge.card.spellability.SpellAbility} object.
     * @param mandatory a boolean.
     * @return a boolean.
     */
    private static boolean tapOrUntapTrigger(AbilityFactory af, SpellAbility sa, boolean mandatory) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/spellability/SpellAbility_Condition.java</td><td><a href="./xref/forge/card/spellability/SpellAbility_Condition.html#204">204</a></td></tr><tr class="a"><td>forge/card/spellability/SpellAbility_Restriction.java</td><td><a href="./xref/forge/card/spellability/SpellAbility_Restriction.html#190">190</a></td></tr><tr class="b"><td colspan='2'><div><pre>                right = CardFactoryUtil.xCount(c, c.getSVar(&quot;X&quot;));
            } else {
                right = Integer.parseInt(presentCompare.substring(2));
            }
            int left = list.size();

            if (!AllZoneUtil.compare(left, presentCompare, right))
                return false;
        }

        if (lifeTotal != null) {
            int life = 1;
            if (lifeTotal.equals(&quot;You&quot;)) {
                life = activator.getLife();
            }
            if (lifeTotal.equals(&quot;Opponent&quot;)) {
                life = activator.getOpponent().getLife();
            }

            int right = 1;
            String rightString = lifeAmount.substring(2);
            if (rightString.equals(&quot;X&quot;)) {
                right = CardFactoryUtil.xCount(sa.getSourceCard(), sa.getSourceCard().getSVar(&quot;X&quot;));
            } else {
                right = Integer.parseInt(lifeAmount.substring(2));
            }

            if (!AllZoneUtil.compare(life, lifeAmount, right)) {
                return false;
            }
        }

        if (pwAbility) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_AlterLife.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_AlterLife.html#149">149</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_AlterLife.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_AlterLife.html#467">467</a></td></tr><tr class="b"><td colspan='2'><div><pre>    static String loseLifeStackDescription(AbilityFactory af, SpellAbility sa) {
        HashMap&lt;String, String&gt; params = af.getMapParams();
        StringBuilder sb = new StringBuilder();
        int amount = AbilityFactory.calculateAmount(af.getHostCard(), params.get(&quot;LifeAmount&quot;), sa);

        if (!(sa instanceof Ability_Sub))
            sb.append(sa.getSourceCard().getName()).append(&quot; - &quot;);
        else
            sb.append(&quot; &quot;);

        String conditionDesc = params.get(&quot;ConditionDescription&quot;);
        if (conditionDesc != null)
            sb.append(conditionDesc).append(&quot; &quot;);

        ArrayList&lt;Player&gt; tgtPlayers;
        Target tgt = af.getAbTgt();
        if (tgt != null)
            tgtPlayers = tgt.getTargetPlayers();
        else
            tgtPlayers = AbilityFactory.getDefinedPlayers(sa.getSourceCard(), params.get(&quot;Defined&quot;), sa);

        for (Player player : tgtPlayers)
            sb.append(player).append(&quot; &quot;);

        sb.append(&quot;loses &quot;).append(amount).append(&quot; life.&quot;);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/deck/generate/Generate2ColorDeck.java</td><td><a href="./xref/forge/deck/generate/Generate2ColorDeck.html#345">345</a></td></tr><tr class="a"><td>forge/deck/generate/Generate3ColorDeck.java</td><td><a href="./xref/forge/deck/generate/Generate3ColorDeck.html#370">370</a></td></tr><tr class="b"><td colspan='2'><div><pre>                    throw new RuntimeException(&quot;Generate3ColorDeck : get3ColorDeck -- looped too much -- undersize&quot;);

                int n = CardCounts.get(c.getName());
                tDeck.add(AllZone.getCardFactory().getCard(c.getName(), AllZone.getComputerPlayer()));
                CardCounts.put(c.getName(), n + 1);
                tmpDeck += &quot;Added:&quot; + c.getName() + &quot;\n&quot;;
            }
        } else if (tDeck.size() &gt; Size) {
            int diff = tDeck.size() - Size;

            for (int i = 0; i &lt; diff; i++) {
                Card c = tDeck.get(r.nextInt(tDeck.size()));

                while (c.isBasicLand())    // don't remove basic lands
                    c = tDeck.get(r.nextInt(tDeck.size()));

                tDeck.remove(c);
                tmpDeck += &quot;Removed:&quot; + c.getName() + &quot;\n&quot;;
            }
        }

        tmpDeck += &quot;DeckSize:&quot; + tDeck.size() + &quot;\n&quot;;
        if (ForgeProps.getProperty(&quot;showdeck/3color&quot;, &quot;false&quot;).equals(&quot;true&quot;))</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Attach.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Attach.html#275">275</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Attach.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Attach.html#384">384</a></td></tr><tr class="b"><td colspan='2'><div><pre>		}
		
		int totToughness = 0;
		int totPower = 0;
		ArrayList&lt;String&gt; keywords = new ArrayList&lt;String&gt;();
		boolean grantingAbilities = false;
		
		for (StaticAbility stAbility : attachSource.getStaticAbilities()){
			Map&lt;String,String&gt; params = stAbility.getMapParams();
			
			if (!params.get(&quot;Mode&quot;).equals(&quot;Continuous&quot;))
				continue;
			
			String affected = params.get(&quot;Affected&quot;);
			
			if (affected == null)
				continue;
			if ((affected.contains(stCheck) || affected.contains(&quot;AttachedBy&quot;)) ){
				totToughness += CardFactoryUtil.parseSVar(attachSource, params.get(&quot;AddToughness&quot;));
				totPower += CardFactoryUtil.parseSVar(attachSource, params.get(&quot;AddPower&quot;));
				
				grantingAbilities |= params.containsKey(&quot;AddAbility&quot;);
				
				String kws = params.get(&quot;AddKeyword&quot;);
				if (kws != null){
					for(String kw : kws.split(&quot; &amp; &quot;))
						keywords.add(kw);
				}
			}
		}
		
		CardList prefList = null;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Creatures.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Creatures.html#682">682</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Sorceries.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Sorceries.html#70">70</a></td></tr><tr class="b"><td colspan='2'><div><pre>                @Override
                public void showMessage() {
                    if (index[0] == 0) AllZone.getDisplay().showMessage(&quot;Select target land you control.&quot;);
                    else AllZone.getDisplay().showMessage(&quot;Select target land opponent controls.&quot;);

                    ButtonUtil.enableOnlyCancel();
                }

                @Override
                public void selectButtonCancel() {
                    stop();
                }

                @Override
                public void selectCard(Card c, PlayerZone zone) {
                    //must target creature you control
                    if (index[0] == 0 &amp;&amp; !c.getController().equals(card.getController())) return;

                    //must target creature you don't control
                    if (index[0] == 1 &amp;&amp; c.getController().equals(card.getController())) return;


                    if (c.isLand() &amp;&amp; zone.is(Constant.Zone.Battlefield) &amp;&amp; CardFactoryUtil.canTarget(card, c)) {
                        target[index[0]] = c;
                        index[0]++;
                        showMessage();

                        if (index[0] == target.length) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#128">128</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#1365">1365</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private static String shuffleStackDescription(AbilityFactory af, SpellAbility sa) {
        HashMap&lt;String, String&gt; params = af.getMapParams();
        StringBuilder sb = new StringBuilder();

        if (!(sa instanceof Ability_Sub))
            sb.append(sa.getSourceCard().getName()).append(&quot; - &quot;);
        else
            sb.append(&quot; &quot;);

        String conditionDesc = params.get(&quot;ConditionDescription&quot;);
        if (conditionDesc != null)
            sb.append(conditionDesc).append(&quot; &quot;);

        ArrayList&lt;Player&gt; tgtPlayers;

        Target tgt = af.getAbTgt();
        if (tgt != null)
            tgtPlayers = tgt.getTargetPlayers();
        else
            tgtPlayers = AbilityFactory.getDefinedPlayers(sa.getSourceCard(), params.get(&quot;Defined&quot;), sa);

        if (tgtPlayers.size() &gt; 0) {
            Iterator&lt;Player&gt; it = tgtPlayers.iterator();
            while (it.hasNext()) {
                sb.append(it.next().getName());</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DownloadPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadPictures_LQ.html#59">59</a></td></tr><tr class="a"><td>forge/Gui_MigrateLocalMWSSetPictures_HQ.java</td><td><a href="./xref/forge/Gui_MigrateLocalMWSSetPictures_HQ.html#95">95</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private Gui_MigrateLocalMWSSetPictures_HQ(mCard[] c) {
        this.cards = c;
        addr = new JTextField(ForgeProps.getLocalized(PROXY_ADDRESS));
        port = new JTextField(ForgeProps.getLocalized(PROXY_PORT));
        bar = new JProgressBar(this);

        JPanel p0 = new JPanel();
        p0.setLayout(new BoxLayout(p0, BoxLayout.Y_AXIS));

        //Proxy Choice
        ButtonGroup bg = new ButtonGroup();
        String[] labels = {
                ForgeProps.getLocalized(NO_PROXY), ForgeProps.getLocalized(HTTP_PROXY),
                ForgeProps.getLocalized(SOCKS_PROXY)};
        for (int i = 0; i &lt; types.length; i++) {
            JRadioButton rb = new JRadioButton(labels[i]);
            rb.addChangeListener(new ProxyHandler(i));
            bg.add(rb);
            p0.add(rb);
            if (i == 0) rb.setSelected(true);
        }

        //Proxy config
        p0.add(addr);
        p0.add(port);
//        JTextField[] tfs = {addr, port};
//        String[] labels = {&quot;Address&quot;, &quot;Port&quot;};
//        for(int i = 0; i &lt; labels.length; i++) {
//            JPanel p1 = new JPanel(new BorderLayout());
//            p0.add(p1);
////            p1.add(new JLabel(labels[i]), WEST);
//            p1.add(tfs[i]);
//        }

        //Start
        final JButton b = new JButton(&quot;Start copying&quot;);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GameAction.java</td><td><a href="./xref/forge/GameAction.html#1050">1050</a></td></tr><tr class="a"><td>forge/GameAction.java</td><td><a href="./xref/forge/GameAction.html#1097">1097</a></td></tr><tr class="b"><td colspan='2'><div><pre>                card = c.getCard(cardName, AllZone.getComputerPlayer());
                card.setUniqueNumber(nextUniqueNumber++);

                //if(card.isBasicLand()) {
                //String PC = card.getSVar(&quot;PicCount&quot;);
                //int n = 0;
                //if (PC.matches(&quot;[0-9][0-9]?&quot;))
                //	n = Integer.parseInt(PC);
                //if (n &gt; 1)
                //    card.setRandomPicture(generator.nextInt(n));
                //System.out.println(&quot;computer random number:&quot; + card.getRandomPicture());
                //}

                if (!setCode.equals(&quot;&quot;))
                    card.setCurSetCode(setCode);
                else if ((card.getSets().size() &gt; 0)) // &amp;&amp; card.getCurSetCode().equals(&quot;&quot;))
                    card.setRandomSetCode();

                if (!card.getCurSetCode().equals(&quot;&quot;)) {
                    int n = SetInfoUtil.getSetInfo_Code(card.getSets(), card.getCurSetCode()).PicCount;
                    if (n &gt; 1)
                        card.setRandomPicture(generator.nextInt(n - 1) + 1);

                    card.setImageFilename(CardUtil.buildFilename(card));
                }

                // Assign random foiling on approximately 1:20 cards
                if (Constant.Runtime.RndCFoil[0] &amp;&amp; Constant.Runtime.GameType[0].equals(Constant.GameType.Constructed)) {
                	if (MyRandom.percentTrue(5))
                		card.setFoil(MyRandom.random.nextInt(9) + 1);
                }
                
                AllZone.getComputerLibrary().add(card);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Regenerate.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Regenerate.html#180">180</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Regenerate.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Regenerate.html#548">548</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private static boolean regenerateAllCanPlayAI(final AbilityFactory af, final SpellAbility sa) {
        final HashMap&lt;String, String&gt; params = af.getMapParams();
        final Card hostCard = af.getHostCard();
        boolean chance = false;
        Cost abCost = af.getAbCost();
        if (abCost != null) {
            // AI currently disabled for these costs
            if (abCost.getSacCost() &amp;&amp; !abCost.getSacThis()) {
                //only sacrifice something that's supposed to be sacrificed
                String type = abCost.getSacType();
                CardList typeList = AllZoneUtil.getPlayerCardsInPlay(AllZone.getComputerPlayer());
                typeList = typeList.getValidCards(type.split(&quot;,&quot;), hostCard.getController(), hostCard);
                if (ComputerUtil.getCardPreference(hostCard, &quot;SacCost&quot;, typeList) == null)
                    return false;
            }
            if (abCost.getLifeCost()) {
                if (AllZone.getComputerPlayer().getLife() - abCost.getLifeAmount() &lt; 4)
                    return false;
            }
        }

        if (!ComputerUtil.canPayCost(sa))
            return false;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DownloadSetPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadSetPictures_LQ.html#389">389</a></td></tr><tr class="a"><td>forge/Gui_MigrateLocalMWSSetPictures_HQ.java</td><td><a href="./xref/forge/Gui_MigrateLocalMWSSetPictures_HQ.html#394">394</a></td></tr><tr class="b"><td colspan='2'><div><pre>        String imgFN = &quot;&quot;;

        for (Card c : AllZone.getCardFactory()) {
            //String url = c.getSVar(&quot;Picture&quot;);
            //String[] URLs = url.split(&quot;\\\\&quot;);

            ArrayList&lt;SetInfo&gt; cSetInfo = c.getSets();
            if (cSetInfo.size() &gt; 0) {
                for (int j = 0; j &lt; cSetInfo.size(); j++) {
                    c.setCurSetCode(cSetInfo.get(j).Code);
                    String SC3 = c.getCurSetCode();
                    String SC2 = SetInfoUtil.getSetCode2_SetCode3(c.getCurSetCode());

                    int n = 0;
                    if (cSetInfo.get(j).PicCount &gt; 0) {
                        n = cSetInfo.get(j).PicCount;

                        for (int k = 1; k &lt;= n; k++) {
                            c.setRandomPicture(k);

                            imgFN = CardUtil.buildFilename(c);

                            if (imgFN.equals(&quot;none&quot;) || (!imgFN.contains(SC3) &amp;&amp; !imgFN.contains(SC2))) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Protection.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Protection.html#549">549</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Protection.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Protection.html#866">866</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private static void protectAllResolve(AbilityFactory af, SpellAbility sa) {
    	HashMap&lt;String,String&gt; params = af.getMapParams();
    	final Card host = af.getHostCard();
    	
    	boolean isChoice = params.get(&quot;Gains&quot;).contains(&quot;Choice&quot;);
    	ArrayList&lt;String&gt; choices = getProtectionList(host, params);
    	final ArrayList&lt;String&gt; gains = new ArrayList&lt;String&gt;();
        if(isChoice) {        	
        	if(sa.getActivatingPlayer().isHuman()) {
        		Object o = GuiUtils.getChoice(&quot;Choose a protection&quot;, choices.toArray());

                if(null == o) return;
                String choice = (String) o;
                gains.add(choice);
            }
        	else {
        		//TODO - needs improvement
        		String choice = choices.get(0);
                gains.add(choice);
                JOptionPane.showMessageDialog(null, &quot;Computer chooses &quot;+gains, &quot;&quot;+host, JOptionPane.PLAIN_MESSAGE); 
            }
        }
        else
        	gains.addAll(choices);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Instants.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Instants.html#1340">1340</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Sorceries.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Sorceries.html#1072">1072</a></td></tr><tr class="b"><td colspan='2'><div><pre>                        else if (userChoice.contains(cardChoice[2])) stopSetNext(targetLand);
                        else {
                            setStackDescription.execute();

                            stopSetNext(new Input_PayManaCost(spell));
                        }
                    }
                }//showMessage()

                ArrayList&lt;String&gt; chooseTwo(ArrayList&lt;String&gt; choices) {
                    ArrayList&lt;String&gt; out = new ArrayList&lt;String&gt;();
                    Object o = GuiUtils.getChoiceOptional(&quot;Choose Two&quot;, choices.toArray());
                    if (o == null) return null;

                    out.add((String) o);
                    card.addSpellChoice((String) o);
                    choices.remove(out.get(0));
                    o = GuiUtils.getChoiceOptional(&quot;Choose Two&quot;, choices.toArray());
                    if (o == null) return null;

                    out.add((String) o);
                    card.addSpellChoice((String) o);
                    return out;
                }//chooseTwo()
            };//Input chooseTwoInput

            
            
            card.addSpellAbility(spell);

            card.setSpellWithChoices(true);
            spell.setBeforePayMana(chooseTwoInput);
        }//*************** END ************ END **************************


        //*************** START *********** START **************************
        else if (cardName.equals(&quot;Parallel Evolution&quot;)) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/CombatUtil.java</td><td><a href="./xref/forge/CombatUtil.html#1359">1359</a></td></tr><tr class="a"><td>forge/CombatUtil.java</td><td><a href="./xref/forge/CombatUtil.html#1454">1454</a></td></tr><tr class="b"><td colspan='2'><div><pre>        int defenderDamage = defender.getNetAttack() + predictPowerBonusOfBlocker(attacker, defender);
        int attackerDamage = attacker.getNetAttack() + predictPowerBonusOfAttacker(attacker, defender, combat);
        if (AllZoneUtil.isCardInPlay(&quot;Doran, the Siege Tower&quot;)) {
            defenderDamage = defender.getNetDefense() + predictToughnessBonusOfBlocker(attacker, defender);
            attackerDamage = attacker.getNetDefense() + predictToughnessBonusOfAttacker(attacker, defender, combat);
        }

        int possibleDefenderPrevention = 0;
        int possibleAttackerPrevention = 0;
        if (!withoutAbilities) {
            possibleDefenderPrevention = ComputerUtil.possibleDamagePrevention(defender);
            possibleAttackerPrevention = ComputerUtil.possibleDamagePrevention(attacker);
        }

        // consider Damage Prevention/Replacement
        defenderDamage = attacker.predictDamage(defenderDamage, possibleAttackerPrevention, defender, true);
        attackerDamage = defender.predictDamage(attackerDamage, possibleDefenderPrevention, attacker, true);

        int defenderLife = defender.getKillDamage() + predictToughnessBonusOfBlocker(attacker, defender);
        int attackerLife = attacker.getKillDamage() + predictToughnessBonusOfAttacker(attacker, defender, combat);

        if (attacker.hasKeyword(&quot;Double Strike&quot;)) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/mana/ManaPool.java</td><td><a href="./xref/forge/card/mana/ManaPool.html#64">64</a></td></tr><tr class="a"><td>forge/card/mana/ManaPool.java</td><td><a href="./xref/forge/card/mana/ManaPool.html#108">108</a></td></tr><tr class="b"><td colspan='2'><div><pre>    public String getText() {
        Mana[] pool = floatingMana.toArray(new Mana[floatingMana.size()]);

        int[] normalMana = {0, 0, 0, 0, 0, 0};
        int[] snowMana = {0, 0, 0, 0, 0, 0};
        String[] manaStrings = {Constant.Color.White, Constant.Color.Blue, Constant.Color.Black, Constant.Color.Red, Constant.Color.Green, Constant.Color.Colorless};

        for (Mana m : pool) {
            if (m.isSnow())
                snowMana[map.get(m.getColor())] += m.getAmount();
            else
                normalMana[map.get(m.getColor())] += m.getAmount();
        }

        StringBuilder sbNormal = new StringBuilder();</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DownloadPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadPictures_LQ.html#110">110</a></td></tr><tr class="a"><td>forge/Gui_DownloadSetPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadSetPictures_LQ.html#144">144</a></td></tr><tr class="b"><td colspan='2'><div><pre>        bar.setString(card + &quot;/&quot; + cards.length);
        //bar.setString(String.format(ForgeProps.getLocalized(card == cards.length? BAR_CLOSE:BAR_WAIT), this.card, cards.length));
        Dimension d = bar.getPreferredSize();
        d.width = 300;
        bar.setPreferredSize(d);

        //JOptionPane
        Object[] options = {b, close = new JButton(ForgeProps.getLocalized(BUTTONS.CANCEL))};
        dlg = new JOptionPane(p0, DEFAULT_OPTION, PLAIN_MESSAGE, null, options, options[1]);
    }

    /** {@inheritDoc} */
    @Override
    public int getMinimum() {
        return 0;
    }

    /** {@inheritDoc} */
    @Override
    public int getValue() {
        return card;
    }

    /** {@inheritDoc} */
    @Override
    public int getExtent() {
        return 0;
    }

    /** {@inheritDoc} */
    @Override
    public int getMaximum() {
        return cards == null ? 0 : cards.length;
    }

    /**
     * &lt;p&gt;update.&lt;/p&gt;
     *
     * @param card a int.
     */
    private void update(int card) {
        this.card = card;

        final class Worker implements Runnable {
            private int card;

            Worker(int card) {
                this.card = card;
            }

            public void run() {
                fireStateChanged();</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Protection.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Protection.html#284">284</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Pump.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Pump.html#434">434</a></td></tr><tr class="b"><td colspan='2'><div><pre>            list = getPumpCreatures(defense, attack);

        list = list.getValidCards(tgt.getValidTgts(), sa.getActivatingPlayer(), sa.getSourceCard());

        if (AllZone.getStack().size() == 0) {
            // If the cost is tapping, don't activate before declare attack/block
            if (sa.getPayCosts() != null &amp;&amp; sa.getPayCosts().getTap()) {
                if (AllZone.getPhase().isBefore(Constant.Phase.Combat_Declare_Attackers) &amp;&amp; AllZone.getPhase().isPlayerTurn(AllZone.getComputerPlayer()))
                    list.remove(sa.getSourceCard());
                if (AllZone.getPhase().isBefore(Constant.Phase.Combat_Declare_Blockers) &amp;&amp; AllZone.getPhase().isPlayerTurn(AllZone.getHumanPlayer()))
                    list.remove(sa.getSourceCard());
            }
        }

        if (list.isEmpty())
            return mandatory &amp;&amp; pumpMandatoryTarget(AF, sa, mandatory);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_PreventDamage.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_PreventDamage.html#288">288</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Regenerate.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Regenerate.html#312">312</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private static boolean regenMandatoryTarget(AbilityFactory af, SpellAbility sa, boolean mandatory) {
        final Card hostCard = af.getHostCard();
        Target tgt = sa.getTarget();
        tgt.resetTargets();
        // filter AIs battlefield by what I can target
        CardList targetables = AllZoneUtil.getCardsInPlay();
        targetables = targetables.getValidCards(tgt.getValidTgts(), AllZone.getComputerPlayer(), hostCard);
        CardList compTargetables = targetables.getController(AllZone.getComputerPlayer());

        if (targetables.size() == 0)
            return false;

        if (!mandatory &amp;&amp; compTargetables.size() == 0)
            return false;

        if (compTargetables.size() &gt; 0) {
            CardList combatants = compTargetables.getType(&quot;Creature&quot;);
            CardListUtil.sortByEvaluateCreature(combatants);
            if (AllZone.getPhase().is(Constant.Phase.Combat_Declare_Blockers_InstantAbility)) {
                for (Card c : combatants) {
                    if (c.getShield() == 0 &amp;&amp; CombatUtil.combatantWouldBeDestroyed(c)) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/ComputerUtil.java</td><td><a href="./xref/forge/ComputerUtil.html#781">781</a></td></tr><tr class="a"><td>forge/ComputerUtil.java</td><td><a href="./xref/forge/ComputerUtil.html#821">821</a></td></tr><tr class="b"><td colspan='2'><div><pre>        for (int number = 1; number &lt; 6; number++)
            for (int i = 0; i &lt; manaSources.size(); i++) {
                Card card = manaSources.get(i);

                if (card.isCreature()) continue; //don't use creatures before other permanents

                int usableManaAbilities = 0;
                boolean needsLimitedResources = false;
                ArrayList&lt;Ability_Mana&gt; manaAbilities = card.getAIPlayableMana();

                for (Ability_Mana m : manaAbilities) {

                    Cost cost = m.getPayCosts();

                    //if the AI can't pay the additional costs skip the mana ability
                    if (cost != null) {
                        if (!canPayAdditionalCosts(m, player))
                            continue;
                        if (cost.getSubCounter() || cost.getLifeCost())
                            needsLimitedResources = true;
                    } else if (card.isTapped())
                        continue;

                    //don't use abilities with dangerous drawbacks
                    if (m.getSubAbility() != null) {
                        if (!m.getSubAbility().chkAI_Drawback())
                            continue;
                        needsLimitedResources = true; //TODO: check for good drawbacks (gainLife)
                    }
                    usableManaAbilities++;
                }

                if (usableManaAbilities == number &amp;&amp; !needsLimitedResources &amp;&amp; !sortedManaSources.contains(card))</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Debuff.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Debuff.html#142">142</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Protection.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Protection.html#488">488</a></td></tr><tr class="b"><td colspan='2'><div><pre>    	StringBuilder sb = new StringBuilder();

    	ArrayList&lt;Card&gt; tgtCards;
    	Target tgt = af.getAbTgt();
    	if(tgt != null)
    		tgtCards = tgt.getTargetCards();
    	else
    		tgtCards = AbilityFactory.getDefinedCards(sa.getSourceCard(), params.get(&quot;Defined&quot;), sa);

    	if(tgtCards.size() &gt; 0) {

    		if(sa instanceof Ability_Sub)
    			sb.append(&quot; &quot;);
    		else
    			sb.append(host).append(&quot; - &quot;);

    		Iterator&lt;Card&gt; it = tgtCards.iterator();
            while (it.hasNext()) {
                Card tgtC = it.next();
                if (tgtC.isFaceDown()) sb.append(&quot;Morph&quot;);
                else sb.append(tgtC);

                if (it.hasNext()) sb.append(&quot;, &quot;);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Card.java</td><td><a href="./xref/forge/Card.html#843">843</a></td></tr><tr class="a"><td>forge/Card.java</td><td><a href="./xref/forge/Card.html#909">909</a></td></tr><tr class="b"><td colspan='2'><div><pre>            AllZone.getTriggerHandler().runTrigger(&quot;CounterAdded&quot;, runParams);
        }
        
        if (counterName.equals(Counters.P1P1) || counterName.equals(Counters.M1M1)) {
            // +1/+1 counters should erase -1/-1 counters
            int plusOneCounters = 0;
            int minusOneCounters = 0;

            Counters p1Counter = Counters.P1P1;
            Counters m1Counter = Counters.M1M1;
            if (counters.containsKey(p1Counter))
                plusOneCounters = counters.get(p1Counter);
            if (counters.containsKey(m1Counter))
                minusOneCounters = counters.get(m1Counter);

            if (plusOneCounters == minusOneCounters) {
                counters.remove(m1Counter);
                counters.remove(p1Counter);
            }
            if (plusOneCounters &gt; minusOneCounters) {
                counters.remove(m1Counter);
                counters.put(p1Counter, (Integer) (plusOneCounters - minusOneCounters));
            } else {
                counters.put(m1Counter, (Integer) (minusOneCounters - plusOneCounters));
                counters.remove(p1Counter);
            }
        }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_BoosterDraft.java</td><td><a href="./xref/forge/Gui_BoosterDraft.html#148">148</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor.html#526">526</a></td></tr><tr class="b"><td colspan='2'><div><pre>        setBounds(bounds);


        //TODO use this as soon the deck editor has resizable GUI
//        //Use both so that when &quot;un&quot;maximizing, the frame isn't tiny
//        setSize(1024, 740);
//        setExtendedState(Frame.MAXIMIZED_BOTH);
    }//setupAndDisplay()

    /**
     * &lt;p&gt;getStats.&lt;/p&gt;
     *
     * @param deck a {@link forge.CardList} object.
     * @return a {@link java.lang.String} object.
     */
    private String getStats(CardList deck) {
        int total = deck.size();
        int creature = deck.getType(&quot;Creature&quot;).size();
        int land = deck.getType(&quot;Land&quot;).size();

        StringBuffer show = new StringBuffer();
        show.append(&quot;Total - &quot;).append(total).append(&quot;, Creatures - &quot;).append(creature).append(&quot;, Land - &quot;).append(land);
        String[] color = Constant.Color.Colors;
        for (int i = 0; i &lt; 5; i++)
            show.append(&quot;, &quot;).append(color[i]).append(&quot; - &quot;).append(CardListUtil.getColor(deck, color[i]).size());

        return show.toString();
    }//getStats()

    /**
     * &lt;p&gt;Constructor for Gui_Quest_DeckEditor.&lt;/p&gt;
     */
    public Gui_Quest_DeckEditor() {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Instants.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Instants.html#1348">1348</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Sorceries.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Sorceries.html#3202">3202</a></td></tr><tr class="b"><td colspan='2'><div><pre>                private ArrayList&lt;String&gt; chooseTwo(ArrayList&lt;String&gt; choices) {
                    ArrayList&lt;String&gt; out = new ArrayList&lt;String&gt;();
                    Object o = GuiUtils.getChoiceOptional(&quot;Choose Two&quot;, choices.toArray());
                    if (o == null) return null;

                    out.add((String) o);
                    card.addSpellChoice((String) o);
                    choices.remove(out.get(0));
                    o = GuiUtils.getChoiceOptional(&quot;Choose Two&quot;, choices.toArray());
                    if (o == null) return null;

                    out.add((String) o);
                    card.addSpellChoice((String) o);
                    return out;
                }//chooseTwo()
            };//Input chooseTwoInput

            
            
            card.addSpellAbility(spell);

            card.setSpellWithChoices(true);
            spell.setBeforePayMana(chooseTwoInput);
        }//*************** END ************ END **************************


        //*************** START *********** START **************************
        else if (cardName.equals(&quot;Turn to Slag&quot;)) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#186">186</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#1107">1107</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private static boolean discardCanPlayAI(final AbilityFactory af, SpellAbility sa) {
        HashMap&lt;String, String&gt; params = af.getMapParams();
        // AI cannot use this properly until he can use SAs during Humans turn
        if (!ComputerUtil.canPayCost(sa))
            return false;

        Target tgt = af.getAbTgt();
        Card source = sa.getSourceCard();
        Cost abCost = af.getAbCost();

        if (abCost != null) {
            // AI currently disabled for these costs
            if (abCost.getSacCost()) {
                return false;
            }
            if (abCost.getLifeCost()) {
                if (AllZone.getComputerPlayer().getLife() - abCost.getLifeAmount() &lt; 4)
                    return false;
            }
            if (abCost.getDiscardCost()) return false;

            if (abCost.getSubCounter()) {
                if (abCost.getCounterType().equals(Counters.P1P1)) return false; // Other counters should be used
            }

        }

        boolean humanHasHand = AllZoneUtil.getCardsInZone(Constant.Zone.Hand, AllZone.getHumanPlayer()).size() &gt; 0;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DownloadPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadPictures_LQ.html#233">233</a></td></tr><tr class="a"><td>forge/Gui_DownloadSetPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadSetPictures_LQ.html#310">310</a></td></tr><tr class="b"><td colspan='2'><div><pre>                    try {
                        in = new BufferedInputStream(new URL(url).openConnection(p).getInputStream());
                        out = new BufferedOutputStream(new FileOutputStream(f));

                        while ((len = in.read(buf)) != -1) {
                            //user cancelled
                            if (cancel) {
                                in.close();
                                out.flush();
                                out.close();

                                //delete what was written so far
                                f.delete();

                                return;
                            }//if - cancel

                            out.write(buf, 0, len);
                        }//while - read and write file

                        in.close();
                        out.flush();
                        out.close();
                    } catch (MalformedURLException mURLe) {
                        System.out.println(&quot;Error - possibly missing URL for: &quot; + cards[card].name);
                        //Log.error(&quot;LQ Pictures&quot;, &quot;Malformed URL for: &quot;+cards[card].name, mURLe);
                    }
                } catch (FileNotFoundException fnfe) {
                    System.out.println(&quot;Error - the LQ picture for &quot; + cards[card].name + &quot; could not be found on the server. [&quot; + cards[card].url + &quot;] - &quot; + fnfe.getMessage());</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DeckEditor.java</td><td><a href="./xref/forge/Gui_DeckEditor.html#694">694</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor.html#561">561</a></td></tr><tr class="b"><td colspan='2'><div><pre>            jbInit();
        } catch (Exception ex) {
            ErrorViewer.showError(ex);
        }
    }

    /**
     * &lt;p&gt;getCard.&lt;/p&gt;
     *
     * @return a {@link forge.Card} object.
     */
    public Card getCard() {
        return detail.getCard();
    }

    /** {@inheritDoc} */
    public void setCard(Card card) {
        detail.setCard(card);
        picture.setCard(card);
    }

    /**
     * &lt;p&gt;jbInit.&lt;/p&gt;
     *
     * @throws java.lang.Exception if any.
     */
    private void jbInit() throws Exception {

        border1 = new EtchedBorder(EtchedBorder.RAISED, Color.white, new Color(148, 145, 140));
        titledBorder1 = new TitledBorder(BorderFactory.createEtchedBorder(Color.white, new Color(148, 145, 140)),
                &quot;All Cards&quot;);
        border2 = BorderFactory.createEtchedBorder(Color.white, new Color(148, 145, 140));
        titledBorder2 = new TitledBorder(border2, &quot;Deck&quot;);
        this.getContentPane().setLayout(null);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/spellability/Cost.java</td><td><a href="./xref/forge/card/spellability/Cost.html#870">870</a></td></tr><tr class="a"><td>forge/card/spellability/Cost.java</td><td><a href="./xref/forge/card/spellability/Cost.html#1007">1007</a></td></tr><tr class="b"><td colspan='2'><div><pre>                cost.append(&quot;, Pay &quot;);
            cost.append(lifeAmount);
            cost.append(&quot; Life&quot;);

            first = false;
        }

        if (discardCost) {
            cost.append(discardString(first));
            first = false;
        }

        if (sacCost) {
            cost.append(sacString(first));
            first = false;
        }

        if (exileCost) {
            cost.append(exileString(first));
            first = false;
        }

        if (exileFromHandCost) {
            cost.append(exileFromHandString(first));
            first = false;
        }

        if (exileFromGraveCost) {
            cost.append(exileFromGraveString(first));
            first = false;
        }

        if (exileFromTopCost) {
            cost.append(exileFromTopString(first));
            first = false;
        }

        if (returnCost) {
            cost.append(returnString(first));
            first = false;
        }

        if (first)    // No costs, append 0</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Pump.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Pump.html#360">360</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Pump.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Pump.html#574">574</a></td></tr><tr class="b"><td colspan='2'><div><pre>        Card source = sa.getSourceCard();

        int defense;
        if (numDefense.contains(&quot;X&quot;) &amp;&amp; source.getSVar(&quot;X&quot;).equals(&quot;Count$xPaid&quot;)) {
            // Set PayX here to maximum value.
            int xPay = ComputerUtil.determineLeftoverMana(sa);
            source.setSVar(&quot;PayX&quot;, Integer.toString(xPay));
            defense = xPay;
        } else
            defense = getNumDefense(sa);

        int attack;
        if (numAttack.contains(&quot;X&quot;) &amp;&amp; source.getSVar(&quot;X&quot;).equals(&quot;Count$xPaid&quot;)) {
            // Set PayX here to maximum value.
            String toPay = source.getSVar(&quot;PayX&quot;);

            if (toPay.equals(&quot;&quot;)) {
                int xPay = ComputerUtil.determineLeftoverMana(sa);
                source.setSVar(&quot;PayX&quot;, Integer.toString(xPay));
                attack = xPay;
            } else
                attack = Integer.parseInt(toPay);
        } else
            attack = getNumAttack(sa);

        if (sa.getTarget() == null) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Instants.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Instants.html#202">202</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Sorceries.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Sorceries.html#448">448</a></td></tr><tr class="b"><td colspan='2'><div><pre>                    CardList Pile1 = new CardList();
                    CardList Pile2 = new CardList();
                    boolean stop = false;
                    int Pile1CMC = 0;
                    int Pile2CMC = 0;


                    GuiUtils.getChoice(&quot;Revealing top &quot; + Count + &quot; cards of library: &quot;, cards.toArray());
                    //Human chooses
                    if (card.getController().isComputer()) {
                        for (int i = 0; i &lt; Count; i++) {
                            if (stop == false) {
                                choice = GuiUtils.getChoiceOptional(&quot;Choose cards to put into the first pile: &quot;, cards.toArray());
                                if (choice != null) {
                                    Pile1.add(choice);
                                    cards.remove(choice);
                                    Pile1CMC = Pile1CMC + CardUtil.getConvertedManaCost(choice);
                                } else stop = true;
                            }
                        }
                        for (int i = 0; i &lt; Count; i++) {
                            if (!Pile1.contains(exiled.get(i))) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Counters.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Counters.html#224">224</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Counters.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Counters.html#748">748</a></td></tr><tr class="b"><td colspan='2'><div><pre>            if (abCost.getSacCost() &amp;&amp; !abCost.getSacThis()) {
                //only sacrifice something that's supposed to be sacrificed
                String sacType = abCost.getSacType();
                CardList typeList = AllZoneUtil.getPlayerCardsInPlay(AllZone.getComputerPlayer());
                typeList = typeList.getValidCards(sacType.split(&quot;,&quot;), source.getController(), source);
                if (ComputerUtil.getCardPreference(source, &quot;SacCost&quot;, typeList) == null)
                    return false;
            }
            if (abCost.getLifeCost()) return false;
            if (abCost.getDiscardCost()) return false;

            if (abCost.getSubCounter()) {
                // A card has a 25% chance per counter to be able to pass through here
                // 4+ counters will always pass. 0 counters will never
                int currentNum = source.getCounters(abCost.getCounterType());
                double percent = .25 * (currentNum / abCost.getCounterNum());
                if (percent &lt;= r.nextFloat())
                    return false;
            }
        }

        if (!ComputerUtil.canPayCost(sa))
            return false;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DeckEditor.java</td><td><a href="./xref/forge/Gui_DeckEditor.html#241">241</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor.html#186">186</a></td></tr><tr class="b"><td colspan='2'><div><pre>        bottomModel.resort();
    }//updateDisplay

    /**
     * &lt;p&gt;updateDisplay.&lt;/p&gt;
     */
    public void updateDisplay() {
        //updateDisplay(this.top, this.bottom);

        topModel.clear();

        top = AllZone.getNameChanger().changeCardsIfNeeded(top);
        bottom = AllZone.getNameChanger().changeCardsIfNeeded(bottom);

        Card c;
        String cardName;
        ReadBoosterPack pack = new ReadBoosterPack();

        // update top
        for (int i = 0; i &lt; top.size(); i++) {
            c = top.get(i);

            // add rarity to card if this is a sealed card pool

            cardName = AllZone.getNameChanger().getOriginalName(c.getName());
            if (!pack.getRarity(cardName).equals(&quot;error&quot;)) {
                c.setRarity(pack.getRarity(cardName));
            }

            boolean filteredOut = filterByColor(c);

            if (!filteredOut) {
                filteredOut = filterByType(c);
            }

            if (!filteredOut) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_CardShop.java</td><td><a href="./xref/forge/Gui_CardShop.html#135">135</a></td></tr><tr class="a"><td>forge/Gui_DeckEditor.java</td><td><a href="./xref/forge/Gui_DeckEditor.html#206">206</a></td></tr><tr class="b"><td colspan='2'><div><pre>            c = bottom.get(i);

            // add rarity to card if this is a sealed card pool
            if (!customMenu.getGameType().equals(Constant.GameType.Constructed))
                c.setRarity(pack.getRarity(c.getName()));

            //String PC = c.getSVar(&quot;PicCount&quot;);
            Random r = MyRandom.random;
            //int n = 0;
            //if (!PC.equals(&quot;&quot;)) {
            //    if (PC.matches(&quot;[0-9][0-9]?&quot;))
            //    	n = Integer.parseInt(PC);
            //    if (n &gt; 1)
            //        c.setRandomPicture(r.nextInt(n));
            //}

            if (c.getCurSetCode().equals(&quot;&quot;))
                c.setCurSetCode(c.getMostRecentSet());

            if (!c.getCurSetCode().equals(&quot;&quot;)) {
                int n = SetInfoUtil.getSetInfo_Code(c.getSets(), c.getCurSetCode()).PicCount;
                if (n &gt; 1)
                    c.setRandomPicture(r.nextInt(n - 1) + 1);

                c.setImageFilename(CardUtil.buildFilename(c));
            }

            bottomModel.addCard(c);
        }// for</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Animate.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Animate.html#127">127</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Animate.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Animate.html#337">337</a></td></tr><tr class="b"><td colspan='2'><div><pre>        Card source = sa.getSourceCard();
        Card host = af.getHostCard();
        Map&lt;String, String&gt; svars = host.getSVars();

        //AF specific params
        int power = -1;
        if (params.containsKey(&quot;Power&quot;)) power = AbilityFactory.calculateAmount(host, params.get(&quot;Power&quot;), sa);
        int toughness = -1;
        if (params.containsKey(&quot;Toughness&quot;))
            toughness = AbilityFactory.calculateAmount(host, params.get(&quot;Toughness&quot;), sa);

        boolean permanent = params.containsKey(&quot;Permanent&quot;) ? true : false;

        final ArrayList&lt;String&gt; types = new ArrayList&lt;String&gt;();
        if (params.containsKey(&quot;Types&quot;)) types.addAll(Arrays.asList(params.get(&quot;Types&quot;).split(&quot;,&quot;)));</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/CardShopTableModel.java</td><td><a href="./xref/forge/CardShopTableModel.html#217">217</a></td></tr><tr class="a"><td>forge/TableModel.java</td><td><a href="./xref/forge/TableModel.html#232">232</a></td></tr><tr class="b"><td colspan='2'><div><pre>        return count;
    }

    /**
     * &lt;p&gt;getRowCount.&lt;/p&gt;
     *
     * @return a int.
     */
    public int getRowCount() {
        return dataNoCopies.size();
    }

    /**
     * &lt;p&gt;getColumnCount.&lt;/p&gt;
     *
     * @return a int.
     */
    public int getColumnCount() {
        return column.length;
    }

    /** {@inheritDoc} */
    @Override
    public String getColumnName(int n) {
        return column[n];
    }

    /** {@inheritDoc} */
    public Object getValueAt(int row, int column) {
        return getColumn(dataNoCopies.get(row), column);
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;column&lt;/code&gt;.&lt;/p&gt;
     *
     * @param c a {@link forge.Card} object.
     * @param column a int.
     * @param column a int.
     * @return a {@link java.lang.Object} object.
     */
    private Object getColumn(Card c, int column) {
        switch (column) {
            case 0:
                return Integer.valueOf(countQuantity(c));
            case 1:
                return c.getName();
            case 2:
                return c.getManaCost();
            case 3:
                return TableSorter.getColor(c);
            case 4:
                return GuiDisplayUtil.formatCardType(c);
            case 5:</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Instants.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Instants.html#225">225</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Sorceries.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Sorceries.html#471">471</a></td></tr><tr class="b"><td colspan='2'><div><pre>                                Pile2CMC = Pile2CMC + CardUtil.getConvertedManaCost(exiled.get(i));
                            }
                        }
                        StringBuilder sb = new StringBuilder();
                        sb.append(&quot;You have spilt the cards into the following piles&quot; + &quot;\r\n&quot; + &quot;\r\n&quot;);
                        sb.append(&quot;Pile 1: &quot; + &quot;\r\n&quot;);
                        for (int i = 0; i &lt; Pile1.size(); i++) sb.append(Pile1.get(i).getName() + &quot;\r\n&quot;);
                        sb.append(&quot;\r\n&quot; + &quot;Pile 2: &quot; + &quot;\r\n&quot;);
                        for (int i = 0; i &lt; Pile2.size(); i++) sb.append(Pile2.get(i).getName() + &quot;\r\n&quot;);
                        JOptionPane.showMessageDialog(null, sb, &quot;&quot;, JOptionPane.INFORMATION_MESSAGE);
                        if (Pile1CMC &gt;= Pile2CMC) {
                            JOptionPane.showMessageDialog(null, &quot;Computer chooses the Pile 1&quot;, &quot;&quot;, JOptionPane.INFORMATION_MESSAGE);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Counters.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Counters.html#1448">1448</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Counters.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Counters.html#1635">1635</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private static void removeCounterAllResolve(final AbilityFactory af, final SpellAbility sa) {
        HashMap&lt;String, String&gt; params = af.getMapParams();

        String type = params.get(&quot;CounterType&quot;);
        int counterAmount = AbilityFactory.calculateAmount(af.getHostCard(), params.get(&quot;CounterNum&quot;), sa);
        String valid = params.get(&quot;ValidCards&quot;);

        CardList cards = AllZoneUtil.getCardsInPlay();
        cards = cards.getValidCards(valid, sa.getSourceCard().getController(), sa.getSourceCard());

        Target tgt = sa.getTarget();
        if (tgt != null) {
            Player pl = sa.getTargetPlayer();
            cards = cards.getController(pl);
        }

        for (Card tgtCard : cards) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_CounterMagic.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_CounterMagic.html#203">203</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_CounterMagic.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_CounterMagic.html#267">267</a></td></tr><tr class="b"><td colspan='2'><div><pre>            if (unlessCost != null) {
                // Is this Usable Mana Sources? Or Total Available Mana?
                int usableManaSources = CardFactoryUtil.getUsableManaSources(AllZone.getHumanPlayer());
                int toPay = 0;
                boolean setPayX = false;
                if (unlessCost.equals(&quot;X&quot;) &amp;&amp; source.getSVar(unlessCost).equals(&quot;Count$xPaid&quot;)) {
                    setPayX = true;
                    toPay = ComputerUtil.determineLeftoverMana(sa);
                } else
                    toPay = AbilityFactory.calculateAmount(source, unlessCost, sa);

                if (toPay == 0)
                    return false;

                if (toPay &lt;= usableManaSources) {
                    // If this is a reusable Resource, feel free to play it most of the time
                    if (!sa.getPayCosts().isReusuableResource() || MyRandom.random.nextFloat() &lt; .4)
                        return false;
                }

                if (setPayX)
                    source.setSVar(&quot;PayX&quot;, Integer.toString(toPay));
            }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_ChangeZone.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ChangeZone.html#284">284</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_ChangeZone.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ChangeZone.html#925">925</a></td></tr><tr class="b"><td colspan='2'><div><pre>        if (abCost != null) {
            // AI currently disabled for these costs
            if (abCost.getSacCost() &amp;&amp; !abCost.getSacThis()) {
                //only sacrifice something that's supposed to be sacrificed
                String type = abCost.getSacType();
                CardList typeList = AllZoneUtil.getPlayerCardsInPlay(AllZone.getComputerPlayer());
                typeList = typeList.getValidCards(type.split(&quot;,&quot;), source.getController(), source);
                if (ComputerUtil.getCardPreference(source, &quot;SacCost&quot;, typeList) == null)
                    return false;
            }
            if (abCost.getLifeCost()) {
                if (AllZone.getComputerPlayer().getLife() - abCost.getLifeAmount() &lt; 4)
                    return false;
            }
            if (abCost.getDiscardCost()) return false;

            if (abCost.getSubCounter()) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/deck/generate/GenerateConstructedMultiColorDeck.java</td><td><a href="./xref/forge/deck/generate/GenerateConstructedMultiColorDeck.html#298">298</a></td></tr><tr class="a"><td>forge/deck/generate/GenerateConstructedMultiColorDeck.java</td><td><a href="./xref/forge/deck/generate/GenerateConstructedMultiColorDeck.html#350">350</a></td></tr><tr class="b"><td colspan='2'><div><pre>        out.addAll(CardListUtil.getGoldCards(in));
        out.shuffle();

        CardList artifact = in.filter(new CardListFilter() {
            public boolean addCard(Card c) {
                //is this really a colorless artifact and not something
                //wierd like Sarcomite Myr which is a colored artifact
                return c.isArtifact() &amp;&amp;
                        CardUtil.getColors(c).contains(Constant.Color.Colorless) &amp;&amp;
                        !Gui_NewGame.removeArtifacts.isSelected();
            }
        });
        out.addAll(artifact);

        out = out.filter(new CardListFilter() {
            public boolean addCard(Card c) {
                if (c.isCreature() &amp;&amp;
                        c.getNetAttack() &lt;= 1 &amp;&amp;
                        Gui_NewGame.removeSmallCreatures.isSelected()) {
                    return false;
                }

                return true;
            }
        });

        out = filterBadCards(out, 3);
        return out;
    }


    /**
     * Filters out cards by color and their suitability for being placed in
     * a randomly created deck.
     *
     * @param sequence  an Iterable of Card instances
     * 
     * @param colors  the number of different colors the deck should have;
     * if this is a number other than 3 or 5, we return an empty list.
     * 
     * @return a subset of sequence &lt;= sequence which might be empty, but
     * never null
     */
    private CardList filterBadCards(Iterable&lt;Card&gt; sequence, int colors) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/deck/generate/Generate2ColorDeck.java</td><td><a href="./xref/forge/deck/generate/Generate2ColorDeck.html#239">239</a></td></tr><tr class="a"><td>forge/deck/generate/Generate3ColorDeck.java</td><td><a href="./xref/forge/deck/generate/Generate3ColorDeck.html#264">264</a></td></tr><tr class="b"><td colspan='2'><div><pre>                throw new RuntimeException(&quot;Generate3ColorDeck : get3ColorDeck -- looped too much -- Sp123&quot;);

            tDeck.add(AllZone.getCardFactory().getCard(c.getName(), AllZone.getComputerPlayer()));
            int n = CardCounts.get(c.getName());
            CardCounts.put(c.getName(), n + 1);
            tmpDeck += c.getName() + &quot; &quot; + c.getManaCost() + &quot;\n&quot;;
        }

        // Add lands
        int numLands = 0;
        if (LandsPercentage &gt; 0) {
            p = (float) ((float) LandsPercentage * .01);
            numLands = (int) (p * (float) Size);
        } else     // otherwise, just fill in the rest of the deck with basic lands
            numLands = Size - tDeck.size();

        tmpDeck += &quot;numLands:&quot; + numLands + &quot;\n&quot;;

        int nDLands = (numLands / 4);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_CardShop.java</td><td><a href="./xref/forge/Gui_CardShop.html#295">295</a></td></tr><tr class="a"><td>forge/Gui_CardShop.java</td><td><a href="./xref/forge/Gui_CardShop.html#319">319</a></td></tr><tr class="b"><td colspan='2'><div><pre>            Card c = AllZone.getCardFactory().getCard(aList, null);

            c.setRarity(pack.getRarity(c.getName()));
            if (map.containsKey(c.getName())) {
                c.setValue(map.get(c.getName()));
            } else //card is not on pricelist
            {
                System.out.println(&quot;Card &quot; + c.getName() + &quot; is not in the price list.&quot;);
                if (c.getRarity().equals(&quot;Common&quot;)) {
                    c.setValue(10);
                } else if (c.getRarity().equals(&quot;Uncommon&quot;)) {
                    c.setValue(50);
                } else if (c.getRarity().equals(&quot;Rare&quot;)) {
                    c.setValue(200);
                }
            }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GameAction.java</td><td><a href="./xref/forge/GameAction.html#768">768</a></td></tr><tr class="a"><td>forge/GameAction.java</td><td><a href="./xref/forge/GameAction.html#912">912</a></td></tr><tr class="b"><td colspan='2'><div><pre>        if (c.isEnchanted()) {
            CardList list = new CardList(c.getEnchantedBy().toArray());
            list = list.filter(new CardListFilter() {
                public boolean addCard(Card crd) {
                    return crd.hasKeyword(&quot;Totem armor&quot;);
                }
            });
            CardListUtil.sortCMC(list);


            if (list.size() != 0) {
                final Card crd;
                if (list.size() == 1) {
                    crd = list.get(0);
                } else {
                    if (c.getController().isHuman())
                        crd = GuiUtils.getChoiceOptional(&quot;Select totem armor to destroy&quot;, list.toArray());
                    else
                        crd = list.get(0);
                }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GameActionUtil.java</td><td><a href="./xref/forge/GameActionUtil.html#2421">2421</a></td></tr><tr class="a"><td>forge/GameActionUtil.java</td><td><a href="./xref/forge/GameActionUtil.html#3175">3175</a></td></tr><tr class="b"><td colspan='2'><div><pre>        CardList kinship = AllZoneUtil.getPlayerCardsInPlay(player, &quot;Waterspout Weavers&quot;);

        PlayerZone library = AllZone.getZone(Constant.Zone.Library, player);
        // Players would not choose to trigger Kinship ability if library is empty.
        // Useful for games when the &quot;Milling = Loss Condition&quot; check box is unchecked.

        if (kinship.size() == 0 || library.size() &lt;= 0)
            return;

        final String[] shareTypes = {&quot;Merfolk&quot;, &quot;Wizard&quot;};
        final Card[] prevCardShown = {null};
        final Card peek[] = {null};

        for (final Card k : kinship) {
            Ability ability = new Ability(k, &quot;0&quot;) {    // change to triggered abilities when ready
                @Override
                public void resolve() {
                    PlayerZone library = AllZone.getZone(Constant.Zone.Library, player);
                    if (library.size() &lt;= 0)
                        return;

                    peek[0] = library.get(0);
                    boolean wantMerfolkBuff = false;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Instants.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Instants.html#263">263</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Sorceries.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Sorceries.html#522">522</a></td></tr><tr class="b"><td colspan='2'><div><pre>                        for (int i = 0; i &lt; Count; i++) if (!Pile1.contains(exiled.get(i))) Pile2.add(exiled.get(i));
                        StringBuilder sb = new StringBuilder();
                        sb.append(&quot;Choose a pile to add to your hand: &quot; + &quot;\r\n&quot; + &quot;\r\n&quot;);
                        sb.append(&quot;Pile 1: &quot; + &quot;\r\n&quot;);
                        for (int i = 0; i &lt; Pile1.size(); i++) sb.append(Pile1.get(i).getName() + &quot;\r\n&quot;);
                        sb.append(&quot;\r\n&quot; + &quot;Pile 2: &quot; + &quot;\r\n&quot;);
                        for (int i = 0; i &lt; Pile2.size(); i++) sb.append(Pile2.get(i).getName() + &quot;\r\n&quot;);
                        Object[] possibleValues = {&quot;Pile 1&quot;, &quot;Pile 2&quot;};
                        Object q = JOptionPane.showOptionDialog(null, sb, &quot;Brilliant Ultimatum&quot;,</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/spellability/Cost_Payment.java</td><td><a href="./xref/forge/card/spellability/Cost_Payment.html#1484">1484</a></td></tr><tr class="a"><td>forge/card/spellability/Cost_Payment.java</td><td><a href="./xref/forge/card/spellability/Cost_Payment.html#1554">1554</a></td></tr><tr class="b"><td colspan='2'><div><pre>                typeList = typeList.getValidCards(type.split(&quot;;&quot;), spell.getActivatingPlayer(), spell.getSourceCard());
                AllZone.getDisplay().showMessage(msg.toString());
                ButtonUtil.enableOnlyCancel();
            }

            @Override
            public void selectButtonCancel() {
                cancel();
            }

            @Override
            public void selectCard(Card card, PlayerZone zone) {
                if (typeList.contains(card)) {
                    nExiles++;
                    payment.getAbility().addCostToHashList(card, &quot;Exiled&quot;);
                    AllZone.getGameAction().exile(card);
                    typeList.remove(card);
                    //in case nothing else to exile
                    if (nExiles == nNeeded)
                        done();
                    else if (typeList.size() == 0)    // this really shouldn't happen
                        cancel();
                    else
                        showMessage();
                }
            }

            public void done() {
                payment.setPayExileFromHand(true);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/spellability/Cost_Payment.java</td><td><a href="./xref/forge/card/spellability/Cost_Payment.html#1167">1167</a></td></tr><tr class="a"><td>forge/card/spellability/Cost_Payment.java</td><td><a href="./xref/forge/card/spellability/Cost_Payment.html#1477">1477</a></td></tr><tr class="b"><td colspan='2'><div><pre>                msg.append(nLeft).append(&quot; &quot;);
                msg.append(type);
                if (nLeft &gt; 1) {
                    msg.append(&quot;s&quot;);
                }

                typeList = AllZoneUtil.getPlayerCardsInPlay(sa.getSourceCard().getController());
                typeList = typeList.getValidCards(type.split(&quot;;&quot;), sa.getActivatingPlayer(), sa.getSourceCard());
                AllZone.getDisplay().showMessage(msg.toString());
                ButtonUtil.enableOnlyCancel();
            }

            @Override
            public void selectButtonCancel() {
                cancel();
            }

            @Override
            public void selectCard(Card card, PlayerZone zone) {
                if (typeList.contains(card)) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_AlterLife.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_AlterLife.html#322">322</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_AlterLife.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_AlterLife.html#1228">1228</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private static void setLifeResolve(final AbilityFactory af, final SpellAbility sa) {
        HashMap&lt;String, String&gt; params = af.getMapParams();

        int lifeAmount = AbilityFactory.calculateAmount(af.getHostCard(), params.get(&quot;LifeAmount&quot;), sa);
        ArrayList&lt;Player&gt; tgtPlayers;

        Target tgt = af.getAbTgt();
        if (tgt != null &amp;&amp; !params.containsKey(&quot;Defined&quot;))
            tgtPlayers = tgt.getTargetPlayers();
        else
            tgtPlayers = AbilityFactory.getDefinedPlayers(sa.getSourceCard(), params.get(&quot;Defined&quot;), sa);

        for (Player p : tgtPlayers)
            if (tgt == null || p.canTarget(af.getHostCard()))
                p.setLife(lifeAmount, sa.getSourceCard());</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GuiDisplay4.java</td><td><a href="./xref/forge/GuiDisplay4.html#674">674</a></td></tr><tr class="a"><td>forge/GuiDisplayUtil.java</td><td><a href="./xref/forge/GuiDisplayUtil.html#1007">1007</a></td></tr><tr class="b"><td colspan='2'><div><pre>        List&lt;Card&gt; tmp, diff;
        tmp = new ArrayList&lt;Card&gt;();
        for (arcane.ui.CardPanel cpa : p.cardPanels)
            tmp.add(cpa.gameCard);
        diff = new ArrayList&lt;Card&gt;(tmp);
        diff.removeAll(Arrays.asList(c));
        if (diff.size() == p.cardPanels.size())
            p.clear();
        else {
            for (Card card : diff) {
                p.removeCardPanel(p.getCardPanel(card.getUniqueNumber()));
            }
        }
        diff = new ArrayList&lt;Card&gt;(Arrays.asList(c));
        diff.removeAll(tmp);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Creatures.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Creatures.html#653">653</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Sorceries.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Sorceries.html#40">40</a></td></tr><tr class="b"><td colspan='2'><div><pre>            final SpellAbility spell = new Spell(card) {

                private static final long serialVersionUID = -3075569295823682336L;

                @Override
                public boolean canPlayAI() {
                    return false;
                }

                @Override
                public void resolve() {

                    Card crd0 = target[0];
                    Card crd1 = target[1];

                    if (crd0 != null &amp;&amp; crd1 != null) {
                        Player p0 = crd0.getController();
                        Player p1 = crd1.getController();
                        AllZone.getGameAction().changeController(new CardList(crd0), p0, p1);
                        AllZone.getGameAction().changeController(new CardList(crd1), p1, p0);
                    }

                }//resolve()
            };//SpellAbility


            final Input input = new Input() {

                private static final long serialVersionUID = -1017253686774265770L;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Debuff.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Debuff.html#598">598</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Pump.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Pump.html#880">880</a></td></tr><tr class="b"><td colspan='2'><div><pre>        final int defense = getNumDefense(sa);

        boolean chance = r.nextFloat() &lt;= Math.pow(.6667, source.getAbilityUsed()); //to prevent runaway activations

        if (params.containsKey(&quot;ValidCards&quot;)) {
            valid = params.get(&quot;ValidCards&quot;);
        }

        CardList comp = AllZoneUtil.getPlayerCardsInPlay(AllZone.getComputerPlayer());
        comp = comp.getValidCards(valid, hostCard.getController(), hostCard);
        CardList human = AllZoneUtil.getPlayerCardsInPlay(AllZone.getHumanPlayer());
        human = human.getValidCards(valid, hostCard.getController(), hostCard);

        //only count creatures that can attack
        human = human.filter(new CardListFilter() {
            public boolean addCard(Card c) {
                return CombatUtil.canAttack(c) &amp;&amp; !AF.isCurse();</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/deck/generate/GenerateConstructedDeck.java</td><td><a href="./xref/forge/deck/generate/GenerateConstructedDeck.html#132">132</a></td></tr><tr class="a"><td>forge/deck/generate/GenerateConstructedMultiColorDeck.java</td><td><a href="./xref/forge/deck/generate/GenerateConstructedMultiColorDeck.html#298">298</a></td></tr><tr class="b"><td colspan='2'><div><pre>        out.addAll(CardListUtil.getColor(in, color3));
        out.shuffle();

        CardList artifact = in.filter(new CardListFilter() {
            public boolean addCard(Card c) {
                //is this really a colorless artifact and not something
                //wierd like Sarcomite Myr which is a colored artifact
                return c.isArtifact() &amp;&amp;
                        CardUtil.getColors(c).contains(Constant.Color.Colorless) &amp;&amp;
                        !Gui_NewGame.removeArtifacts.isSelected();
            }
        });
        out.addAll(artifact);

        out = out.filter(new CardListFilter() {
            public boolean addCard(Card c) {
                if (c.isCreature() &amp;&amp;
                        c.getNetAttack() &lt;= 1 &amp;&amp;
                        Gui_NewGame.removeSmallCreatures.isSelected()) {
                    return false;
                }

                return true;
            }
        });

        out = filterBadCards(out, 3);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/gui/input/Input_PayManaCost.java</td><td><a href="./xref/forge/gui/input/Input_PayManaCost.html#40">40</a></td></tr><tr class="a"><td>forge/gui/input/Input_PayManaCost.java</td><td><a href="./xref/forge/gui/input/Input_PayManaCost.html#66">66</a></td></tr><tr class="b"><td colspan='2'><div><pre>        originalManaCost = sa.getManaCost(); // Change
        originalCard = sa.getSourceCard();

        spell = sa;

        if (Phase.getGameBegins() == 1) {
            if (sa.getSourceCard().isCopiedSpell() &amp;&amp; sa.isSpell()) {
                if (spell.getAfterPayMana() != null) stopSetNext(spell.getAfterPayMana());
                else {
                    manaCost = new ManaCost(&quot;0&quot;);
                    AllZone.getStack().add(spell);
                }
            } else {
                manaCost = AllZone.getGameAction().getSpellCostChange(sa, new ManaCost(originalManaCost));
            }
        } else {
            manaCost = new ManaCost(sa.getManaCost());
        }
    }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Card.java</td><td><a href="./xref/forge/Card.html#5479">5479</a></td></tr><tr class="a"><td>forge/Player.java</td><td><a href="./xref/forge/Player.html#482">482</a></td></tr><tr class="b"><td colspan='2'><div><pre>        if (AllZoneUtil.isCardInPlay(&quot;Gratuitous Violence&quot;, source.getController())) {
            int amount = AllZoneUtil.getPlayerCardsInPlay(source.getController(), &quot;Gratuitous Violence&quot;).size();
            for (int i = 0; i &lt; amount; i++)
                restDamage += restDamage;
        }

        if (AllZoneUtil.isCardInPlay(&quot;Fire Servant&quot;, source.getController()) &amp;&amp; source.isRed()
                &amp;&amp; (source.isInstant() || source.isSorcery())) {
            int amount = AllZoneUtil.getPlayerCardsInPlay(source.getController(), &quot;Fire Servant&quot;).size();
            for (int i = 0; i &lt; amount; i++)
                restDamage += restDamage;
        }

        if (AllZoneUtil.isCardInPlay(&quot;Benevolent Unicorn&quot;) &amp;&amp; source.isSpell()) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Choose.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Choose.html#177">177</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Choose.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Choose.html#419">419</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private static boolean chooseColorTriggerAI(final AbilityFactory af, final SpellAbility sa, boolean mandatory) {
        if (!ComputerUtil.canPayCost(sa))
            return false;

        Target tgt = sa.getTarget();

        if (sa.getTarget() != null) {
            tgt.resetTargets();
            sa.getTarget().addTarget(AllZone.getComputerPlayer());
        } else {
            ArrayList&lt;Player&gt; tgtPlayers = AbilityFactory.getDefinedPlayers(sa.getSourceCard(), af.getMapParams().get(&quot;Defined&quot;), sa);
            for (Player p : tgtPlayers)
                if (p.isHuman() &amp;&amp; !mandatory)
                    return false;
        }
        return true;
    }

    /**
     * &lt;p&gt;chooseColorResolve.&lt;/p&gt;
     *
     * @param af a {@link forge.card.abilityFactory.AbilityFactory} object.
     * @param sa a {@link forge.card.spellability.SpellAbility} object.
     */
    private static void chooseColorResolve(final AbilityFactory af, final SpellAbility sa) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/SetInfoUtil.java</td><td><a href="./xref/forge/SetInfoUtil.html#20">20</a></td></tr><tr class="a"><td>forge/SetInfoUtil.java</td><td><a href="./xref/forge/SetInfoUtil.html#270">270</a></td></tr><tr class="b"><td colspan='2'><div><pre>        ArrayList&lt;String&gt; fData = FileUtil.readFile(&quot;res/blockdata/blocks.txt&quot;);

        if (fData.size() &gt; 0) {
            for (int i = 0; i &lt; fData.size(); i++) {
                String s = fData.get(i);
                if (s.length() &gt; 5) {
                    HashMap&lt;String, String&gt; sm = new HashMap&lt;String, String&gt;();

                    String ss[] = s.split(&quot;\\|&quot;);
                    for (int j = 0; j &lt; ss.length; j++) {
                        String kv[] = ss[j].split(&quot;:&quot;);
                        sm.put(kv[0], kv[1]);
                    }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GameAction.java</td><td><a href="./xref/forge/GameAction.html#1777">1777</a></td></tr><tr class="a"><td>forge/GameAction.java</td><td><a href="./xref/forge/GameAction.html#1905">1905</a></td></tr><tr class="b"><td colspan='2'><div><pre>                                for (int no = 0; no &lt; Max; no++) Numbers[no] = String.valueOf(no);
                                String Number_ManaCost = &quot; &quot;;
                                if (mana.toString().length() == 1)
                                    Number_ManaCost = mana.toString().substring(0, 1);
                                else if (mana.toString().length() == 0)
                                    Number_ManaCost = &quot;0&quot;;  // Should Never Occur
                                else Number_ManaCost = mana.toString().substring(0, 2);
                                Number_ManaCost = Number_ManaCost.trim();

                                for (int check = 0; check &lt; Max; check++) {
                                    if (Number_ManaCost.equals(Numbers[check])) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_AlterLife.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_AlterLife.html#847">847</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#1370">1370</a></td></tr><tr class="b"><td colspan='2'><div><pre>            sb.append(sa.getSourceCard().getName()).append(&quot; - &quot;);
        else
            sb.append(&quot; &quot;);

        String conditionDesc = params.get(&quot;ConditionDescription&quot;);
        if (conditionDesc != null)
            sb.append(conditionDesc).append(&quot; &quot;);

        ArrayList&lt;Player&gt; tgtPlayers;

        Target tgt = af.getAbTgt();
        if (tgt != null)
            tgtPlayers = tgt.getTargetPlayers();
        else
            tgtPlayers = AbilityFactory.getDefinedPlayers(sa.getSourceCard(), params.get(&quot;Defined&quot;), sa);

        if (tgtPlayers.size() &gt; 0) {
            Iterator&lt;Player&gt; it = tgtPlayers.iterator();
            while(it.hasNext()) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/ComputerAI_General.java</td><td><a href="./xref/forge/ComputerAI_General.html#150">150</a></td></tr><tr class="a"><td>forge/ComputerAI_General.java</td><td><a href="./xref/forge/ComputerAI_General.html#193">193</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private CardList getAvailableSpellAbilities() {
        CardList all = AllZoneUtil.getPlayerHand(AllZone.getComputerPlayer());
        //Don't play permanents with Flash before humans declare attackers step
        all = all.filter(new CardListFilter() {
            public boolean addCard(Card c) {
                if (c.isPermanent()
                        &amp;&amp; c.hasKeyword(&quot;Flash&quot;)
                        &amp;&amp; (AllZone.getPhase().isPlayerTurn(AllZone.getComputerPlayer())
                        || AllZone.getPhase().isBefore(Constant.Phase.Combat_Declare_Attackers_InstantAbility)))
                    return false;
                return true;
            }
        });
        all.addAll(AllZoneUtil.getPlayerCardsInPlay(AllZone.getComputerPlayer()));
        all.addAll(CardFactoryUtil.getExternalZoneActivationCards(AllZone.getComputerPlayer()));</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_CardShop.java</td><td><a href="./xref/forge/Gui_CardShop.html#164">164</a></td></tr><tr class="a"><td>forge/Gui_DeckEditor.java</td><td><a href="./xref/forge/Gui_DeckEditor.html#241">241</a></td></tr><tr class="b"><td colspan='2'><div><pre>        bottomTable.repaint();
    }// updateDisplay

    /**
     * &lt;p&gt;updateDisplay.&lt;/p&gt;
     */
    public void updateDisplay() {
        //updateDisplay(this.top, this.bottom);

        topModel.clear();

        top = AllZone.getNameChanger().changeCardsIfNeeded(top);
        bottom = AllZone.getNameChanger().changeCardsIfNeeded(bottom);

        Card c;
        String cardName;
        ReadBoosterPack pack = new ReadBoosterPack();

        // update top
        for (int i = 0; i &lt; top.size(); i++) {
            c = top.get(i);

            // add rarity to card if this is a sealed card pool

            cardName = AllZone.getNameChanger().getOriginalName(c.getName());
            if (!pack.getRarity(cardName).equals(&quot;error&quot;)) {
                c.setRarity(pack.getRarity(cardName));
            }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Reveal.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Reveal.html#605">605</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#595">595</a></td></tr><tr class="b"><td colspan='2'><div><pre>        if (!ComputerUtil.canPayCost(sa))
            return false;

        Card source = sa.getSourceCard();
        Cost abCost = af.getAbCost();

        if (abCost != null) {
            // AI currently disabled for these costs
            if (abCost.getSacCost()) {
                return false;
            }
            if (abCost.getLifeCost()) {
                if (AllZone.getComputerPlayer().getLife() - abCost.getLifeAmount() &lt; 4)
                    return false;
            }
            if (abCost.getDiscardCost()) return false;

            if (abCost.getSubCounter()) {
                if (abCost.getCounterType().equals(Counters.P1P1)) return false; // Other counters should be used
            }

        }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/mana/ManaCost.java</td><td><a href="./xref/forge/card/mana/ManaCost.html#236">236</a></td></tr><tr class="a"><td>forge/card/mana/ManaCost.java</td><td><a href="./xref/forge/card/mana/ManaCost.html#273">273</a></td></tr><tr class="b"><td colspan='2'><div><pre>    public boolean addMana(Mana mana) {
        if (!isNeeded(mana)) throw new RuntimeException(&quot;ManaCost : addMana() error, mana not needed - &quot; + mana);

        Mana_Part choice = null;

        for (int i = 0; i &lt; manaPart.size(); i++) {
            Mana_Part m = (Mana_Part) manaPart.get(i);
            if (m.isNeeded(mana)) {
                // if m is a better to pay than choice
                if (choice == null) {
                    choice = m;
                    continue;
                }
                if (m.isColor(mana) &amp;&amp; choice.isEasierToPay(m)) {
                    choice = m;
                }
            }
        }//for
        if (choice == null)
            return false;

        choice.reduce(mana);
        if (!mana.isColor(Constant.Color.Colorless)) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DownloadSetPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadSetPictures_LQ.html#419">419</a></td></tr><tr class="a"><td>forge/Gui_MigrateLocalMWSSetPictures_HQ.java</td><td><a href="./xref/forge/Gui_MigrateLocalMWSSetPictures_HQ.html#436">436</a></td></tr><tr class="b"><td colspan='2'><div><pre>                            CList.add(new mCard(SC3 + &quot;\\&quot; + newFileName, URLBase + SC2 + &quot;\\&quot; + fn, SC3));

                        }

                    }
                }

            }

            //Log.error(iName + &quot;.jpg&quot; + &quot;\t&quot; + URLs[0]);

        }

        //ArrayList&lt;mCard&gt; list = new ArrayList&lt;mCard&gt;();
        //File file;
        /*
        File base = ForgeProps.getFile(IMAGE_TOKEN);
        for(int i = 0; i &lt; cardTokenLQ.length; i++) {
        	 file = new File(base, cardTokenLQ[i].name.substring(3, cardTokenLQ[i].name.length()));
            if(!file.exists()) CList.add(cardTokenLQ[i]);
        }
        */
        //return all card names and urls that are needed
        mCard[] out = new mCard[CList.size()];
        CList.toArray(out);

        for (int i = 0; i &lt; out.length; i++)
            System.out.println(out[i].name + &quot; &quot; + out[i].url);
        return out;
    }//getNeededCards()
    /*
    private static mCard[] readFile(String ABC) {
        try {
        	FileReader zrc = new FileReader(ForgeProps.getFile(ABC));
        	BufferedReader in = new BufferedReader(zrc);
            String line;
            ArrayList&lt;mCard&gt; list = new ArrayList&lt;mCard&gt;();
            StringTokenizer tok;
            
            line = in.readLine();
            while(line != null &amp;&amp; (!line.equals(&quot;&quot;))) {
                tok = new StringTokenizer(line);
                list.add(new mCard(tok.nextToken(), tok.nextToken(), &quot;&quot;));
                
                line = in.readLine();
            }
            
            mCard[] out = new mCard[list.size()];
            list.toArray(out);
            return out;
            
        } catch(Exception ex) {
            ErrorViewer.showError(ex, &quot;Gui_DownloadPictures: readFile() error&quot;);
            throw new RuntimeException(&quot;Gui_DownloadPictures : readFile() error&quot;);
        }
    }//readFile()
    */

    private class ProxyHandler implements ChangeListener {
        private int type;

        public ProxyHandler(int type) {
            this.type = type;
        }

        public void stateChanged(ChangeEvent e) {
            if (((AbstractButton) e.getSource()).isSelected()) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GameActionUtil.java</td><td><a href="./xref/forge/GameActionUtil.html#2938">2938</a></td></tr><tr class="a"><td>forge/GameActionUtil.java</td><td><a href="./xref/forge/GameActionUtil.html#3022">3022</a></td></tr><tr class="b"><td colspan='2'><div><pre>        CardList kinship = AllZoneUtil.getPlayerCardsInPlay(player, &quot;Squeaking Pie Grubfellows&quot;);
        final Player opponent = player.getOpponent();

        PlayerZone library = AllZone.getZone(Constant.Zone.Library, player);
        // Players would not choose to trigger Kinship ability if library is empty.
        // Useful for games when the &quot;Milling = Loss Condition&quot; check box is unchecked.

        if (kinship.size() == 0 || library.size() &lt;= 0)
            return;

        final String[] shareTypes = {&quot;Goblin&quot;, &quot;Shaman&quot;};
        final Card[] prevCardShown = {null};
        final Card peek[] = {null};

        for (final Card k : kinship) {
            Ability ability = new Ability(k, &quot;0&quot;) {    // change to triggered abilities when ready
                @Override
                public void resolve() {
                    PlayerZone library = AllZone.getZone(Constant.Zone.Library, player);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Counters.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Counters.html#544">544</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Counters.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Counters.html#863">863</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private static void removeResolve(final AbilityFactory af, final SpellAbility sa) {
        HashMap&lt;String, String&gt; params = af.getMapParams();

        Card card = af.getHostCard();
        String type = params.get(&quot;CounterType&quot;);
        int counterAmount = AbilityFactory.calculateAmount(af.getHostCard(), params.get(&quot;CounterNum&quot;), sa);

        ArrayList&lt;Card&gt; tgtCards;

        Target tgt = af.getAbTgt();
        if (tgt != null)
            tgtCards = tgt.getTargetCards();
        else {
            tgtCards = AbilityFactory.getDefinedCards(card, params.get(&quot;Defined&quot;), sa);
        }

        for (Card tgtCard : tgtCards)</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_ChangeZone.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ChangeZone.html#284">284</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_CounterMagic.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_CounterMagic.html#172">172</a></td></tr><tr class="b"><td colspan='2'><div><pre>        if (abCost != null) {
            // AI currently disabled for these costs
            if (abCost.getSacCost() &amp;&amp; !abCost.getSacThis()) {
                //only sacrifice something that's supposed to be sacrificed
                String type = abCost.getSacType();
                CardList typeList = AllZoneUtil.getPlayerCardsInPlay(AllZone.getComputerPlayer());
                typeList = typeList.getValidCards(type.split(&quot;,&quot;), source.getController(), source);
                if (ComputerUtil.getCardPreference(source, &quot;SacCost&quot;, typeList) == null)
                    return false;
            }
            if (abCost.getLifeCost()) {
                if (AllZone.getComputerPlayer().getLife() - abCost.getLifeAmount() &lt; 4)
                    return false;
            }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/CombatUtil.java</td><td><a href="./xref/forge/CombatUtil.html#1118">1118</a></td></tr><tr class="a"><td>forge/CombatUtil.java</td><td><a href="./xref/forge/CombatUtil.html#1287">1287</a></td></tr><tr class="b"><td colspan='2'><div><pre>        toughness += attacker.getKeywordMagnitude(&quot;Bushido&quot;);

        ArrayList&lt;Trigger&gt; registeredTriggers = AllZone.getTriggerHandler().getRegisteredTriggers();
        for (Trigger trigger : registeredTriggers) {
            HashMap&lt;String, String&gt; trigParams = trigger.getMapParams();
            Card source = trigger.getHostCard();

            if (!combatTriggerWillTrigger(attacker, defender, trigger, null) || !trigParams.containsKey(&quot;Execute&quot;))
                continue;
            String ability = source.getSVar(trigParams.get(&quot;Execute&quot;));
            AbilityFactory AF = new AbilityFactory();
            HashMap&lt;String, String&gt; abilityParams = AF.getMapParams(ability, source);
            if (abilityParams.containsKey(&quot;ValidTgts&quot;) || abilityParams.containsKey(&quot;Tgt&quot;))</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/deck/generate/GenerateConstructedMultiColorDeck.java</td><td><a href="./xref/forge/deck/generate/GenerateConstructedMultiColorDeck.html#132">132</a></td></tr><tr class="a"><td>forge/deck/generate/GenerateConstructedMultiColorDeck.java</td><td><a href="./xref/forge/deck/generate/GenerateConstructedMultiColorDeck.html#168">168</a></td></tr><tr class="b"><td colspan='2'><div><pre>            Card land;
            for (int i = 0; i &lt; numberBasic; i++) {

                land = AllZone.getCardFactory().getCard(map.get(color1).toString(), AllZone.getComputerPlayer());
                list.add(land);

                land = AllZone.getCardFactory().getCard(map.get(color2).toString(), AllZone.getComputerPlayer());
                list.add(land);

                land = AllZone.getCardFactory().getCard(map.get(color3).toString(), AllZone.getComputerPlayer());
                list.add(land);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Planeswalkers.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Planeswalkers.html#291">291</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Planeswalkers.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Planeswalkers.html#1374">1374</a></td></tr><tr class="b"><td colspan='2'><div><pre>                int check = -1;

                @Override
                public void showMessage() {
                    if (check != AllZone.getPhase().getTurn()) {
                        check = AllZone.getPhase().getTurn();
                        turn[0] = AllZone.getPhase().getTurn();
                        AllZone.getStack().add(ability3);
                    }
                    stop();
                }//showMessage()
            });

            //ability 1: make 4/4 out of moutain
            final SpellAbility ability1 = new Ability(card, &quot;0&quot;) {
                @Override
                public void resolve() {
                    card.addCounterFromNonEffect(Counters.LOYALTY, 1);
                    turn[0] = AllZone.getPhase().getTurn();</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Mana.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Mana.html#60">60</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Mana.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Mana.html#321">321</a></td></tr><tr class="b"><td colspan='2'><div><pre>    public static SpellAbility createSpellManaReflected(final AbilityFactory AF, final String produced) {
        // No Spell has Reflected Mana, but might as well put it in for the future
        final SpellAbility spMana = new Spell(AF.getHostCard(), AF.getAbCost(), AF.getAbTgt()) {
            private static final long serialVersionUID = -5141246507533353605L;

            final AbilityFactory af = AF;
            // To get the mana to resolve properly, we need the spell to contain an Ability_Mana
            Cost tmp = new Cost(&quot;0&quot;, AF.getHostCard().getName(), false);
            Ability_Mana tmpMana = new Ability_Mana(AF.getHostCard(), tmp, produced) {
                private static final long serialVersionUID = 1454043766057140491L;

                @Override
                public boolean doTrigger(boolean mandatory) {
                    // TODO Auto-generated method stub
                    return false;
                }

                // TODO: maybe add can produce here, so old AI code can use reflected mana?
            };
            //tmpMana.setReflectedMana(true);

            public boolean canPlayAI() {
                return manaReflectedCanPlayAI(af);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_AlterLife.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_AlterLife.html#519">519</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_AlterLife.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_AlterLife.html#902">902</a></td></tr><tr class="b"><td colspan='2'><div><pre>        String amountStr = params.get(&quot;Num&quot;);

        // TODO handle proper calculation of X values based on Cost and what would be paid
        //final int amount = AbilityFactory.calculateAmount(af.getHostCard(), amountStr, sa);

        if (abCost != null) {
            // AI currently disabled for these costs
            if (abCost.getSacCost()) {
                if (amountStr.contains(&quot;X&quot;))
                    return false;
                if (!abCost.getSacThis()) {
                    //only sacrifice something that's supposed to be sacrificed
                    String type = abCost.getSacType();
                    CardList typeList = AllZoneUtil.getPlayerCardsInPlay(AllZone.getComputerPlayer());
                    typeList = typeList.getValidCards(type.split(&quot;,&quot;), source.getController(), source);
                    if (ComputerUtil.getCardPreference(source, &quot;SacCost&quot;, typeList) == null)
                        return false;
                }
            }
            if (abCost.getLifeCost() &amp;&amp; aiLife - abCost.getLifeAmount() &lt;= 0) return false;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GuiDisplayUtil.java</td><td><a href="./xref/forge/GuiDisplayUtil.html#381">381</a></td></tr><tr class="a"><td>forge/GuiDisplayUtil.java</td><td><a href="./xref/forge/GuiDisplayUtil.html#575">575</a></td></tr><tr class="b"><td colspan='2'><div><pre>            for (int i = 0; i &lt; list.size(); i++) {
                JPanel addPanel;
                c = list.get(i);
                addPanel = new CardPanel(c);

                boolean startANewStack = false;

                if (!isStackable(c)) {
                    startANewStack = true;
                } else {
                    String newColor = c.getName(); //CardUtil.getColor(c);

                    if (!newColor.equals(color)) {
                        startANewStack = true;
                        color = newColor;
                    }
                }


                if (i == 0) {
                    startANewStack = false;
                }

                if (!startANewStack &amp;&amp; atInStack == Constant.Runtime.stackSize[0]) {
                    startANewStack = true;
                }


                if ((c.isEquipment() || c.isAura()) &amp;&amp; (c.isEquipping() || c.isEnchanting())</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_PermanentState.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_PermanentState.html#897">897</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_PermanentState.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_PermanentState.html#1670">1670</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private static void tapOrUntapResolve(final AbilityFactory af, final SpellAbility sa) {
        HashMap&lt;String, String&gt; params = af.getMapParams();
        Card card = sa.getSourceCard();

        ArrayList&lt;Card&gt; tgtCards;
        Target tgt = af.getAbTgt();
        if (tgt != null)
            tgtCards = tgt.getTargetCards();
        else {
            tgtCards = AbilityFactory.getDefinedCards(card, params.get(&quot;Defined&quot;), sa);
        }

        for (Card tgtC : tgtCards) {
            if (AllZoneUtil.isCardInPlay(tgtC) &amp;&amp; (tgt == null || CardFactoryUtil.canTarget(af.getHostCard(), tgtC))) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_CardShop.java</td><td><a href="./xref/forge/Gui_CardShop.html#111">111</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor.html#131">131</a></td></tr><tr class="b"><td colspan='2'><div><pre>            Random r = MyRandom.random;
            //int n = 0;
            //if (!PC.equals(&quot;&quot;)) {
            //    if (PC.matches(&quot;[0-9][0-9]?&quot;))
            //    	n = Integer.parseInt(PC);
            //    if (n &gt; 1)
            //        c.setRandomPicture(r.nextInt(n));
            //}

            if (c.getCurSetCode().equals(&quot;&quot;))
                c.setCurSetCode(c.getMostRecentSet());

            if (!c.getCurSetCode().equals(&quot;&quot;)) {
                int n = SetInfoUtil.getSetInfo_Code(c.getSets(), c.getCurSetCode()).PicCount;
                if (n &gt; 1)
                    c.setRandomPicture(r.nextInt(n - 1) + 1);

                c.setImageFilename(CardUtil.buildFilename(c));
            }


            topModel.addCard(c);
        }//for

        //update bottom
        for (int i = 0; i &lt; bottom.size(); i++) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Instants.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Instants.html#1055">1055</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Instants.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Instants.html#1139">1139</a></td></tr><tr class="b"><td colspan='2'><div><pre>                    sb.append(card.getName()).append(&quot; - Select target creatures, players, and/or planeswalkers.  Currently, (&quot;);
                    sb.append(targets.size()).append(&quot;) selected.&quot;);
                    sb.append(&quot; Press OK when done.&quot;);
                    AllZone.getDisplay().showMessage(sb.toString());
                    ButtonUtil.enableAll();
                }

                @Override
                public void selectButtonCancel() {
                    targets.clear();
                    AllZone.getGameAction().moveToHand(card);
                    stop();
                }

                @Override
                public void selectCard(Card c, PlayerZone zone) {
                    if (zone.is(Constant.Zone.Battlefield) &amp;&amp; !targets.contains(c)
                            &amp;&amp; CardFactoryUtil.canTarget(card, c) &amp;&amp;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Counters.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Counters.html#259">259</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Destroy.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Destroy.html#178">178</a></td></tr><tr class="b"><td colspan='2'><div><pre>        if (!ComputerUtil.canPayCost(sa))
            return false;

        // prevent run-away activations - first time will always return true
        boolean chance = r.nextFloat() &lt;= Math.pow(.6667, source.getAbilityUsed());

        // Targeting
        if (abTgt != null) {
            abTgt.resetTargets();
            // target loop
            while (abTgt.getNumTargeted() &lt; abTgt.getMaxTargets(sa.getSourceCard(), sa)) {
                if (list.size() == 0) {
                    if (abTgt.getNumTargeted() &lt; abTgt.getMinTargets(sa.getSourceCard(), sa) || abTgt.getNumTargeted() == 0) {
                        abTgt.resetTargets();
                        return false;
                    } else {
                        // TODO is this good enough? for up to amounts?
                        break;
                    }
                }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/SealedDeck.java</td><td><a href="./xref/forge/SealedDeck.html#332">332</a></td></tr><tr class="a"><td>forge/deck/generate/Generate2ColorDeck.java</td><td><a href="./xref/forge/deck/generate/Generate2ColorDeck.html#288">288</a></td></tr><tr class="b"><td colspan='2'><div><pre>                String mc = tDeck.get(i).getManaCost();

                // count each mana symbol in the mana cost
                for (int j = 0; j &lt; mc.length(); j++) {
                    char c = mc.charAt(j);

                    if (c == 'W')
                        ClrCnts[0].Count++;
                    else if (c == 'U')
                        ClrCnts[1].Count++;
                    else if (c == 'B')
                        ClrCnts[2].Count++;
                    else if (c == 'R')
                        ClrCnts[3].Count++;
                    else if (c == 'G')
                        ClrCnts[4].Count++;
                }
            }

            // total of all ClrCnts
            int totalColor = 0;
            for (int i = 0; i &lt; 5; i++) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_NewGame.java</td><td><a href="./xref/forge/Gui_NewGame.html#962">962</a></td></tr><tr class="a"><td>forge/Gui_NewGame.java</td><td><a href="./xref/forge/Gui_NewGame.html#1012">1012</a></td></tr><tr class="b"><td colspan='2'><div><pre>        if (p.equals(&quot;H&quot;)) {
            c1 = GuiUtils.getChoice(&quot;Select first color.&quot;, colors.toArray()).toString();

            if (c1.equals(&quot;Random&quot;))
                c1 = colors.get(r.nextInt(colors.size() - 1) + 1);

            colors.remove(c1);

            c2 = GuiUtils.getChoice(&quot;Select second color.&quot;, colors.toArray()).toString();

            if (c2.equals(&quot;Random&quot;))
                c2 = colors.get(r.nextInt(colors.size() - 1) + 1);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/BoosterDraftAI.java</td><td><a href="./xref/forge/BoosterDraftAI.html#402">402</a></td></tr><tr class="a"><td>forge/deck/generate/Generate3ColorDeck.java</td><td><a href="./xref/forge/deck/generate/Generate3ColorDeck.html#313">313</a></td></tr><tr class="b"><td colspan='2'><div><pre>                String mc = tDeck.get(i).getManaCost();

                // count each mana symbol in the mana cost
                for (int j = 0; j &lt; mc.length(); j++) {
                    char c = mc.charAt(j);

                    if (c == 'W')
                        ClrCnts[0].Count++;
                    else if (c == 'U')
                        ClrCnts[1].Count++;
                    else if (c == 'B')
                        ClrCnts[2].Count++;
                    else if (c == 'R')
                        ClrCnts[3].Count++;
                    else if (c == 'G')
                        ClrCnts[4].Count++;
                }
            }

            // total of all ClrCnts
            int totalColor = 0;
            for (int i = 0; i &lt; 5; i++) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Planeswalkers.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Planeswalkers.html#466">466</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Planeswalkers.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Planeswalkers.html#770">770</a></td></tr><tr class="b"><td colspan='2'><div><pre>                }//resolve()

                @Override
                public boolean canPlay() {
                    for (int i = 0; i &lt; AllZone.getStack().size(); i++) {
                        if (AllZone.getStack().peekInstance(i).getSourceCard().equals(card)) return false;
                    }

                    return AllZone.getZone(card).is(Constant.Zone.Battlefield)
                            &amp;&amp; turn[0] != AllZone.getPhase().getTurn()
                            &amp;&amp; Phase.canCastSorcery(card.getController());
                }

                @Override
                public boolean canPlayAI() {
                    return false;
                }
            };//SpellAbility ability2</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#546">546</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#1034">1034</a></td></tr><tr class="b"><td colspan='2'><div><pre>        StringBuilder sb = new StringBuilder();

        ArrayList&lt;Player&gt; tgtPlayers;

        Target tgt = af.getAbTgt();
        if (tgt != null)
            tgtPlayers = tgt.getTargetPlayers();
        else
            tgtPlayers = AbilityFactory.getDefinedPlayers(sa.getSourceCard(), params.get(&quot;Defined&quot;), sa);

        if (!(sa instanceof Ability_Sub))
            sb.append(sa.getSourceCard().getName()).append(&quot; - &quot;);
        else
            sb.append(&quot; &quot;);

        String conditionDesc = params.get(&quot;ConditionDescription&quot;);
        if (conditionDesc != null)
            sb.append(conditionDesc).append(&quot; &quot;);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_AlterLife.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_AlterLife.html#152">152</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#1367">1367</a></td></tr><tr class="b"><td colspan='2'><div><pre>        StringBuilder sb = new StringBuilder();

        if (!(sa instanceof Ability_Sub))
            sb.append(sa.getSourceCard().getName()).append(&quot; - &quot;);
        else
            sb.append(&quot; &quot;);

        String conditionDesc = params.get(&quot;ConditionDescription&quot;);
        if (conditionDesc != null)
            sb.append(conditionDesc).append(&quot; &quot;);

        ArrayList&lt;Player&gt; tgtPlayers;

        Target tgt = af.getAbTgt();
        if (tgt != null)
            tgtPlayers = tgt.getTargetPlayers();
        else
            tgtPlayers = AbilityFactory.getDefinedPlayers(sa.getSourceCard(), params.get(&quot;Defined&quot;), sa);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GameActionUtil.java</td><td><a href="./xref/forge/GameActionUtil.html#4943">4943</a></td></tr><tr class="a"><td>forge/GameActionUtil.java</td><td><a href="./xref/forge/GameActionUtil.html#5018">5018</a></td></tr><tr class="b"><td colspan='2'><div><pre>            String[] Keyword = Keyword_Details[2].split(&quot;/&quot;, 3);

            Keyword[0] = Keyword[0].replace(&quot;+&quot;, &quot;&quot;);
            Keyword[1] = Keyword[1].replace(&quot;+&quot;, &quot;&quot;);

            if (!Keyword[0].contains(&quot;X&quot;)) powerbonus = Integer.valueOf(Keyword[0]);
            else powerbonus = xValue;

            if (Keyword[1].contains(&quot;X&quot;)) toughnessbonus = xValue;
            else if (Keyword[1].contains(&quot;Y&quot;)) toughnessbonus = yValue;
            else toughnessbonus = Integer.valueOf(Keyword[1]);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/CombatUtil.java</td><td><a href="./xref/forge/CombatUtil.html#1120">1120</a></td></tr><tr class="a"><td>forge/CombatUtil.java</td><td><a href="./xref/forge/CombatUtil.html#1232">1232</a></td></tr><tr class="b"><td colspan='2'><div><pre>        ArrayList&lt;Trigger&gt; registeredTriggers = AllZone.getTriggerHandler().getRegisteredTriggers();
        for (Trigger trigger : registeredTriggers) {
            HashMap&lt;String, String&gt; trigParams = trigger.getMapParams();
            Card source = trigger.getHostCard();

            if (!combatTriggerWillTrigger(attacker, defender, trigger, null) || !trigParams.containsKey(&quot;Execute&quot;))
                continue;
            String ability = source.getSVar(trigParams.get(&quot;Execute&quot;));
            AbilityFactory AF = new AbilityFactory();
            HashMap&lt;String, String&gt; abilityParams = AF.getMapParams(ability, source);
            if (abilityParams.containsKey(&quot;ValidTgts&quot;) || abilityParams.containsKey(&quot;Tgt&quot;))</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/trigger/Trigger_Taps.java</td><td><a href="./xref/forge/card/trigger/Trigger_Taps.html#22">22</a></td></tr><tr class="a"><td>forge/card/trigger/Trigger_TapsForMana.java</td><td><a href="./xref/forge/card/trigger/Trigger_TapsForMana.html#22">22</a></td></tr><tr class="b"><td colspan='2'><div><pre>    public Trigger_TapsForMana(HashMap&lt;String, String&gt; params, Card host) {
        super(params, host);
    }

    /** {@inheritDoc} */
    @Override
    public boolean performTest(java.util.Map&lt;String, Object&gt; runParams) {
        Card tapper = (Card) runParams.get(&quot;Card&quot;);

        if (mapParams.containsKey(&quot;ValidCard&quot;)) {
            if (!tapper.isValidCard(mapParams.get(&quot;ValidCard&quot;).split(&quot;,&quot;), hostCard.getController(), hostCard)) {
                return false;
            }
        }

        return true;
    }

    /** {@inheritDoc} */
    @Override
    public Trigger getCopy() {
        Trigger copy = new Trigger_TapsForMana(mapParams, hostCard);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/ReadBoosterPack.java</td><td><a href="./xref/forge/ReadBoosterPack.html#99">99</a></td></tr><tr class="a"><td>forge/ReadBoosterPack.java</td><td><a href="./xref/forge/ReadBoosterPack.html#178">178</a></td></tr><tr class="b"><td colspan='2'><div><pre>        for (int i = 0; i &lt; 10; i++) {
            // Add basic land availability
            list.add(AllZone.getCardFactory().getCard(&quot;Forest&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Island&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Plains&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Mountain&quot;, AllZone.getHumanPlayer()));
            list.add(AllZone.getCardFactory().getCard(&quot;Swamp&quot;, AllZone.getHumanPlayer()));</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Reveal.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Reveal.html#608">608</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#193">193</a></td></tr><tr class="b"><td colspan='2'><div><pre>        Card source = sa.getSourceCard();
        Cost abCost = af.getAbCost();

        if (abCost != null) {
            // AI currently disabled for these costs
            if (abCost.getSacCost()) {
                return false;
            }
            if (abCost.getLifeCost()) {
                if (AllZone.getComputerPlayer().getLife() - abCost.getLifeAmount() &lt; 4)
                    return false;
            }
            if (abCost.getDiscardCost()) return false;

            if (abCost.getSubCounter()) {
                if (abCost.getCounterType().equals(Counters.P1P1)) return false; // Other counters should be used
            }

        }

        boolean bFlag = drawTargetAI(af, sa, true, false);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/SealedDeck.java</td><td><a href="./xref/forge/SealedDeck.html#56">56</a></td></tr><tr class="a"><td>forge/SealedDeck.java</td><td><a href="./xref/forge/SealedDeck.html#61">61</a></td></tr><tr class="b"><td colspan='2'><div><pre>                else if (blockSets.size() == 3) {
                    setCombos.add(String.format(&quot;%s/%s/%s/%s/%s/%s&quot;, blockSets.get(0), blockSets.get(0), blockSets.get(0), blockSets.get(0), blockSets.get(0), blockSets.get(0)));
                    setCombos.add(String.format(&quot;%s/%s/%s/%s/%s/%s&quot;, blockSets.get(1), blockSets.get(1), blockSets.get(0), blockSets.get(0), blockSets.get(0), blockSets.get(0)));</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Planeswalkers.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Planeswalkers.html#394">394</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Planeswalkers.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Planeswalkers.html#769">769</a></td></tr><tr class="b"><td colspan='2'><div><pre>                    }
                }//resolve()

                @Override
                public boolean canPlay() {
                    for (int i = 0; i &lt; AllZone.getStack().size(); i++) {
                        if (AllZone.getStack().peekInstance(i).getSourceCard().equals(card)) return false;
                    }

                    return AllZone.getZone(card).is(Constant.Zone.Battlefield)
                            &amp;&amp; turn[0] != AllZone.getPhase().getTurn()
                            &amp;&amp; Phase.canCastSorcery(card.getController());
                }

                @Override
                public boolean canPlayAI() {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Choose.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Choose.html#128">128</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Reveal.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Reveal.html#561">561</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private static String revealHandStackDescription(AbilityFactory af, SpellAbility sa) {
        HashMap&lt;String, String&gt; params = af.getMapParams();
        StringBuilder sb = new StringBuilder();

        if (!(sa instanceof Ability_Sub))
            sb.append(sa.getSourceCard()).append(&quot; - &quot;);
        else
            sb.append(&quot; &quot;);

        ArrayList&lt;Player&gt; tgtPlayers;

        Target tgt = af.getAbTgt();
        if (tgt != null)
            tgtPlayers = tgt.getTargetPlayers();
        else
            tgtPlayers = AbilityFactory.getDefinedPlayers(sa.getSourceCard(), params.get(&quot;Defined&quot;), sa);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DeckEditor.java</td><td><a href="./xref/forge/Gui_DeckEditor.html#210">210</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor.html#159">159</a></td></tr><tr class="b"><td colspan='2'><div><pre>            c.setRarity(c.getSVar(&quot;Rarity&quot;));

            //String PC = c.getSVar(&quot;PicCount&quot;);
            Random r = MyRandom.random;
            //int n = 0;
            //if (!PC.equals(&quot;&quot;)){
            //	if (PC.matches(&quot;[0-9][0-9]?&quot;))
            //		n = Integer.parseInt(PC);
            //	if (n &gt; 1)
            //		c.setRandomPicture(r.nextInt(n));
            //}

            if (c.getCurSetCode().equals(&quot;&quot;))
                c.setCurSetCode(c.getMostRecentSet());

            if (!c.getCurSetCode().equals(&quot;&quot;)) {
                int n = SetInfoUtil.getSetInfo_Code(c.getSets(), c.getCurSetCode()).PicCount;
                if (n &gt; 1)
                    c.setRandomPicture(r.nextInt(n - 1) + 1);

                c.setImageFilename(CardUtil.buildFilename(c));
            }

            bottomModel.addCard(c);
        }//for</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Planeswalkers.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Planeswalkers.html#395">395</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Planeswalkers.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Planeswalkers.html#466">466</a></td></tr><tr class="b"><td colspan='2'><div><pre>                }//resolve()

                @Override
                public boolean canPlay() {
                    for (int i = 0; i &lt; AllZone.getStack().size(); i++) {
                        if (AllZone.getStack().peekInstance(i).getSourceCard().equals(card)) return false;
                    }

                    return AllZone.getZone(card).is(Constant.Zone.Battlefield)
                            &amp;&amp; turn[0] != AllZone.getPhase().getTurn()
                            &amp;&amp; Phase.canCastSorcery(card.getController());
                }

                @Override
                public boolean canPlayAI() {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Reveal.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Reveal.html#608">608</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#1114">1114</a></td></tr><tr class="b"><td colspan='2'><div><pre>        Card source = sa.getSourceCard();
        Cost abCost = af.getAbCost();

        if (abCost != null) {
            // AI currently disabled for these costs
            if (abCost.getSacCost()) {
                return false;
            }
            if (abCost.getLifeCost()) {
                if (AllZone.getComputerPlayer().getLife() - abCost.getLifeAmount() &lt; 4)
                    return false;
            }
            if (abCost.getDiscardCost()) return false;

            if (abCost.getSubCounter()) {
                if (abCost.getCounterType().equals(Counters.P1P1)) return false; // Other counters should be used
            }

        }

        boolean humanHasHand = AllZoneUtil.getCardsInZone(Constant.Zone.Hand, AllZone.getHumanPlayer()).size() &gt; 0;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_PermanentState.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_PermanentState.html#1287">1287</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_PermanentState.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_PermanentState.html#1375">1375</a></td></tr><tr class="b"><td colspan='2'><div><pre>        CardList validTappables = getTapAllTargets(valid, source);

        Random r = MyRandom.random;
        boolean rr = false;
        if (r.nextFloat() &lt;= Math.pow(.6667, source.getAbilityUsed()))
            rr = true;

        if (validTappables.size() &gt; 0) {
            CardList human = validTappables.filter(new CardListFilter() {
                public boolean addCard(Card c) {
                    return c.getController().isHuman();
                }
            });
            CardList compy = validTappables.filter(new CardListFilter() {
                public boolean addCard(Card c) {
                    return c.getController().isHuman();</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/ReadBoosterPack.java</td><td><a href="./xref/forge/ReadBoosterPack.html#105">105</a></td></tr><tr class="a"><td>forge/ReadBoosterPack.java</td><td><a href="./xref/forge/ReadBoosterPack.html#186">186</a></td></tr><tr class="b"><td colspan='2'><div><pre>                list.add(AllZone.getCardFactory().getCard(&quot;Snow-Covered Forest&quot;, AllZone.getHumanPlayer()));
                list.add(AllZone.getCardFactory().getCard(&quot;Snow-Covered Island&quot;, AllZone.getHumanPlayer()));
                list.add(AllZone.getCardFactory().getCard(&quot;Snow-Covered Plains&quot;, AllZone.getHumanPlayer()));
                list.add(AllZone.getCardFactory().getCard(&quot;Snow-Covered Mountain&quot;, AllZone.getHumanPlayer()));
                list.add(AllZone.getCardFactory().getCard(&quot;Snow-Covered Swamp&quot;, AllZone.getHumanPlayer()));
            }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_CardShop.java</td><td><a href="./xref/forge/Gui_CardShop.html#584">584</a></td></tr><tr class="a"><td>forge/Gui_DeckEditor.java</td><td><a href="./xref/forge/Gui_DeckEditor.html#898">898</a></td></tr><tr class="b"><td colspan='2'><div><pre>        this.getContentPane().add(statsLabel, &quot;cell 0 7&quot;);

        jScrollPane2.getViewport().add(bottomTable, null);
        jScrollPane1.getViewport().add(topTable, null);

        glassPane = new JPanel() {
            private static final long serialVersionUID = 7394924497724994317L;

            @Override
            protected void paintComponent(java.awt.Graphics g) {
                Image image = ImageCache.getOriginalImage(picture.getCard());
                g.drawImage(image, glassPane.getWidth() - image.getWidth(null), glassPane.getHeight()
                        - image.getHeight(null), null);
            }
        };
        setGlassPane(glassPane);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#598">598</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#1114">1114</a></td></tr><tr class="b"><td colspan='2'><div><pre>        Card source = sa.getSourceCard();
        Cost abCost = af.getAbCost();

        if (abCost != null) {
            // AI currently disabled for these costs
            if (abCost.getSacCost()) {
                return false;
            }
            if (abCost.getLifeCost()) {
                if (AllZone.getComputerPlayer().getLife() - abCost.getLifeAmount() &lt; 4)
                    return false;
            }
            if (abCost.getDiscardCost()) return false;

            if (abCost.getSubCounter()) {
                if (abCost.getCounterType().equals(Counters.P1P1)) return false; // Other counters should be used
            }

        }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#235">235</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#1179">1179</a></td></tr><tr class="b"><td colspan='2'><div><pre>        if ((AllZone.getPhase().is(Constant.Phase.End_Of_Turn) &amp;&amp; AllZone.getPhase().isNextTurn(AllZone.getComputerPlayer())))
            chance = .9;    // 90% for end of opponents turn

        Random r = MyRandom.random;
        boolean randomReturn = r.nextFloat() &lt;= Math.pow(chance, source.getAbilityUsed() + 1);

        if (AbilityFactory.playReusable(sa))
            randomReturn = true;

        // some other variables here, like handsize vs. maxHandSize

        Ability_Sub subAb = sa.getSubAbility();
        if (subAb != null)
            randomReturn &amp;= subAb.chkAI_Drawback();
        return randomReturn;
    }//discardCanPlayAI()

    /**
     * &lt;p&gt;discardTargetAI.&lt;/p&gt;
     *
     * @param af a {@link forge.card.abilityFactory.AbilityFactory} object.
     * @return a boolean.
     */
    private static boolean discardTargetAI(AbilityFactory af) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#193">193</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_ZoneAffecting.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_ZoneAffecting.html#598">598</a></td></tr><tr class="b"><td colspan='2'><div><pre>        Card source = sa.getSourceCard();
        Cost abCost = af.getAbCost();

        if (abCost != null) {
            // AI currently disabled for these costs
            if (abCost.getSacCost()) {
                return false;
            }
            if (abCost.getLifeCost()) {
                if (AllZone.getComputerPlayer().getLife() - abCost.getLifeAmount() &lt; 4)
                    return false;
            }
            if (abCost.getDiscardCost()) return false;

            if (abCost.getSubCounter()) {
                if (abCost.getCounterType().equals(Counters.P1P1)) return false; // Other counters should be used
            }

        }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/spellability/SpellAbility_Condition.java</td><td><a href="./xref/forge/card/spellability/SpellAbility_Condition.html#136">136</a></td></tr><tr class="a"><td>forge/card/spellability/SpellAbility_Restriction.java</td><td><a href="./xref/forge/card/spellability/SpellAbility_Restriction.html#145">145</a></td></tr><tr class="b"><td colspan='2'><div><pre>        if (!bAnyPlayer &amp;&amp; !activator.equals(c.getController()))
            return false;

        if (activationLimit != -1 &amp;&amp; numberTurnActivations &gt;= activationLimit)
            return false;

        if (phases.size() &gt; 0) {
            boolean isPhase = false;
            String currPhase = AllZone.getPhase().getPhase();
            for (String s : phases) {
                if (s.equals(currPhase)) {
                    isPhase = true;
                    break;
                }
            }

            if (!isPhase)
                return false;
        }

        if (nCardsInHand != -1) {
            if (AllZoneUtil.getPlayerHand(activator).size() != nCardsInHand)
                return false;
        }
        if (hellbent) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_AlterLife.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_AlterLife.html#155">155</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_AlterLife.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_AlterLife.html#1069">1069</a></td></tr><tr class="b"><td colspan='2'><div><pre>            sb.append(sa.getSourceCard()).append(&quot; -&quot;);
        else
            sb.append(&quot; &quot;);

        String conditionDesc = params.get(&quot;ConditionDescription&quot;);
        if (conditionDesc != null)
            sb.append(conditionDesc).append(&quot; &quot;);

        ArrayList&lt;Player&gt; tgtPlayers;

        Target tgt = af.getAbTgt();
        if (tgt != null)
            tgtPlayers = tgt.getTargetPlayers();
        else
            tgtPlayers = AbilityFactory.getDefinedPlayers(sa.getSourceCard(), params.get(&quot;Defined&quot;), sa);

        for (Player player : tgtPlayers)
            sb.append(player).append(&quot; &quot;);

        sb.append(&quot;life total becomes &quot;).append(amount).append(&quot;.&quot;);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/cardFactory/CardFactory_Planeswalkers.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Planeswalkers.html#119">119</a></td></tr><tr class="a"><td>forge/card/cardFactory/CardFactory_Planeswalkers.java</td><td><a href="./xref/forge/card/cardFactory/CardFactory_Planeswalkers.html#1353">1353</a></td></tr><tr class="b"><td colspan='2'><div><pre>                    return 5 &lt;= card.getCounters(Counters.LOYALTY)
                            &amp;&amp; AllZone.getZone(card).is(Constant.Zone.Battlefield)
                            &amp;&amp; turn[0] != AllZone.getPhase().getTurn()
                            &amp;&amp; Phase.canCastSorcery(card.getController());
                }//canPlay()

                @Override
                public boolean canPlayAI() {
                    CardList list = AllZoneUtil.getPlayerCardsInPlay(AllZone.getComputerPlayer());
                    list = list.filter(new CardListFilter() {
                        public boolean addCard(Card c) {
                            return c.isEmblem()
                                    &amp;&amp; c.hasKeyword(&quot;Mountains you control have 'tap: This land deals 1 damage to target creature or player.'&quot;);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Counters.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Counters.html#266">266</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Counters.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Counters.html#354">354</a></td></tr><tr class="b"><td colspan='2'><div><pre>            abTgt.resetTargets();
            // target loop
            while (abTgt.getNumTargeted() &lt; abTgt.getMaxTargets(sa.getSourceCard(), sa)) {
                if (list.size() == 0) {
                    if (abTgt.getNumTargeted() &lt; abTgt.getMinTargets(sa.getSourceCard(), sa) || abTgt.getNumTargeted() == 0) {
                        abTgt.resetTargets();
                        return false;
                    } else {
                        break;
                    }
                }

                if (af.isCurse()) {
                    choice = chooseCursedTarget(list, type, amount);
                } else {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DownloadPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadPictures_LQ.html#162">162</a></td></tr><tr class="a"><td>forge/Gui_DownloadSetPictures_LQ.java</td><td><a href="./xref/forge/Gui_DownloadSetPictures_LQ.html#227">227</a></td></tr><tr class="b"><td colspan='2'><div><pre>                System.out.println(card + &quot;/&quot; + cards.length + &quot; - &quot; + a);
            }
        }
        ;
        EventQueue.invokeLater(new Worker(card));
    }

    /**
     * &lt;p&gt;Getter for the field &lt;code&gt;dlg&lt;/code&gt;.&lt;/p&gt;
     *
     * @param frame a {@link javax.swing.JFrame} object.
     * @return a {@link javax.swing.JDialog} object.
     */
    public JDialog getDlg(JFrame frame) {
        final JDialog dlg = this.dlg.createDialog(frame, ForgeProps.getLocalized(TITLE));
        close.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                dlg.setVisible(false);
            }
        });
        return dlg;
    }

    /**
     * &lt;p&gt;Setter for the field &lt;code&gt;cancel&lt;/code&gt;.&lt;/p&gt;
     *
     * @param cancel a boolean.
     */
    public void setCancel(boolean cancel) {
        this.cancel = cancel;
    }


    /**
     * &lt;p&gt;run.&lt;/p&gt;
     */
    public void run() {
        BufferedInputStream in;
        BufferedOutputStream out;

        File base = ForgeProps.getFile(IMAGE_BASE);</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Debuff.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Debuff.html#385">385</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Protection.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Protection.html#406">406</a></td></tr><tr class="b"><td colspan='2'><div><pre>        while(tgt.getNumTargeted() &lt; tgt.getMinTargets(source, sa)) {
            if(forced.isEmpty())
                break;

            Card c;
            if(forced.getNotType(&quot;Creature&quot;).size() == 0)
                c = CardFactoryUtil.AI_getWorstCreature(forced);
            else
                c = CardFactoryUtil.AI_getCheapestPermanent(forced, source, true);

            forced.remove(c);

            tgt.addTarget(c);
        }

        if(tgt.getNumTargeted() &lt; tgt.getMinTargets(sa.getSourceCard(), sa)) {
            tgt.resetTargets();
            return false;
        }

        return true;
    }//protectMandatoryTarget()

    /**
     * &lt;p&gt;protectTriggerAI.&lt;/p&gt;
     *
     * @param af a {@link forge.card.abilityFactory.AbilityFactory} object.
     * @param sa a {@link forge.card.spellability.SpellAbility} object.
     * @param mandatory a boolean.
     * @return a boolean.
     */
    private static boolean protectTriggerAI(AbilityFactory af, SpellAbility sa, boolean mandatory) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/ComputerUtil.java</td><td><a href="./xref/forge/ComputerUtil.html#1293">1293</a></td></tr><tr class="a"><td>forge/ComputerUtil.java</td><td><a href="./xref/forge/ComputerUtil.html#1332">1332</a></td></tr><tr class="b"><td colspan='2'><div><pre>        Player controller = card.getController();
        CardList l = AllZoneUtil.getPlayerCardsInPlay(controller);
        for (Card c : l)
            for (SpellAbility sa : c.getSpellAbility())
                // if SA is from AF_Counter don't add to getPlayable
                //This try/catch should fix the &quot;computer is thinking&quot; bug
                try {
                    if (sa.canPlay() &amp;&amp; ComputerUtil.canPayCost(sa, controller) &amp;&amp; sa.getAbilityFactory() != null &amp;&amp; sa.isAbility()) {
                        AbilityFactory af = sa.getAbilityFactory();
                        HashMap&lt;String, String&gt; mapParams = af.getMapParams();
                        if (mapParams.get(&quot;AB&quot;).equals(&quot;PreventDamage&quot;)) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/card/abilityFactory/AbilityFactory_Debuff.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Debuff.html#352">352</a></td></tr><tr class="a"><td>forge/card/abilityFactory/AbilityFactory_Pump.java</td><td><a href="./xref/forge/card/abilityFactory/AbilityFactory_Pump.html#497">497</a></td></tr><tr class="b"><td colspan='2'><div><pre>    private boolean pumpMandatoryTarget(AbilityFactory af, SpellAbility sa, boolean mandatory) {
        CardList list = AllZoneUtil.getCardsInPlay();
        Target tgt = sa.getTarget();
        list = list.getValidCards(tgt.getValidTgts(), sa.getActivatingPlayer(), sa.getSourceCard());

        if (list.size() &lt; tgt.getMinTargets(sa.getSourceCard(), sa)) {
            tgt.resetTargets();
            return false;
        }

        // Remove anything that's already been targeted
        for (Card c : tgt.getTargetCards())
            list.remove(c);

        CardList pref;</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_DeckEditor.java</td><td><a href="./xref/forge/Gui_DeckEditor.html#48">48</a></td></tr><tr class="a"><td>forge/Gui_Quest_DeckEditor.java</td><td><a href="./xref/forge/Gui_Quest_DeckEditor.html#48">48</a></td></tr><tr class="b"><td colspan='2'><div><pre>    public TableModel bottomModel;

    private JScrollPane jScrollPane1 = new JScrollPane();
    private JScrollPane jScrollPane2 = new JScrollPane();
    private JButton removeButton = new JButton();
    @SuppressWarnings(&quot;unused&quot;)
    // border1
    private Border border1;
    private TitledBorder titledBorder1;
    private Border border2;
    private TitledBorder titledBorder2;
    private JButton addButton = new JButton();
    private JButton analysisButton = new JButton();
    private JButton changePictureButton = new JButton();
    private JButton removePictureButton = new JButton();
    private JLabel statsLabel = new JLabel();
    private JTable topTable = new JTable();
    private JTable bottomTable = new JTable();
    private GridLayout gridLayout1 = new GridLayout();</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/Gui_CardShop.java</td><td><a href="./xref/forge/Gui_CardShop.html#107">107</a></td></tr><tr class="a"><td>forge/Gui_DeckEditor.java</td><td><a href="./xref/forge/Gui_DeckEditor.html#172">172</a></td></tr><tr class="b"><td colspan='2'><div><pre>                filteredOut = filterByType(c);
            }

            //String PC = c.getSVar(&quot;PicCount&quot;);
            Random r = MyRandom.random;
            //int n = 0;
            //if (!PC.equals(&quot;&quot;)) {
            //    if (PC.matches(&quot;[0-9][0-9]?&quot;))
            //    	n = Integer.parseInt(PC);
            //    if (n &gt; 1)
            //        c.setRandomPicture(r.nextInt(n));
            //}

            if (c.getCurSetCode().equals(&quot;&quot;))
                c.setCurSetCode(c.getMostRecentSet());

            if (!c.getCurSetCode().equals(&quot;&quot;)) {
                int n = SetInfoUtil.getSetInfo_Code(c.getSets(), c.getCurSetCode()).PicCount;
                if (n &gt; 1)
                    c.setRandomPicture(r.nextInt(n - 1) + 1);

                c.setImageFilename(CardUtil.buildFilename(c));
            }</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>forge/GUI_DeckAnalysis.java</td><td><a href="./xref/forge/GUI_DeckAnalysis.html#686">686</a></td></tr><tr class="a"><td>forge/GUI_DeckAnalysis.java</td><td><a href="./xref/forge/GUI_DeckAnalysis.html#704">704</a></td></tr><tr class="b"><td colspan='2'><div><pre>        } else {
            if (rList.size() &gt;= 40) {
                jList1Model =
                        new DefaultComboBoxModel(
                                new String[]{rList.getCard(0).getName(),
                                        rList.getCard(1).getName(),
                                        rList.getCard(2).getName(),
                                        rList.getCard(3).getName(),
                                        rList.getCard(4).getName(),
                                        rList.getCard(5).getName(),
                                        rList.getCard(6).getName()});</pre></div></td></tr></table></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">Copyright &#169;                    2007-2011
                        <a href="http://cardforge.org">CardForge</a>.
            All Rights Reserved.      
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
